2025-11-29 00:22:00 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-29 00:22:00 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-29 00:22:00 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-11-29 00:22:00 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-11-29 00:22:00 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-11-29 00:22:00 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@1455cc77
2025-11-29 00:22:00 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@58f04fb0
2025-11-29 00:22:00 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-11-29 00:22:00 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 17 ms
2025-11-29 00:22:00 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-29 00:22:00 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-29 00:22:01 [http-nio-8080-exec-1] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: dc6ac7d4-58b5-4af3-970f-d3d80ec80122, year: 2025, month: 11
2025-11-29 00:22:01 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: dc6ac7d4-58b5-4af3-970f-d3d80ec80122, 年: 2025, 月: 11
2025-11-29 00:22:01 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:22:01 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and s1_0.group_id in (?)
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-29 00:22:01 [http-nio-8080-exec-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:22:01 [http-nio-8080-exec-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 's1_0.group_id' in 'field list'
2025-11-29 00:22:01 [http-nio-8080-exec-1] ERROR c.e.s.controller.ScheduleController - 【获取日程列表失败】JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
org.springframework.dao.InvalidDataAccessResourceUsageException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy146.findSchedulesForUserAndGroupsByDateRange(Unknown Source)
	at com.example.speedcalendarserver.service.ScheduleService.getSchedulesByMonth(ScheduleService.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.getSchedulesByMonth(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.getSchedules(ScheduleController.java:39)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:269)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.getResultSet(DeferredResultSetAccess.java:172)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesResultSetImpl.<init>(JdbcValuesResultSetImpl.java:74)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.resolveJdbcValuesSource(JdbcSelectExecutorStandardImpl.java:355)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:137)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.lambda$new$1(ConcreteSqmSelectQueryPlan.java:149)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.withCacheableSqmInterpretation(ConcreteSqmSelectQueryPlan.java:439)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.performList(ConcreteSqmSelectQueryPlan.java:359)
	at org.hibernate.query.sqm.internal.QuerySqmImpl.doList(QuerySqmImpl.java:380)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:132)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:95)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 60 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 's1_0.group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeQuery(ClientPreparedStatement.java:1056)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:251)
	... 88 common frames omitted
2025-11-29 00:22:01 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:22:01 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at, (truncated)...]
2025-11-29 00:22:01 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:22:06 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-29 00:22:06 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-29 00:22:06 [http-nio-8080-exec-2] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: dc6ac7d4-58b5-4af3-970f-d3d80ec80122, year: 2025, month: 11
2025-11-29 00:22:06 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: dc6ac7d4-58b5-4af3-970f-d3d80ec80122, 年: 2025, 月: 11
2025-11-29 00:22:06 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:22:06 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and s1_0.group_id in (?)
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-29 00:22:06 [http-nio-8080-exec-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:22:06 [http-nio-8080-exec-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 's1_0.group_id' in 'field list'
2025-11-29 00:22:06 [http-nio-8080-exec-2] ERROR c.e.s.controller.ScheduleController - 【获取日程列表失败】JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
org.springframework.dao.InvalidDataAccessResourceUsageException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy146.findSchedulesForUserAndGroupsByDateRange(Unknown Source)
	at com.example.speedcalendarserver.service.ScheduleService.getSchedulesByMonth(ScheduleService.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.getSchedulesByMonth(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.getSchedules(ScheduleController.java:39)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:269)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.getResultSet(DeferredResultSetAccess.java:172)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesResultSetImpl.<init>(JdbcValuesResultSetImpl.java:74)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.resolveJdbcValuesSource(JdbcSelectExecutorStandardImpl.java:355)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:137)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.lambda$new$1(ConcreteSqmSelectQueryPlan.java:149)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.withCacheableSqmInterpretation(ConcreteSqmSelectQueryPlan.java:439)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.performList(ConcreteSqmSelectQueryPlan.java:359)
	at org.hibernate.query.sqm.internal.QuerySqmImpl.doList(QuerySqmImpl.java:380)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:132)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:95)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 60 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 's1_0.group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeQuery(ClientPreparedStatement.java:1056)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:251)
	... 88 common frames omitted
2025-11-29 00:22:06 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:22:06 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at, (truncated)...]
2025-11-29 00:22:06 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:22:09 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-29 00:22:09 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-29 00:22:09 [http-nio-8080-exec-3] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: dc6ac7d4-58b5-4af3-970f-d3d80ec80122, year: 2025, month: 11
2025-11-29 00:22:09 [http-nio-8080-exec-3] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: dc6ac7d4-58b5-4af3-970f-d3d80ec80122, 年: 2025, 月: 11
2025-11-29 00:22:09 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:22:09 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and s1_0.group_id in (?)
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-29 00:22:09 [http-nio-8080-exec-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:22:09 [http-nio-8080-exec-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 's1_0.group_id' in 'field list'
2025-11-29 00:22:09 [http-nio-8080-exec-3] ERROR c.e.s.controller.ScheduleController - 【获取日程列表失败】JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
org.springframework.dao.InvalidDataAccessResourceUsageException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy146.findSchedulesForUserAndGroupsByDateRange(Unknown Source)
	at com.example.speedcalendarserver.service.ScheduleService.getSchedulesByMonth(ScheduleService.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.getSchedulesByMonth(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.getSchedules(ScheduleController.java:39)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:269)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.getResultSet(DeferredResultSetAccess.java:172)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesResultSetImpl.<init>(JdbcValuesResultSetImpl.java:74)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.resolveJdbcValuesSource(JdbcSelectExecutorStandardImpl.java:355)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:137)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.lambda$new$1(ConcreteSqmSelectQueryPlan.java:149)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.withCacheableSqmInterpretation(ConcreteSqmSelectQueryPlan.java:439)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.performList(ConcreteSqmSelectQueryPlan.java:359)
	at org.hibernate.query.sqm.internal.QuerySqmImpl.doList(QuerySqmImpl.java:380)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:132)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:95)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 60 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 's1_0.group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeQuery(ClientPreparedStatement.java:1056)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:251)
	... 88 common frames omitted
2025-11-29 00:22:09 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:22:09 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at, (truncated)...]
2025-11-29 00:22:09 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:22:10 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:22:10 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:22:10 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:22:10 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:22:10 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-29 00:22:10 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:22:10 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f, groupName=A23计算机1班, role=member)]]
2025-11-29 00:22:10 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:22:15 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-29 00:22:15 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-29 00:22:15 [http-nio-8080-exec-5] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: dc6ac7d4-58b5-4af3-970f-d3d80ec80122, year: 2025, month: 11
2025-11-29 00:22:15 [http-nio-8080-exec-5] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: dc6ac7d4-58b5-4af3-970f-d3d80ec80122, 年: 2025, 月: 11
2025-11-29 00:22:15 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:22:15 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and s1_0.group_id in (?)
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-29 00:22:15 [http-nio-8080-exec-5] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:22:15 [http-nio-8080-exec-5] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 's1_0.group_id' in 'field list'
2025-11-29 00:22:15 [http-nio-8080-exec-5] ERROR c.e.s.controller.ScheduleController - 【获取日程列表失败】JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
org.springframework.dao.InvalidDataAccessResourceUsageException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy146.findSchedulesForUserAndGroupsByDateRange(Unknown Source)
	at com.example.speedcalendarserver.service.ScheduleService.getSchedulesByMonth(ScheduleService.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.getSchedulesByMonth(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.getSchedules(ScheduleController.java:39)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:269)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.getResultSet(DeferredResultSetAccess.java:172)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesResultSetImpl.<init>(JdbcValuesResultSetImpl.java:74)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.resolveJdbcValuesSource(JdbcSelectExecutorStandardImpl.java:355)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:137)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.lambda$new$1(ConcreteSqmSelectQueryPlan.java:149)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.withCacheableSqmInterpretation(ConcreteSqmSelectQueryPlan.java:439)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.performList(ConcreteSqmSelectQueryPlan.java:359)
	at org.hibernate.query.sqm.internal.QuerySqmImpl.doList(QuerySqmImpl.java:380)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:132)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:95)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 60 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 's1_0.group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeQuery(ClientPreparedStatement.java:1056)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:251)
	... 88 common frames omitted
2025-11-29 00:22:15 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:22:15 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at, (truncated)...]
2025-11-29 00:22:15 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:22:28 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/code", parameters={}
2025-11-29 00:22:28 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#sendCode(SendCodeRequest, HttpServletRequest)
2025-11-29 00:22:28 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [SendCodeRequest(phone=18006569106)]
2025-11-29 00:22:28 [http-nio-8080-exec-6] INFO  c.e.s.controller.AuthController - 【发送验证码】手机号: 18006569106, IP: 192.168.43.1
2025-11-29 00:22:28 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-29 00:22:28 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(vc1_0.id) 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.created_at>?
2025-11-29 00:22:28 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.expires_at<? 
        and vc1_0.status=?
2025-11-29 00:22:28 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        verification_codes
        (code, created_at, expires_at, ip_address, phone, status, type, used_at) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:22:28 [http-nio-8080-exec-6] INFO  c.e.s.service.AuthService - 【验证码】手机号: 18006569106, 验证码: 033209, 有效期: 300秒
2025-11-29 00:22:28 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:22:28 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=验证码发送成功, data=null)]
2025-11-29 00:22:28 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:22:40 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/login/phone", parameters={}
2025-11-29 00:22:40 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#phoneLogin(PhoneLoginRequest, HttpServletRequest)
2025-11-29 00:22:40 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PhoneLoginRequest(phone=18006569106, code=033209)]
2025-11-29 00:22:40 [http-nio-8080-exec-7] INFO  c.e.s.controller.AuthController - 【手机号登录】手机号: 18006569106, IP: 192.168.43.1
2025-11-29 00:22:40 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.code=? 
        and vc1_0.type=? 
        and vc1_0.status=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-29 00:22:40 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-11-29 00:22:40 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_tokens
        (access_token, access_token_expires_at, created_at, device_id, device_type, ip_address, refresh_token, refresh_token_expires_at, status, updated_at, user_agent, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:22:40 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    update
        verification_codes 
    set
        code=?,
        expires_at=?,
        ip_address=?,
        phone=?,
        status=?,
        type=?,
        used_at=? 
    where
        id=?
2025-11-29 00:22:40 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    update
        users 
    set
        avatar=?,
        bio=?,
        birthday=?,
        email=?,
        gender=?,
        is_deleted=?,
        last_login_ip=?,
        last_login_time=?,
        login_type=?,
        password=?,
        phone=?,
        status=?,
        updated_at=?,
        username=? 
    where
        user_id=?
2025-11-29 00:22:40 [http-nio-8080-exec-7] INFO  c.e.s.controller.AuthController - 【登录成功】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, phone: 18006569106
2025-11-29 00:22:40 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:22:40 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=登录成功, data=LoginResponse(userId=3ef54e3d-9b78-41b3-bdc9-54d68969117c,  (truncated)...]
2025-11-29 00:22:40 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:22:41 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-29 00:22:41 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-29 00:22:41 [http-nio-8080-exec-8] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, year: 2025, month: 11
2025-11-29 00:22:41 [http-nio-8080-exec-8] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 年: 2025, 月: 11
2025-11-29 00:22:41 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:22:41 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and s1_0.group_id in (?)
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-29 00:22:41 [http-nio-8080-exec-8] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:22:41 [http-nio-8080-exec-8] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 's1_0.group_id' in 'field list'
2025-11-29 00:22:41 [http-nio-8080-exec-8] ERROR c.e.s.controller.ScheduleController - 【获取日程列表失败】JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
org.springframework.dao.InvalidDataAccessResourceUsageException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy146.findSchedulesForUserAndGroupsByDateRange(Unknown Source)
	at com.example.speedcalendarserver.service.ScheduleService.getSchedulesByMonth(ScheduleService.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.getSchedulesByMonth(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.getSchedules(ScheduleController.java:39)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:269)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.getResultSet(DeferredResultSetAccess.java:172)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesResultSetImpl.<init>(JdbcValuesResultSetImpl.java:74)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.resolveJdbcValuesSource(JdbcSelectExecutorStandardImpl.java:355)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:137)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.lambda$new$1(ConcreteSqmSelectQueryPlan.java:149)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.withCacheableSqmInterpretation(ConcreteSqmSelectQueryPlan.java:439)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.performList(ConcreteSqmSelectQueryPlan.java:359)
	at org.hibernate.query.sqm.internal.QuerySqmImpl.doList(QuerySqmImpl.java:380)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:132)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:95)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 60 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 's1_0.group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeQuery(ClientPreparedStatement.java:1056)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:251)
	... 88 common frames omitted
2025-11-29 00:22:41 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:22:41 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at, (truncated)...]
2025-11-29 00:22:41 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:02 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:23:02 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:23:02 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:23:02 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:23:02 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-29 00:23:02 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:02 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f, groupName=A23计算机1班, role=admin)]]
2025-11-29 00:23:02 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:04 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:23:04 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:23:04 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:23:04 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:23:04 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-29 00:23:04 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:04 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f, groupName=A23计算机1班, role=admin)]]
2025-11-29 00:23:04 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:05 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:23:05 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:23:05 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:23:05 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:23:05 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-29 00:23:05 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:05 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f, groupName=A23计算机1班, role=admin)]]
2025-11-29 00:23:05 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:05 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:23:05 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:23:05 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:23:05 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:23:05 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-29 00:23:05 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:05 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f, groupName=A23计算机1班, role=admin)]]
2025-11-29 00:23:05 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:06 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f", parameters={}
2025-11-29 00:23:06 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getGroupDetails(String, String)
2025-11-29 00:23:06 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:23:06 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-29 00:23:06 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=? 
        and ug1_0.group_id=?
2025-11-29 00:23:06 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.group_id=?
2025-11-29 00:23:06 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-11-29 00:23:06 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:06 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [GroupDetailResponse(id=grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f, name=A23计算机1班, ownerId=3ef54e3d-9b7 (truncated)...]
2025-11-29 00:23:06 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:07 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:23:07 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:23:07 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:23:07 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:23:07 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-29 00:23:07 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:07 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f, groupName=A23计算机1班, role=admin)]]
2025-11-29 00:23:07 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:12 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-29 00:23:12 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-29 00:23:12 [http-nio-8080-exec-5] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, year: 2025, month: 11
2025-11-29 00:23:12 [http-nio-8080-exec-5] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 年: 2025, 月: 11
2025-11-29 00:23:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:23:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and s1_0.group_id in (?)
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-29 00:23:12 [http-nio-8080-exec-5] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:12 [http-nio-8080-exec-5] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 's1_0.group_id' in 'field list'
2025-11-29 00:23:12 [http-nio-8080-exec-5] ERROR c.e.s.controller.ScheduleController - 【获取日程列表失败】JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
org.springframework.dao.InvalidDataAccessResourceUsageException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy146.findSchedulesForUserAndGroupsByDateRange(Unknown Source)
	at com.example.speedcalendarserver.service.ScheduleService.getSchedulesByMonth(ScheduleService.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.getSchedulesByMonth(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.getSchedules(ScheduleController.java:39)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:269)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.getResultSet(DeferredResultSetAccess.java:172)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesResultSetImpl.<init>(JdbcValuesResultSetImpl.java:74)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.resolveJdbcValuesSource(JdbcSelectExecutorStandardImpl.java:355)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:137)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.lambda$new$1(ConcreteSqmSelectQueryPlan.java:149)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.withCacheableSqmInterpretation(ConcreteSqmSelectQueryPlan.java:439)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.performList(ConcreteSqmSelectQueryPlan.java:359)
	at org.hibernate.query.sqm.internal.QuerySqmImpl.doList(QuerySqmImpl.java:380)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:132)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:95)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 60 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 's1_0.group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeQuery(ClientPreparedStatement.java:1056)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:251)
	... 88 common frames omitted
2025-11-29 00:23:12 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:12 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at, (truncated)...]
2025-11-29 00:23:12 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:14 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:23:14 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:23:14 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:23:14 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:23:14 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-29 00:23:14 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:14 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f, groupName=A23计算机1班, role=admin)]]
2025-11-29 00:23:14 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:46 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-29 00:23:46 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-29 00:23:46 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=班会, scheduleDate=2025-11-29, startTime=09:00, endTime=null, location=公共教 (truncated)...]
2025-11-29 00:23:46 [http-nio-8080-exec-7] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, title: 班会
2025-11-29 00:23:46 [http-nio-8080-exec-7] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 标题: 班会, 群组ID: grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f
2025-11-29 00:23:46 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=? 
        and ug1_0.group_id=?
2025-11-29 00:23:46 [http-nio-8080-exec-7] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: 87c7ae8b-ca7e-4b8b-9383-717acd750e5c
2025-11-29 00:23:46 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:23:46 [http-nio-8080-exec-7] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:46 [http-nio-8080-exec-7] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 'group_id' in 'field list'
2025-11-29 00:23:46 [http-nio-8080-exec-7] ERROR c.e.s.controller.ScheduleController - 【创建日程失败】could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.createSchedule(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.createSchedule(ScheduleController.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 57 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 78 common frames omitted
2025-11-29 00:23:46 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:46 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=could not execute statement [Unknown column 'group_id' in 'field list' (truncated)...]
2025-11-29 00:23:46 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:49 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-29 00:23:49 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-29 00:23:49 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=班会, scheduleDate=2025-11-29, startTime=09:00, endTime=null, location=公共教 (truncated)...]
2025-11-29 00:23:49 [http-nio-8080-exec-8] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, title: 班会
2025-11-29 00:23:49 [http-nio-8080-exec-8] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 标题: 班会, 群组ID: grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f
2025-11-29 00:23:49 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=? 
        and ug1_0.group_id=?
2025-11-29 00:23:49 [http-nio-8080-exec-8] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: aa8224ba-8872-4aaf-bc97-70cd777b538a
2025-11-29 00:23:49 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:23:49 [http-nio-8080-exec-8] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:49 [http-nio-8080-exec-8] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 'group_id' in 'field list'
2025-11-29 00:23:49 [http-nio-8080-exec-8] ERROR c.e.s.controller.ScheduleController - 【创建日程失败】could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.createSchedule(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.createSchedule(ScheduleController.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 57 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 78 common frames omitted
2025-11-29 00:23:49 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:49 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=could not execute statement [Unknown column 'group_id' in 'field list' (truncated)...]
2025-11-29 00:23:49 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:50 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-29 00:23:50 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-29 00:23:50 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=班会, scheduleDate=2025-11-29, startTime=09:00, endTime=null, location=公共教 (truncated)...]
2025-11-29 00:23:50 [http-nio-8080-exec-9] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, title: 班会
2025-11-29 00:23:50 [http-nio-8080-exec-9] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 标题: 班会, 群组ID: grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f
2025-11-29 00:23:50 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=? 
        and ug1_0.group_id=?
2025-11-29 00:23:50 [http-nio-8080-exec-9] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: 2c181371-51bf-48fb-8a51-747140aef5fa
2025-11-29 00:23:50 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:23:50 [http-nio-8080-exec-9] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:50 [http-nio-8080-exec-9] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 'group_id' in 'field list'
2025-11-29 00:23:50 [http-nio-8080-exec-9] ERROR c.e.s.controller.ScheduleController - 【创建日程失败】could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.createSchedule(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.createSchedule(ScheduleController.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 57 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 78 common frames omitted
2025-11-29 00:23:50 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:50 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=could not execute statement [Unknown column 'group_id' in 'field list' (truncated)...]
2025-11-29 00:23:50 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:50 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-29 00:23:50 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-29 00:23:50 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=班会, scheduleDate=2025-11-29, startTime=09:00, endTime=null, location=公共教 (truncated)...]
2025-11-29 00:23:50 [http-nio-8080-exec-10] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, title: 班会
2025-11-29 00:23:50 [http-nio-8080-exec-10] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 标题: 班会, 群组ID: grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f
2025-11-29 00:23:50 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=? 
        and ug1_0.group_id=?
2025-11-29 00:23:50 [http-nio-8080-exec-10] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: 1550af89-595f-4bb0-a105-959a4251f8f3
2025-11-29 00:23:50 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:23:50 [http-nio-8080-exec-10] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:50 [http-nio-8080-exec-10] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 'group_id' in 'field list'
2025-11-29 00:23:50 [http-nio-8080-exec-10] ERROR c.e.s.controller.ScheduleController - 【创建日程失败】could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.createSchedule(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.createSchedule(ScheduleController.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 57 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 78 common frames omitted
2025-11-29 00:23:50 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:50 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=could not execute statement [Unknown column 'group_id' in 'field list' (truncated)...]
2025-11-29 00:23:50 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:50 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-29 00:23:50 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-29 00:23:50 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=班会, scheduleDate=2025-11-29, startTime=09:00, endTime=null, location=公共教 (truncated)...]
2025-11-29 00:23:50 [http-nio-8080-exec-1] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, title: 班会
2025-11-29 00:23:50 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 标题: 班会, 群组ID: grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f
2025-11-29 00:23:50 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=? 
        and ug1_0.group_id=?
2025-11-29 00:23:50 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: 3bb902c0-a345-45d3-930d-d752174af832
2025-11-29 00:23:50 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:23:50 [http-nio-8080-exec-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:50 [http-nio-8080-exec-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 'group_id' in 'field list'
2025-11-29 00:23:50 [http-nio-8080-exec-1] ERROR c.e.s.controller.ScheduleController - 【创建日程失败】could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.createSchedule(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.createSchedule(ScheduleController.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 57 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 78 common frames omitted
2025-11-29 00:23:50 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:50 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=could not execute statement [Unknown column 'group_id' in 'field list' (truncated)...]
2025-11-29 00:23:50 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:50 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-29 00:23:50 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-29 00:23:50 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=班会, scheduleDate=2025-11-29, startTime=09:00, endTime=null, location=公共教 (truncated)...]
2025-11-29 00:23:50 [http-nio-8080-exec-2] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, title: 班会
2025-11-29 00:23:50 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 标题: 班会, 群组ID: grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f
2025-11-29 00:23:50 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=? 
        and ug1_0.group_id=?
2025-11-29 00:23:50 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: 21b28098-86e6-43c9-adf8-0384dbdd8922
2025-11-29 00:23:50 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:23:50 [http-nio-8080-exec-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:50 [http-nio-8080-exec-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 'group_id' in 'field list'
2025-11-29 00:23:50 [http-nio-8080-exec-2] ERROR c.e.s.controller.ScheduleController - 【创建日程失败】could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.createSchedule(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.createSchedule(ScheduleController.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 57 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 78 common frames omitted
2025-11-29 00:23:50 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:50 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=could not execute statement [Unknown column 'group_id' in 'field list' (truncated)...]
2025-11-29 00:23:50 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:51 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-29 00:23:51 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-29 00:23:51 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=班会, scheduleDate=2025-11-29, startTime=09:00, endTime=null, location=公共教 (truncated)...]
2025-11-29 00:23:51 [http-nio-8080-exec-3] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, title: 班会
2025-11-29 00:23:51 [http-nio-8080-exec-3] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 标题: 班会, 群组ID: grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f
2025-11-29 00:23:51 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=? 
        and ug1_0.group_id=?
2025-11-29 00:23:51 [http-nio-8080-exec-3] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: ab2304ee-8e72-47e3-93ca-ab17ee56a6f8
2025-11-29 00:23:51 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:23:51 [http-nio-8080-exec-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:51 [http-nio-8080-exec-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 'group_id' in 'field list'
2025-11-29 00:23:51 [http-nio-8080-exec-3] ERROR c.e.s.controller.ScheduleController - 【创建日程失败】could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.createSchedule(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.createSchedule(ScheduleController.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 57 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 78 common frames omitted
2025-11-29 00:23:51 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:51 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=could not execute statement [Unknown column 'group_id' in 'field list' (truncated)...]
2025-11-29 00:23:51 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:51 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-29 00:23:51 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-29 00:23:51 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=班会, scheduleDate=2025-11-29, startTime=09:00, endTime=null, location=公共教 (truncated)...]
2025-11-29 00:23:51 [http-nio-8080-exec-4] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, title: 班会
2025-11-29 00:23:51 [http-nio-8080-exec-4] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 标题: 班会, 群组ID: grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f
2025-11-29 00:23:51 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=? 
        and ug1_0.group_id=?
2025-11-29 00:23:51 [http-nio-8080-exec-4] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: 5338267c-09e7-4606-b1f9-aa62435ad768
2025-11-29 00:23:51 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:23:51 [http-nio-8080-exec-4] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:51 [http-nio-8080-exec-4] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 'group_id' in 'field list'
2025-11-29 00:23:51 [http-nio-8080-exec-4] ERROR c.e.s.controller.ScheduleController - 【创建日程失败】could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.createSchedule(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.createSchedule(ScheduleController.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 57 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 78 common frames omitted
2025-11-29 00:23:51 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:51 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=could not execute statement [Unknown column 'group_id' in 'field list' (truncated)...]
2025-11-29 00:23:51 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:51 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-29 00:23:51 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-29 00:23:51 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=班会, scheduleDate=2025-11-29, startTime=09:00, endTime=null, location=公共教 (truncated)...]
2025-11-29 00:23:51 [http-nio-8080-exec-5] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, title: 班会
2025-11-29 00:23:51 [http-nio-8080-exec-5] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 标题: 班会, 群组ID: grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f
2025-11-29 00:23:51 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=? 
        and ug1_0.group_id=?
2025-11-29 00:23:51 [http-nio-8080-exec-5] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: c5f73a1c-e6e0-4a56-a2e6-bf99e7cd148f
2025-11-29 00:23:51 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:23:51 [http-nio-8080-exec-5] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:51 [http-nio-8080-exec-5] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 'group_id' in 'field list'
2025-11-29 00:23:51 [http-nio-8080-exec-5] ERROR c.e.s.controller.ScheduleController - 【创建日程失败】could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.createSchedule(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.createSchedule(ScheduleController.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 57 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 78 common frames omitted
2025-11-29 00:23:51 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:51 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=could not execute statement [Unknown column 'group_id' in 'field list' (truncated)...]
2025-11-29 00:23:51 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:51 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-29 00:23:51 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-29 00:23:51 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=班会, scheduleDate=2025-11-29, startTime=09:00, endTime=null, location=公共教 (truncated)...]
2025-11-29 00:23:51 [http-nio-8080-exec-6] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, title: 班会
2025-11-29 00:23:51 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 标题: 班会, 群组ID: grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f
2025-11-29 00:23:51 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=? 
        and ug1_0.group_id=?
2025-11-29 00:23:51 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: a1462263-4f2f-41e0-b252-4ae39b9ea238
2025-11-29 00:23:51 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:23:51 [http-nio-8080-exec-6] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:51 [http-nio-8080-exec-6] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 'group_id' in 'field list'
2025-11-29 00:23:51 [http-nio-8080-exec-6] ERROR c.e.s.controller.ScheduleController - 【创建日程失败】could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.createSchedule(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.createSchedule(ScheduleController.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 57 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 78 common frames omitted
2025-11-29 00:23:51 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:51 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=could not execute statement [Unknown column 'group_id' in 'field list' (truncated)...]
2025-11-29 00:23:51 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:51 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-29 00:23:51 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-29 00:23:51 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=班会, scheduleDate=2025-11-29, startTime=09:00, endTime=null, location=公共教 (truncated)...]
2025-11-29 00:23:51 [http-nio-8080-exec-7] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, title: 班会
2025-11-29 00:23:51 [http-nio-8080-exec-7] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 标题: 班会, 群组ID: grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f
2025-11-29 00:23:51 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=? 
        and ug1_0.group_id=?
2025-11-29 00:23:51 [http-nio-8080-exec-7] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: f3c23237-1e4c-4396-8906-9cce77237866
2025-11-29 00:23:51 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:23:51 [http-nio-8080-exec-7] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:51 [http-nio-8080-exec-7] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 'group_id' in 'field list'
2025-11-29 00:23:51 [http-nio-8080-exec-7] ERROR c.e.s.controller.ScheduleController - 【创建日程失败】could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.createSchedule(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.createSchedule(ScheduleController.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 57 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 78 common frames omitted
2025-11-29 00:23:51 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:51 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=could not execute statement [Unknown column 'group_id' in 'field list' (truncated)...]
2025-11-29 00:23:51 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:53 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-29 00:23:53 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-29 00:23:53 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=班会, scheduleDate=2025-11-29, startTime=09:00, endTime=null, location=公共教 (truncated)...]
2025-11-29 00:23:53 [http-nio-8080-exec-8] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, title: 班会
2025-11-29 00:23:53 [http-nio-8080-exec-8] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 标题: 班会, 群组ID: null
2025-11-29 00:23:53 [http-nio-8080-exec-8] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: b705eeef-a705-40e7-a87d-e1c0a549d901
2025-11-29 00:23:53 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:23:53 [http-nio-8080-exec-8] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:53 [http-nio-8080-exec-8] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 'group_id' in 'field list'
2025-11-29 00:23:53 [http-nio-8080-exec-8] ERROR c.e.s.controller.ScheduleController - 【创建日程失败】could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.createSchedule(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.createSchedule(ScheduleController.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 57 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 78 common frames omitted
2025-11-29 00:23:53 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:53 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=could not execute statement [Unknown column 'group_id' in 'field list' (truncated)...]
2025-11-29 00:23:53 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:54 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-29 00:23:54 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-29 00:23:54 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=班会, scheduleDate=2025-11-29, startTime=09:00, endTime=null, location=公共教 (truncated)...]
2025-11-29 00:23:54 [http-nio-8080-exec-9] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, title: 班会
2025-11-29 00:23:54 [http-nio-8080-exec-9] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 标题: 班会, 群组ID: null
2025-11-29 00:23:54 [http-nio-8080-exec-9] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: 1d8fd771-5e4d-4916-9631-d66ae7e6adbd
2025-11-29 00:23:54 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:23:54 [http-nio-8080-exec-9] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:54 [http-nio-8080-exec-9] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 'group_id' in 'field list'
2025-11-29 00:23:54 [http-nio-8080-exec-9] ERROR c.e.s.controller.ScheduleController - 【创建日程失败】could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.createSchedule(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.createSchedule(ScheduleController.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 57 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 78 common frames omitted
2025-11-29 00:23:54 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:54 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=could not execute statement [Unknown column 'group_id' in 'field list' (truncated)...]
2025-11-29 00:23:54 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:54 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-29 00:23:54 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-29 00:23:54 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=班会, scheduleDate=2025-11-29, startTime=09:00, endTime=null, location=公共教 (truncated)...]
2025-11-29 00:23:54 [http-nio-8080-exec-10] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, title: 班会
2025-11-29 00:23:54 [http-nio-8080-exec-10] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 标题: 班会, 群组ID: null
2025-11-29 00:23:54 [http-nio-8080-exec-10] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: 96ac9a02-7892-4966-bbe5-f3619ab75ca0
2025-11-29 00:23:54 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:23:54 [http-nio-8080-exec-10] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:54 [http-nio-8080-exec-10] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 'group_id' in 'field list'
2025-11-29 00:23:54 [http-nio-8080-exec-10] ERROR c.e.s.controller.ScheduleController - 【创建日程失败】could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.createSchedule(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.createSchedule(ScheduleController.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 57 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 78 common frames omitted
2025-11-29 00:23:54 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:54 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=could not execute statement [Unknown column 'group_id' in 'field list' (truncated)...]
2025-11-29 00:23:54 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:54 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-29 00:23:54 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-29 00:23:54 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=班会, scheduleDate=2025-11-29, startTime=09:00, endTime=null, location=公共教 (truncated)...]
2025-11-29 00:23:54 [http-nio-8080-exec-1] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, title: 班会
2025-11-29 00:23:54 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 标题: 班会, 群组ID: null
2025-11-29 00:23:54 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: f435cbaf-e825-42d4-b6d9-a8cff1aa3edc
2025-11-29 00:23:54 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:23:54 [http-nio-8080-exec-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:54 [http-nio-8080-exec-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 'group_id' in 'field list'
2025-11-29 00:23:54 [http-nio-8080-exec-1] ERROR c.e.s.controller.ScheduleController - 【创建日程失败】could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.createSchedule(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.createSchedule(ScheduleController.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 57 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 78 common frames omitted
2025-11-29 00:23:54 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:54 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=could not execute statement [Unknown column 'group_id' in 'field list' (truncated)...]
2025-11-29 00:23:54 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:54 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-29 00:23:54 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-29 00:23:54 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=班会, scheduleDate=2025-11-29, startTime=09:00, endTime=null, location=公共教 (truncated)...]
2025-11-29 00:23:54 [http-nio-8080-exec-2] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, title: 班会
2025-11-29 00:23:54 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 标题: 班会, 群组ID: null
2025-11-29 00:23:54 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: 9aba3488-da1e-418c-b61c-c9b51254760f
2025-11-29 00:23:54 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:23:54 [http-nio-8080-exec-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:54 [http-nio-8080-exec-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 'group_id' in 'field list'
2025-11-29 00:23:54 [http-nio-8080-exec-2] ERROR c.e.s.controller.ScheduleController - 【创建日程失败】could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.createSchedule(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.createSchedule(ScheduleController.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 57 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 78 common frames omitted
2025-11-29 00:23:54 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:54 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=could not execute statement [Unknown column 'group_id' in 'field list' (truncated)...]
2025-11-29 00:23:54 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:54 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-29 00:23:54 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-29 00:23:54 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=班会, scheduleDate=2025-11-29, startTime=09:00, endTime=null, location=公共教 (truncated)...]
2025-11-29 00:23:54 [http-nio-8080-exec-3] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, title: 班会
2025-11-29 00:23:54 [http-nio-8080-exec-3] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 标题: 班会, 群组ID: null
2025-11-29 00:23:54 [http-nio-8080-exec-3] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: 20f93516-9807-4ce6-a16f-5d99cdb127ef
2025-11-29 00:23:54 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:23:54 [http-nio-8080-exec-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:54 [http-nio-8080-exec-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 'group_id' in 'field list'
2025-11-29 00:23:54 [http-nio-8080-exec-3] ERROR c.e.s.controller.ScheduleController - 【创建日程失败】could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.createSchedule(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.createSchedule(ScheduleController.java:58)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [Unknown column 'group_id' in 'field list'] [insert into schedules (created_at,end_time,group_id,is_all_day,is_deleted,location,schedule_date,start_time,title,updated_at,user_id,schedule_id) values (?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 57 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 78 common frames omitted
2025-11-29 00:23:54 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:54 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=could not execute statement [Unknown column 'group_id' in 'field list' (truncated)...]
2025-11-29 00:23:54 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:55 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-29 00:23:55 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-29 00:23:55 [http-nio-8080-exec-4] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, year: 2025, month: 11
2025-11-29 00:23:55 [http-nio-8080-exec-4] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 年: 2025, 月: 11
2025-11-29 00:23:55 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:23:55 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and s1_0.group_id in (?)
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-29 00:23:55 [http-nio-8080-exec-4] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:55 [http-nio-8080-exec-4] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 's1_0.group_id' in 'field list'
2025-11-29 00:23:55 [http-nio-8080-exec-4] ERROR c.e.s.controller.ScheduleController - 【获取日程列表失败】JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
org.springframework.dao.InvalidDataAccessResourceUsageException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy146.findSchedulesForUserAndGroupsByDateRange(Unknown Source)
	at com.example.speedcalendarserver.service.ScheduleService.getSchedulesByMonth(ScheduleService.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.getSchedulesByMonth(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.getSchedules(ScheduleController.java:39)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:269)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.getResultSet(DeferredResultSetAccess.java:172)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesResultSetImpl.<init>(JdbcValuesResultSetImpl.java:74)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.resolveJdbcValuesSource(JdbcSelectExecutorStandardImpl.java:355)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:137)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.lambda$new$1(ConcreteSqmSelectQueryPlan.java:149)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.withCacheableSqmInterpretation(ConcreteSqmSelectQueryPlan.java:439)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.performList(ConcreteSqmSelectQueryPlan.java:359)
	at org.hibernate.query.sqm.internal.QuerySqmImpl.doList(QuerySqmImpl.java:380)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:132)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:95)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 60 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 's1_0.group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeQuery(ClientPreparedStatement.java:1056)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:251)
	... 88 common frames omitted
2025-11-29 00:23:55 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:55 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at, (truncated)...]
2025-11-29 00:23:55 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:23:59 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-29 00:23:59 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-29 00:23:59 [http-nio-8080-exec-5] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, year: 2025, month: 11
2025-11-29 00:23:59 [http-nio-8080-exec-5] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 年: 2025, 月: 11
2025-11-29 00:23:59 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:23:59 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and s1_0.group_id in (?)
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-29 00:23:59 [http-nio-8080-exec-5] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:23:59 [http-nio-8080-exec-5] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 's1_0.group_id' in 'field list'
2025-11-29 00:23:59 [http-nio-8080-exec-5] ERROR c.e.s.controller.ScheduleController - 【获取日程列表失败】JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
org.springframework.dao.InvalidDataAccessResourceUsageException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy146.findSchedulesForUserAndGroupsByDateRange(Unknown Source)
	at com.example.speedcalendarserver.service.ScheduleService.getSchedulesByMonth(ScheduleService.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.getSchedulesByMonth(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.getSchedules(ScheduleController.java:39)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:269)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.getResultSet(DeferredResultSetAccess.java:172)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesResultSetImpl.<init>(JdbcValuesResultSetImpl.java:74)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.resolveJdbcValuesSource(JdbcSelectExecutorStandardImpl.java:355)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:137)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.lambda$new$1(ConcreteSqmSelectQueryPlan.java:149)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.withCacheableSqmInterpretation(ConcreteSqmSelectQueryPlan.java:439)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.performList(ConcreteSqmSelectQueryPlan.java:359)
	at org.hibernate.query.sqm.internal.QuerySqmImpl.doList(QuerySqmImpl.java:380)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:132)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:95)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 60 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 's1_0.group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeQuery(ClientPreparedStatement.java:1056)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:251)
	... 88 common frames omitted
2025-11-29 00:23:59 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:23:59 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at, (truncated)...]
2025-11-29 00:23:59 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:24:00 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=10", parameters={masked}
2025-11-29 00:24:00 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-29 00:24:00 [http-nio-8080-exec-6] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, year: 2025, month: 10
2025-11-29 00:24:00 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 年: 2025, 月: 10
2025-11-29 00:24:00 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:24:00 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and s1_0.group_id in (?)
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-29 00:24:00 [http-nio-8080-exec-6] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:24:00 [http-nio-8080-exec-6] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 's1_0.group_id' in 'field list'
2025-11-29 00:24:00 [http-nio-8080-exec-6] ERROR c.e.s.controller.ScheduleController - 【获取日程列表失败】JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
org.springframework.dao.InvalidDataAccessResourceUsageException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy146.findSchedulesForUserAndGroupsByDateRange(Unknown Source)
	at com.example.speedcalendarserver.service.ScheduleService.getSchedulesByMonth(ScheduleService.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.getSchedulesByMonth(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.getSchedules(ScheduleController.java:39)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:269)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.getResultSet(DeferredResultSetAccess.java:172)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesResultSetImpl.<init>(JdbcValuesResultSetImpl.java:74)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.resolveJdbcValuesSource(JdbcSelectExecutorStandardImpl.java:355)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:137)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.lambda$new$1(ConcreteSqmSelectQueryPlan.java:149)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.withCacheableSqmInterpretation(ConcreteSqmSelectQueryPlan.java:439)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.performList(ConcreteSqmSelectQueryPlan.java:359)
	at org.hibernate.query.sqm.internal.QuerySqmImpl.doList(QuerySqmImpl.java:380)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:132)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:95)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 60 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 's1_0.group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeQuery(ClientPreparedStatement.java:1056)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:251)
	... 88 common frames omitted
2025-11-29 00:24:00 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:24:00 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at, (truncated)...]
2025-11-29 00:24:00 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:24:01 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-29 00:24:01 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-29 00:24:01 [http-nio-8080-exec-7] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, year: 2025, month: 11
2025-11-29 00:24:01 [http-nio-8080-exec-7] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 年: 2025, 月: 11
2025-11-29 00:24:01 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:24:01 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and s1_0.group_id in (?)
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-29 00:24:01 [http-nio-8080-exec-7] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1054, SQLState: 42S22
2025-11-29 00:24:01 [http-nio-8080-exec-7] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Unknown column 's1_0.group_id' in 'field list'
2025-11-29 00:24:01 [http-nio-8080-exec-7] ERROR c.e.s.controller.ScheduleController - 【获取日程列表失败】JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
org.springframework.dao.InvalidDataAccessResourceUsageException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]; SQL [n/a]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy146.findSchedulesForUserAndGroupsByDateRange(Unknown Source)
	at com.example.speedcalendarserver.service.ScheduleService.getSchedulesByMonth(ScheduleService.java:45)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.ScheduleService$$SpringCGLIB$$0.getSchedulesByMonth(<generated>)
	at com.example.speedcalendarserver.controller.ScheduleController.getSchedules(ScheduleController.java:39)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at,s1_0.end_time,s1_0.group_id,s1_0.is_all_day,s1_0.is_deleted,s1_0.location,s1_0.schedule_date,s1_0.start_time,s1_0.title,s1_0.updated_at,s1_0.user_id from schedules s1_0 where s1_0.is_deleted=0 and s1_0.schedule_date between ? and ? and ((s1_0.group_id is null and s1_0.user_id=?) or (s1_0.group_id is not null and s1_0.group_id in (?))) order by s1_0.schedule_date,s1_0.start_time] [Unknown column 's1_0.group_id' in 'field list'] [n/a]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:269)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.getResultSet(DeferredResultSetAccess.java:172)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesResultSetImpl.<init>(JdbcValuesResultSetImpl.java:74)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.resolveJdbcValuesSource(JdbcSelectExecutorStandardImpl.java:355)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:137)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.lambda$new$1(ConcreteSqmSelectQueryPlan.java:149)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.withCacheableSqmInterpretation(ConcreteSqmSelectQueryPlan.java:439)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.performList(ConcreteSqmSelectQueryPlan.java:359)
	at org.hibernate.query.sqm.internal.QuerySqmImpl.doList(QuerySqmImpl.java:380)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:132)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:95)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 60 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 's1_0.group_id' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeQuery(ClientPreparedStatement.java:1056)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:251)
	... 88 common frames omitted
2025-11-29 00:24:01 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:24:01 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=JDBC exception executing SQL [select s1_0.schedule_id,s1_0.created_at, (truncated)...]
2025-11-29 00:24:01 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:26:02 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-29 00:26:02 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-29 00:26:02 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-29 00:26:02 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-29 00:26:02 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-29 00:26:06 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.8 with PID 50964 (E:\develop\Android Studio\workspace\SpeedCalendar-server\target\classes started by jiang in E:\develop\Android Studio\workspace\SpeedCalendar-server)
2025-11-29 00:26:07 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-29 00:26:07 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-29 00:26:07 [restartedMain] INFO  o.s.b.d.restart.ChangeableUrls - The Class-Path manifest attribute in C:\Users\jiang\.m2\repository\org\apache\opennlp\opennlp-tools\2.5.4\opennlp-tools-2.5.4.jar referenced one or more files that do not exist: file:/C:/Users/jiang/.m2/repository/org/apache/opennlp/opennlp-tools/2.5.4/slf4j-api-2.0.17.jar
2025-11-29 00:26:07 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-29 00:26:07 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-29 00:26:07 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-29 00:26:07 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-29 00:26:08 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 192 ms. Found 9 JPA repository interfaces.
2025-11-29 00:26:08 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-29 00:26:08 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-29 00:26:08 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-29 00:26:08 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-29 00:26:08 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-29 00:26:08 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-29 00:26:08 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-29 00:26:08 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-29 00:26:08 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-29 00:26:08 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-29 00:26:08 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-29 00:26:08 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
2025-11-29 00:26:08 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-29 00:26:08 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-29 00:26:08 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-29 00:26:08 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-29 00:26:08 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1924 ms
2025-11-29 00:26:09 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-29 00:26:09 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-29 00:26:09 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-29 00:26:09 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-29 00:26:09 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-29 00:26:09 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@3bbb4816
2025-11-29 00:26:09 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-29 00:26:09 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-29 00:26:09 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-11-29 00:26:09 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-29 00:26:10 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-29 00:26:10 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-29 00:26:11 [restartedMain] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-29 00:26:12 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-29 00:26:12 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-11-29 00:26:12 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-11-29 00:26:12 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-11-29 00:26:12 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-11-29 00:26:12 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-11-29 00:26:12 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-29 00:26:12 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-11-29 00:26:12 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-11-29 00:26:13 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-29 00:26:13 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 27 mappings in 'requestMappingHandlerMapping'
2025-11-29 00:26:13 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-11-29 00:26:13 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-11-29 00:26:13 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-11-29 00:26:13 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-29 00:26:13 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-29 00:26:13 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 7.407 seconds (process running for 8.628)
2025-11-29 00:26:31 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-29 00:26:31 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-29 00:26:31 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-11-29 00:26:31 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-11-29 00:26:31 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-11-29 00:26:31 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@41b3dfdb
2025-11-29 00:26:31 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@755fa6dd
2025-11-29 00:26:31 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-11-29 00:26:31 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-11-29 00:26:31 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:26:31 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:26:31 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:26:31 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Failed to complete request: java.lang.RuntimeException: User not found or is deleted with id: 3ef54e3d-9b78-41b3-bdc9-54d68969117c
2025-11-29 00:26:31 [http-nio-8080-exec-1] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [/api] threw exception [Request processing failed: java.lang.RuntimeException: User not found or is deleted with id: 3ef54e3d-9b78-41b3-bdc9-54d68969117c] with root cause
java.lang.RuntimeException: User not found or is deleted with id: 3ef54e3d-9b78-41b3-bdc9-54d68969117c
	at com.example.speedcalendarserver.service.GroupService.lambda$getUserByToken$0(GroupService.java:38)
	at java.base/java.util.Optional.orElseThrow(Optional.java:403)
	at com.example.speedcalendarserver.service.GroupService.getUserByToken(GroupService.java:38)
	at com.example.speedcalendarserver.service.GroupService.getMyGroups(GroupService.java:91)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.GroupService$$SpringCGLIB$$0.getMyGroups(<generated>)
	at com.example.speedcalendarserver.controller.GroupController.getMyGroups(GroupController.java:42)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-11-29 00:26:31 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - "ERROR" dispatch for GET "/api/error", parameters={}
2025-11-29 00:26:31 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-11-29 00:26:31 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:26:31 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{timestamp=Sat Nov 29 00:26:31 CST 2025, status=500, error=Internal Server Error, trace=java.lang.Ru (truncated)...]
2025-11-29 00:26:31 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "ERROR" dispatch, status 500
2025-11-29 00:26:34 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-29 00:26:34 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-29 00:26:34 [http-nio-8080-exec-2] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, year: 2025, month: 11
2025-11-29 00:26:34 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: 3ef54e3d-9b78-41b3-bdc9-54d68969117c, 年: 2025, 月: 11
2025-11-29 00:26:34 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:26:34 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-29 00:26:34 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:26:34 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-29 00:26:34 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:26:36 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:26:36 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:26:36 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:26:36 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Failed to complete request: java.lang.RuntimeException: User not found or is deleted with id: 3ef54e3d-9b78-41b3-bdc9-54d68969117c
2025-11-29 00:26:36 [http-nio-8080-exec-3] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [/api] threw exception [Request processing failed: java.lang.RuntimeException: User not found or is deleted with id: 3ef54e3d-9b78-41b3-bdc9-54d68969117c] with root cause
java.lang.RuntimeException: User not found or is deleted with id: 3ef54e3d-9b78-41b3-bdc9-54d68969117c
	at com.example.speedcalendarserver.service.GroupService.lambda$getUserByToken$0(GroupService.java:38)
	at java.base/java.util.Optional.orElseThrow(Optional.java:403)
	at com.example.speedcalendarserver.service.GroupService.getUserByToken(GroupService.java:38)
	at com.example.speedcalendarserver.service.GroupService.getMyGroups(GroupService.java:91)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.GroupService$$SpringCGLIB$$0.getMyGroups(<generated>)
	at com.example.speedcalendarserver.controller.GroupController.getMyGroups(GroupController.java:42)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-11-29 00:26:36 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - "ERROR" dispatch for GET "/api/error", parameters={}
2025-11-29 00:26:36 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-11-29 00:26:36 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:26:36 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{timestamp=Sat Nov 29 00:26:36 CST 2025, status=500, error=Internal Server Error, trace=java.lang.Ru (truncated)...]
2025-11-29 00:26:36 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "ERROR" dispatch, status 500
2025-11-29 00:26:37 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:26:37 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:26:37 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/grp_a11e34cb-cf24-4699-8fd5-8dc76f8b851f", parameters={}
2025-11-29 00:26:37 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getGroupDetails(String, String)
2025-11-29 00:26:37 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:26:37 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Failed to complete request: java.lang.RuntimeException: User not found or is deleted with id: 3ef54e3d-9b78-41b3-bdc9-54d68969117c
2025-11-29 00:26:37 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:26:37 [http-nio-8080-exec-4] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [/api] threw exception [Request processing failed: java.lang.RuntimeException: User not found or is deleted with id: 3ef54e3d-9b78-41b3-bdc9-54d68969117c] with root cause
java.lang.RuntimeException: User not found or is deleted with id: 3ef54e3d-9b78-41b3-bdc9-54d68969117c
	at com.example.speedcalendarserver.service.GroupService.lambda$getUserByToken$0(GroupService.java:38)
	at java.base/java.util.Optional.orElseThrow(Optional.java:403)
	at com.example.speedcalendarserver.service.GroupService.getUserByToken(GroupService.java:38)
	at com.example.speedcalendarserver.service.GroupService.getMyGroups(GroupService.java:91)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.GroupService$$SpringCGLIB$$0.getMyGroups(<generated>)
	at com.example.speedcalendarserver.controller.GroupController.getMyGroups(GroupController.java:42)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-11-29 00:26:37 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - "ERROR" dispatch for GET "/api/error", parameters={}
2025-11-29 00:26:37 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-11-29 00:26:37 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:26:37 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{timestamp=Sat Nov 29 00:26:37 CST 2025, status=500, error=Internal Server Error, trace=java.lang.Ru (truncated)...]
2025-11-29 00:26:37 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Failed to complete request: java.lang.RuntimeException: User not found or is deleted with id: 3ef54e3d-9b78-41b3-bdc9-54d68969117c
2025-11-29 00:26:37 [http-nio-8080-exec-5] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [/api] threw exception [Request processing failed: java.lang.RuntimeException: User not found or is deleted with id: 3ef54e3d-9b78-41b3-bdc9-54d68969117c] with root cause
java.lang.RuntimeException: User not found or is deleted with id: 3ef54e3d-9b78-41b3-bdc9-54d68969117c
	at com.example.speedcalendarserver.service.GroupService.lambda$getUserByToken$0(GroupService.java:38)
	at java.base/java.util.Optional.orElseThrow(Optional.java:403)
	at com.example.speedcalendarserver.service.GroupService.getUserByToken(GroupService.java:38)
	at com.example.speedcalendarserver.service.GroupService.getGroupDetails(GroupService.java:107)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.GroupService$$SpringCGLIB$$0.getGroupDetails(<generated>)
	at com.example.speedcalendarserver.controller.GroupController.getGroupDetails(GroupController.java:49)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-11-29 00:26:37 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "ERROR" dispatch, status 500
2025-11-29 00:26:37 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - "ERROR" dispatch for GET "/api/error", parameters={}
2025-11-29 00:26:37 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-11-29 00:26:37 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:26:37 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{timestamp=Sat Nov 29 00:26:37 CST 2025, status=500, error=Internal Server Error, trace=java.lang.Ru (truncated)...]
2025-11-29 00:26:37 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "ERROR" dispatch, status 500
2025-11-29 00:26:38 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:26:38 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:26:38 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:26:38 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Failed to complete request: java.lang.RuntimeException: User not found or is deleted with id: 3ef54e3d-9b78-41b3-bdc9-54d68969117c
2025-11-29 00:26:38 [http-nio-8080-exec-6] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [/api] threw exception [Request processing failed: java.lang.RuntimeException: User not found or is deleted with id: 3ef54e3d-9b78-41b3-bdc9-54d68969117c] with root cause
java.lang.RuntimeException: User not found or is deleted with id: 3ef54e3d-9b78-41b3-bdc9-54d68969117c
	at com.example.speedcalendarserver.service.GroupService.lambda$getUserByToken$0(GroupService.java:38)
	at java.base/java.util.Optional.orElseThrow(Optional.java:403)
	at com.example.speedcalendarserver.service.GroupService.getUserByToken(GroupService.java:38)
	at com.example.speedcalendarserver.service.GroupService.getMyGroups(GroupService.java:91)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.GroupService$$SpringCGLIB$$0.getMyGroups(<generated>)
	at com.example.speedcalendarserver.controller.GroupController.getMyGroups(GroupController.java:42)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-11-29 00:26:38 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - "ERROR" dispatch for GET "/api/error", parameters={}
2025-11-29 00:26:38 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-11-29 00:26:38 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:26:38 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{timestamp=Sat Nov 29 00:26:38 CST 2025, status=500, error=Internal Server Error, trace=java.lang.Ru (truncated)...]
2025-11-29 00:26:38 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "ERROR" dispatch, status 500
2025-11-29 00:26:57 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/code", parameters={}
2025-11-29 00:26:57 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#sendCode(SendCodeRequest, HttpServletRequest)
2025-11-29 00:26:57 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [SendCodeRequest(phone=18006569106)]
2025-11-29 00:26:57 [http-nio-8080-exec-10] INFO  c.e.s.controller.AuthController - 【发送验证码】手机号: 18006569106, IP: 192.168.43.1
2025-11-29 00:26:57 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-29 00:26:57 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        count(vc1_0.id) 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.created_at>?
2025-11-29 00:26:57 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.expires_at<? 
        and vc1_0.status=?
2025-11-29 00:26:57 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    insert 
    into
        verification_codes
        (code, created_at, expires_at, ip_address, phone, status, type, used_at) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:26:57 [http-nio-8080-exec-10] INFO  c.e.s.service.AuthService - 【验证码】手机号: 18006569106, 验证码: 111252, 有效期: 300秒
2025-11-29 00:26:57 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:26:57 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=验证码发送成功, data=null)]
2025-11-29 00:26:57 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:27:08 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/login/phone", parameters={}
2025-11-29 00:27:08 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#phoneLogin(PhoneLoginRequest, HttpServletRequest)
2025-11-29 00:27:08 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PhoneLoginRequest(phone=18006569106, code=111252)]
2025-11-29 00:27:08 [http-nio-8080-exec-7] INFO  c.e.s.controller.AuthController - 【手机号登录】手机号: 18006569106, IP: 192.168.43.1
2025-11-29 00:27:08 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.code=? 
        and vc1_0.type=? 
        and vc1_0.status=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-29 00:27:08 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-11-29 00:27:08 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-11-29 00:27:08 [http-nio-8080-exec-7] INFO  c.e.s.service.AuthService - 【注册】新用户注册成功, userId: 6804a6aa-8b9c-4b09-bc2a-2fc9224e990c, phone: 18006569106
2025-11-29 00:27:08 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (avatar, bio, birthday, created_at, email, gender, is_deleted, last_login_ip, last_login_time, login_type, password, phone, status, updated_at, username, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:27:08 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_tokens
        (access_token, access_token_expires_at, created_at, device_id, device_type, ip_address, refresh_token, refresh_token_expires_at, status, updated_at, user_agent, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:27:08 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    update
        verification_codes 
    set
        code=?,
        expires_at=?,
        ip_address=?,
        phone=?,
        status=?,
        type=?,
        used_at=? 
    where
        id=?
2025-11-29 00:27:08 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    update
        users 
    set
        avatar=?,
        bio=?,
        birthday=?,
        email=?,
        gender=?,
        is_deleted=?,
        last_login_ip=?,
        last_login_time=?,
        login_type=?,
        password=?,
        phone=?,
        status=?,
        updated_at=?,
        username=? 
    where
        user_id=?
2025-11-29 00:27:08 [http-nio-8080-exec-7] INFO  c.e.s.controller.AuthController - 【登录成功】userId: 6804a6aa-8b9c-4b09-bc2a-2fc9224e990c, phone: 18006569106
2025-11-29 00:27:08 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:27:08 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=登录成功, data=LoginResponse(userId=6804a6aa-8b9c-4b09-bc2a-2fc9224e990c,  (truncated)...]
2025-11-29 00:27:08 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:27:12 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:27:12 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:27:12 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:27:12 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:27:12 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:27:12 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[]]
2025-11-29 00:27:12 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:27:16 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/groups", parameters={}
2025-11-29 00:27:16 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#createGroup(CreateGroupRequest, String)
2025-11-29 00:27:16 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateGroupRequest(name=A23计算机1)]
2025-11-29 00:27:16 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:27:16 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-29 00:27:16 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        (
            ug1_0.group_id, ug1_0.role, ug1_0.user_id
        ) in ((?, ?, ?))
2025-11-29 00:27:16 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    insert 
    into
        `group`
        (
            invitation_code, name, owner_id, id
        ) 
    values
        (?, ?, ?, ?)
2025-11-29 00:27:16 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_group
        (group_id, role, user_id) 
    values
        (?, ?, ?)
2025-11-29 00:27:16 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:27:16 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [GroupResponse(id=grp_a7201c53-cca6-4c8d-9d61-de0bf75b7ece, name=A23计算机1, ownerId=6804a6aa-8b9c-4b09- (truncated)...]
2025-11-29 00:27:16 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:27:58 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/code", parameters={}
2025-11-29 00:27:58 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#sendCode(SendCodeRequest, HttpServletRequest)
2025-11-29 00:27:58 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [SendCodeRequest(phone=13958689939)]
2025-11-29 00:27:58 [http-nio-8080-exec-1] INFO  c.e.s.controller.AuthController - 【发送验证码】手机号: 13958689939, IP: 192.168.43.1
2025-11-29 00:27:58 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-29 00:27:58 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        count(vc1_0.id) 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.created_at>?
2025-11-29 00:27:58 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.expires_at<? 
        and vc1_0.status=?
2025-11-29 00:27:58 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    insert 
    into
        verification_codes
        (code, created_at, expires_at, ip_address, phone, status, type, used_at) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:27:58 [http-nio-8080-exec-1] INFO  c.e.s.service.AuthService - 【验证码】手机号: 13958689939, 验证码: 376011, 有效期: 300秒
2025-11-29 00:27:58 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:27:58 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=验证码发送成功, data=null)]
2025-11-29 00:27:58 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:28:05 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/login/phone", parameters={}
2025-11-29 00:28:05 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#phoneLogin(PhoneLoginRequest, HttpServletRequest)
2025-11-29 00:28:05 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PhoneLoginRequest(phone=13958689939, code=376011)]
2025-11-29 00:28:05 [http-nio-8080-exec-2] INFO  c.e.s.controller.AuthController - 【手机号登录】手机号: 13958689939, IP: 192.168.43.1
2025-11-29 00:28:05 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.code=? 
        and vc1_0.type=? 
        and vc1_0.status=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-29 00:28:05 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-11-29 00:28:05 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-11-29 00:28:05 [http-nio-8080-exec-2] INFO  c.e.s.service.AuthService - 【注册】新用户注册成功, userId: 98b9e19b-1595-4841-a0c7-df71764fe684, phone: 13958689939
2025-11-29 00:28:05 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (avatar, bio, birthday, created_at, email, gender, is_deleted, last_login_ip, last_login_time, login_type, password, phone, status, updated_at, username, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:28:05 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_tokens
        (access_token, access_token_expires_at, created_at, device_id, device_type, ip_address, refresh_token, refresh_token_expires_at, status, updated_at, user_agent, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:28:05 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    update
        verification_codes 
    set
        code=?,
        expires_at=?,
        ip_address=?,
        phone=?,
        status=?,
        type=?,
        used_at=? 
    where
        id=?
2025-11-29 00:28:05 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    update
        users 
    set
        avatar=?,
        bio=?,
        birthday=?,
        email=?,
        gender=?,
        is_deleted=?,
        last_login_ip=?,
        last_login_time=?,
        login_type=?,
        password=?,
        phone=?,
        status=?,
        updated_at=?,
        username=? 
    where
        user_id=?
2025-11-29 00:28:05 [http-nio-8080-exec-2] INFO  c.e.s.controller.AuthController - 【登录成功】userId: 98b9e19b-1595-4841-a0c7-df71764fe684, phone: 13958689939
2025-11-29 00:28:05 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:28:05 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=登录成功, data=LoginResponse(userId=98b9e19b-1595-4841-a0c7-df71764fe684,  (truncated)...]
2025-11-29 00:28:05 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:28:25 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - PUT "/api/auth/user/98b9e19b-1595-4841-a0c7-df71764fe684", parameters={}
2025-11-29 00:28:25 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#updateUserInfo(String, UpdateUserInfoRequest)
2025-11-29 00:28:25 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [UpdateUserInfoRequest(username=徐林锋, avatar=null)]
2025-11-29 00:28:25 [http-nio-8080-exec-3] INFO  c.e.s.controller.AuthController - 【更新用户信息】userId: 98b9e19b-1595-4841-a0c7-df71764fe684, request: UpdateUserInfoRequest(username=徐林锋, avatar=null)
2025-11-29 00:28:25 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-11-29 00:28:25 [http-nio-8080-exec-3] INFO  c.e.s.service.AuthService - 【更新用户信息】userId: 98b9e19b-1595-4841-a0c7-df71764fe684, username: 徐林锋
2025-11-29 00:28:25 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    update
        users 
    set
        avatar=?,
        bio=?,
        birthday=?,
        email=?,
        gender=?,
        is_deleted=?,
        last_login_ip=?,
        last_login_time=?,
        login_type=?,
        password=?,
        phone=?,
        status=?,
        updated_at=?,
        username=? 
    where
        user_id=?
2025-11-29 00:28:26 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:28:26 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=更新成功, data=UserInfo(userId=98b9e19b-1595-4841-a0c7-df71764fe684, phone (truncated)...]
2025-11-29 00:28:26 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:28:35 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:28:35 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:28:35 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:28:35 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:28:35 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:28:35 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[]]
2025-11-29 00:28:35 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:28:43 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/groups/join-with-code", parameters={}
2025-11-29 00:28:43 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#joinGroupWithCode(JoinGroupRequest, String)
2025-11-29 00:28:43 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [JoinGroupRequest(invitationCode=M9UmAO0B)]
2025-11-29 00:28:43 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:28:43 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.invitation_code=?
2025-11-29 00:28:43 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=? 
        and ug1_0.group_id=?
2025-11-29 00:28:43 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        (
            ug1_0.group_id, ug1_0.role, ug1_0.user_id
        ) in ((?, ?, ?))
2025-11-29 00:28:43 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_group
        (group_id, role, user_id) 
    values
        (?, ?, ?)
2025-11-29 00:28:43 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:28:43 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [GroupResponse(id=grp_a7201c53-cca6-4c8d-9d61-de0bf75b7ece, name=A23计算机1, ownerId=6804a6aa-8b9c-4b09- (truncated)...]
2025-11-29 00:28:43 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:29:04 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/code", parameters={}
2025-11-29 00:29:04 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#sendCode(SendCodeRequest, HttpServletRequest)
2025-11-29 00:29:04 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [SendCodeRequest(phone=18006569106)]
2025-11-29 00:29:04 [http-nio-8080-exec-6] INFO  c.e.s.controller.AuthController - 【发送验证码】手机号: 18006569106, IP: 192.168.43.1
2025-11-29 00:29:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-29 00:29:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(vc1_0.id) 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.created_at>?
2025-11-29 00:29:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.expires_at<? 
        and vc1_0.status=?
2025-11-29 00:29:04 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        verification_codes
        (code, created_at, expires_at, ip_address, phone, status, type, used_at) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:29:04 [http-nio-8080-exec-6] INFO  c.e.s.service.AuthService - 【验证码】手机号: 18006569106, 验证码: 124986, 有效期: 300秒
2025-11-29 00:29:04 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:29:04 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=验证码发送成功, data=null)]
2025-11-29 00:29:04 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:29:11 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/login/phone", parameters={}
2025-11-29 00:29:11 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#phoneLogin(PhoneLoginRequest, HttpServletRequest)
2025-11-29 00:29:11 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PhoneLoginRequest(phone=18006569106, code=124986)]
2025-11-29 00:29:11 [http-nio-8080-exec-10] INFO  c.e.s.controller.AuthController - 【手机号登录】手机号: 18006569106, IP: 192.168.43.1
2025-11-29 00:29:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.code=? 
        and vc1_0.type=? 
        and vc1_0.status=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-29 00:29:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-11-29 00:29:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_tokens
        (access_token, access_token_expires_at, created_at, device_id, device_type, ip_address, refresh_token, refresh_token_expires_at, status, updated_at, user_agent, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:29:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    update
        verification_codes 
    set
        code=?,
        expires_at=?,
        ip_address=?,
        phone=?,
        status=?,
        type=?,
        used_at=? 
    where
        id=?
2025-11-29 00:29:11 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    update
        users 
    set
        avatar=?,
        bio=?,
        birthday=?,
        email=?,
        gender=?,
        is_deleted=?,
        last_login_ip=?,
        last_login_time=?,
        login_type=?,
        password=?,
        phone=?,
        status=?,
        updated_at=?,
        username=? 
    where
        user_id=?
2025-11-29 00:29:11 [http-nio-8080-exec-10] INFO  c.e.s.controller.AuthController - 【登录成功】userId: 6804a6aa-8b9c-4b09-bc2a-2fc9224e990c, phone: 18006569106
2025-11-29 00:29:11 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:29:11 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=登录成功, data=LoginResponse(userId=6804a6aa-8b9c-4b09-bc2a-2fc9224e990c,  (truncated)...]
2025-11-29 00:29:11 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:29:20 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - PUT "/api/auth/user/6804a6aa-8b9c-4b09-bc2a-2fc9224e990c", parameters={}
2025-11-29 00:29:20 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#updateUserInfo(String, UpdateUserInfoRequest)
2025-11-29 00:29:20 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [UpdateUserInfoRequest(username=江杭羲, avatar=null)]
2025-11-29 00:29:20 [http-nio-8080-exec-7] INFO  c.e.s.controller.AuthController - 【更新用户信息】userId: 6804a6aa-8b9c-4b09-bc2a-2fc9224e990c, request: UpdateUserInfoRequest(username=江杭羲, avatar=null)
2025-11-29 00:29:20 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-11-29 00:29:20 [http-nio-8080-exec-7] INFO  c.e.s.service.AuthService - 【更新用户信息】userId: 6804a6aa-8b9c-4b09-bc2a-2fc9224e990c, username: 江杭羲
2025-11-29 00:29:20 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    update
        users 
    set
        avatar=?,
        bio=?,
        birthday=?,
        email=?,
        gender=?,
        is_deleted=?,
        last_login_ip=?,
        last_login_time=?,
        login_type=?,
        password=?,
        phone=?,
        status=?,
        updated_at=?,
        username=? 
    where
        user_id=?
2025-11-29 00:29:20 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:29:20 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=更新成功, data=UserInfo(userId=6804a6aa-8b9c-4b09-bc2a-2fc9224e990c, phone (truncated)...]
2025-11-29 00:29:20 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:29:28 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:29:28 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:29:28 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:29:28 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:29:28 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-29 00:29:28 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:29:28 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_a7201c53-cca6-4c8d-9d61-de0bf75b7ece, groupName=A23计算机1, role=admin)]]
2025-11-29 00:29:28 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:29:30 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:29:30 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:29:30 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:29:30 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:29:30 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-29 00:29:30 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:29:30 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_a7201c53-cca6-4c8d-9d61-de0bf75b7ece, groupName=A23计算机1, role=admin)]]
2025-11-29 00:29:30 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:29:30 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:29:30 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:29:30 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:29:30 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:29:30 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-29 00:29:30 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:29:30 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_a7201c53-cca6-4c8d-9d61-de0bf75b7ece, groupName=A23计算机1, role=admin)]]
2025-11-29 00:29:30 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:29:30 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:29:30 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:29:30 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:29:30 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:29:30 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-29 00:29:30 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:29:30 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_a7201c53-cca6-4c8d-9d61-de0bf75b7ece, groupName=A23计算机1, role=admin)]]
2025-11-29 00:29:30 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:29:31 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/grp_a7201c53-cca6-4c8d-9d61-de0bf75b7ece", parameters={}
2025-11-29 00:29:31 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getGroupDetails(String, String)
2025-11-29 00:29:31 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:29:31 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-29 00:29:31 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=? 
        and ug1_0.group_id=?
2025-11-29 00:29:31 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.group_id=?
2025-11-29 00:29:31 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-11-29 00:29:31 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:29:31 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [GroupDetailResponse(id=grp_a7201c53-cca6-4c8d-9d61-de0bf75b7ece, name=A23计算机1, ownerId=6804a6aa-8b9c (truncated)...]
2025-11-29 00:29:31 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:29:33 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:29:33 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:29:33 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:29:33 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:29:33 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-29 00:29:33 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:29:33 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_a7201c53-cca6-4c8d-9d61-de0bf75b7ece, groupName=A23计算机1, role=admin)]]
2025-11-29 00:29:33 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:29:35 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-29 00:29:35 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-29 00:29:35 [http-nio-8080-exec-5] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: 6804a6aa-8b9c-4b09-bc2a-2fc9224e990c, year: 2025, month: 11
2025-11-29 00:29:35 [http-nio-8080-exec-5] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: 6804a6aa-8b9c-4b09-bc2a-2fc9224e990c, 年: 2025, 月: 11
2025-11-29 00:29:35 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:29:35 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and s1_0.group_id in (?)
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-29 00:29:35 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:29:35 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-29 00:29:35 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:29:36 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:29:36 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:29:36 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:29:36 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:29:36 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-29 00:29:36 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:29:36 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_a7201c53-cca6-4c8d-9d61-de0bf75b7ece, groupName=A23计算机1, role=admin)]]
2025-11-29 00:29:36 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:29:48 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-29 00:29:48 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-29 00:29:48 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=班会, scheduleDate=2025-11-29, startTime=09:00, endTime=null, location=213 (truncated)...]
2025-11-29 00:29:48 [http-nio-8080-exec-10] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: 6804a6aa-8b9c-4b09-bc2a-2fc9224e990c, title: 班会
2025-11-29 00:29:48 [http-nio-8080-exec-10] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: 6804a6aa-8b9c-4b09-bc2a-2fc9224e990c, 标题: 班会, 群组ID: grp_a7201c53-cca6-4c8d-9d61-de0bf75b7ece
2025-11-29 00:29:48 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=? 
        and ug1_0.group_id=?
2025-11-29 00:29:48 [http-nio-8080-exec-10] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: 3b368e13-94c2-4b6c-b4cc-5e29a53833db
2025-11-29 00:29:48 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:29:48 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:29:48 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=创建成功, data=ScheduleDTO(scheduleId=3b368e13-94c2-4b6c-b4cc-5e29a53833db (truncated)...]
2025-11-29 00:29:48 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:29:48 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-29 00:29:48 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-29 00:29:48 [http-nio-8080-exec-7] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: 6804a6aa-8b9c-4b09-bc2a-2fc9224e990c, year: 2025, month: 11
2025-11-29 00:29:48 [http-nio-8080-exec-7] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: 6804a6aa-8b9c-4b09-bc2a-2fc9224e990c, 年: 2025, 月: 11
2025-11-29 00:29:48 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:29:48 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and s1_0.group_id in (?)
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-29 00:29:48 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:29:48 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=3b368e13-94c2-4b6c-b4cc-5e29a53833d (truncated)...]
2025-11-29 00:29:48 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:29:54 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-29 00:29:54 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-29 00:29:54 [http-nio-8080-exec-9] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: 6804a6aa-8b9c-4b09-bc2a-2fc9224e990c, year: 2025, month: 11
2025-11-29 00:29:54 [http-nio-8080-exec-9] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: 6804a6aa-8b9c-4b09-bc2a-2fc9224e990c, 年: 2025, 月: 11
2025-11-29 00:29:54 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:29:54 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and s1_0.group_id in (?)
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-29 00:29:54 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:29:54 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=3b368e13-94c2-4b6c-b4cc-5e29a53833d (truncated)...]
2025-11-29 00:29:54 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:29:55 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:29:55 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:29:55 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:29:55 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:29:55 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-29 00:29:55 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:29:55 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_a7201c53-cca6-4c8d-9d61-de0bf75b7ece, groupName=A23计算机1, role=admin)]]
2025-11-29 00:29:55 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:29:57 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-29 00:29:57 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-29 00:29:57 [http-nio-8080-exec-1] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: 6804a6aa-8b9c-4b09-bc2a-2fc9224e990c, year: 2025, month: 11
2025-11-29 00:29:57 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: 6804a6aa-8b9c-4b09-bc2a-2fc9224e990c, 年: 2025, 月: 11
2025-11-29 00:29:57 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:29:57 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and s1_0.group_id in (?)
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-29 00:29:57 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:29:57 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=3b368e13-94c2-4b6c-b4cc-5e29a53833d (truncated)...]
2025-11-29 00:29:57 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:30:10 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/code", parameters={}
2025-11-29 00:30:10 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#sendCode(SendCodeRequest, HttpServletRequest)
2025-11-29 00:30:10 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [SendCodeRequest(phone=13958689939)]
2025-11-29 00:30:10 [http-nio-8080-exec-2] INFO  c.e.s.controller.AuthController - 【发送验证码】手机号: 13958689939, IP: 192.168.43.1
2025-11-29 00:30:10 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-29 00:30:10 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        count(vc1_0.id) 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.created_at>?
2025-11-29 00:30:10 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.expires_at<? 
        and vc1_0.status=?
2025-11-29 00:30:10 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        verification_codes
        (code, created_at, expires_at, ip_address, phone, status, type, used_at) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:30:10 [http-nio-8080-exec-2] INFO  c.e.s.service.AuthService - 【验证码】手机号: 13958689939, 验证码: 257590, 有效期: 300秒
2025-11-29 00:30:10 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:30:10 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=验证码发送成功, data=null)]
2025-11-29 00:30:10 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:30:16 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/login/phone", parameters={}
2025-11-29 00:30:16 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#phoneLogin(PhoneLoginRequest, HttpServletRequest)
2025-11-29 00:30:16 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PhoneLoginRequest(phone=13958689939, code=257590)]
2025-11-29 00:30:16 [http-nio-8080-exec-3] INFO  c.e.s.controller.AuthController - 【手机号登录】手机号: 13958689939, IP: 192.168.43.1
2025-11-29 00:30:16 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.code=? 
        and vc1_0.type=? 
        and vc1_0.status=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-29 00:30:16 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-11-29 00:30:16 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_tokens
        (access_token, access_token_expires_at, created_at, device_id, device_type, ip_address, refresh_token, refresh_token_expires_at, status, updated_at, user_agent, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-29 00:30:16 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    update
        verification_codes 
    set
        code=?,
        expires_at=?,
        ip_address=?,
        phone=?,
        status=?,
        type=?,
        used_at=? 
    where
        id=?
2025-11-29 00:30:16 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    update
        users 
    set
        avatar=?,
        bio=?,
        birthday=?,
        email=?,
        gender=?,
        is_deleted=?,
        last_login_ip=?,
        last_login_time=?,
        login_type=?,
        password=?,
        phone=?,
        status=?,
        updated_at=?,
        username=? 
    where
        user_id=?
2025-11-29 00:30:16 [http-nio-8080-exec-3] INFO  c.e.s.controller.AuthController - 【登录成功】userId: 98b9e19b-1595-4841-a0c7-df71764fe684, phone: 13958689939
2025-11-29 00:30:16 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:30:16 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=登录成功, data=LoginResponse(userId=98b9e19b-1595-4841-a0c7-df71764fe684,  (truncated)...]
2025-11-29 00:30:16 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:30:18 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-29 00:30:18 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-29 00:30:18 [http-nio-8080-exec-4] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: 98b9e19b-1595-4841-a0c7-df71764fe684, year: 2025, month: 11
2025-11-29 00:30:18 [http-nio-8080-exec-4] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: 98b9e19b-1595-4841-a0c7-df71764fe684, 年: 2025, 月: 11
2025-11-29 00:30:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:30:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and s1_0.group_id in (?)
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-29 00:30:18 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:30:18 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=3b368e13-94c2-4b6c-b4cc-5e29a53833d (truncated)...]
2025-11-29 00:30:18 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-29 00:30:41 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-29 00:30:41 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-29 00:30:41 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-29 00:30:41 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-29 00:30:41 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.invitation_code,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-29 00:30:41 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-29 00:30:41 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_a7201c53-cca6-4c8d-9d61-de0bf75b7ece, groupName=A23计算机1, role=member)]]
2025-11-29 00:30:41 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:35:56 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.7 with PID 12108 (C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server\target\classes started by 18241 in C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server)
2025-12-02 21:35:56 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-02 21:35:56 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-02 21:35:56 [restartedMain] INFO  o.s.b.d.restart.ChangeableUrls - The Class-Path manifest attribute in C:\Users\18241\.m2\repository\org\apache\opennlp\opennlp-tools\2.5.4\opennlp-tools-2.5.4.jar referenced one or more files that do not exist: file:/C:/Users/18241/.m2/repository/org/apache/opennlp/opennlp-tools/2.5.4/slf4j-api-2.0.17.jar
2025-12-02 21:35:56 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-12-02 21:35:56 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-12-02 21:35:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 21:35:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-02 21:35:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 93 ms. Found 9 JPA repository interfaces.
2025-12-02 21:35:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 21:35:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-02 21:35:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:35:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:35:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:35:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:35:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:35:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:35:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:35:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:35:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:35:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 6 ms. Found 0 Redis repository interfaces.
2025-12-02 21:35:57 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-02 21:35:57 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-02 21:35:57 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-02 21:35:57 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-02 21:35:57 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1099 ms
2025-12-02 21:35:57 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-02 21:35:57 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-12-02 21:35:57 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-02 21:35:58 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-02 21:35:58 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-12-02 21:35:58 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@121fad0e
2025-12-02 21:35:58 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-12-02 21:35:58 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-02 21:35:58 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-12-02 21:35:58 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-02 21:35:58 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-02 21:35:58 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 21:35:58 [restartedMain] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-12-02 21:35:59 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 21:35:59 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-12-02 21:35:59 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-12-02 21:35:59 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-12-02 21:35:59 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-12-02 21:35:59 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-12-02 21:35:59 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 21:35:59 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-12-02 21:35:59 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-12-02 21:36:00 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-02 21:36:00 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 27 mappings in 'requestMappingHandlerMapping'
2025-12-02 21:36:00 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-02 21:36:00 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-02 21:36:00 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-02 21:36:00 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-12-02 21:36:00 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-02 21:36:00 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 4.235 seconds (process running for 4.708)
2025-12-02 21:38:45 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-02 21:38:45 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-02 21:38:45 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-12-02 21:38:45 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-12-02 21:38:45 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-12-02 21:38:45 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@6689c4c4
2025-12-02 21:38:45 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@40d5df86
2025-12-02 21:38:45 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-12-02 21:38:45 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-02 21:38:45 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=12", parameters={masked}
2025-12-02 21:38:45 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-12-02 21:38:45 [http-nio-8080-exec-1] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: d60347da-da6f-4d3e-8adc-0bcdbba53692, year: 2025, month: 12
2025-12-02 21:38:45 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: d60347da-da6f-4d3e-8adc-0bcdbba53692, 年: 2025, 月: 12
2025-12-02 21:38:45 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 21:38:45 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 21:38:45 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:38:45 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-12-02 21:38:45 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:39:35 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=12", parameters={masked}
2025-12-02 21:39:35 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-12-02 21:39:35 [http-nio-8080-exec-3] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: d60347da-da6f-4d3e-8adc-0bcdbba53692, year: 2025, month: 12
2025-12-02 21:39:35 [http-nio-8080-exec-3] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: d60347da-da6f-4d3e-8adc-0bcdbba53692, 年: 2025, 月: 12
2025-12-02 21:39:35 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 21:39:35 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 21:39:35 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:39:35 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-12-02 21:39:35 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:39:40 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-12-02 21:39:40 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-12-02 21:39:40 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-12-02 21:39:40 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Failed to complete request: java.lang.RuntimeException: User not found or is deleted with id: d60347da-da6f-4d3e-8adc-0bcdbba53692
2025-12-02 21:39:40 [http-nio-8080-exec-2] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [/api] threw exception [Request processing failed: java.lang.RuntimeException: User not found or is deleted with id: d60347da-da6f-4d3e-8adc-0bcdbba53692] with root cause
java.lang.RuntimeException: User not found or is deleted with id: d60347da-da6f-4d3e-8adc-0bcdbba53692
	at com.example.speedcalendarserver.service.GroupService.lambda$getUserByToken$0(GroupService.java:38)
	at java.base/java.util.Optional.orElseThrow(Optional.java:403)
	at com.example.speedcalendarserver.service.GroupService.getUserByToken(GroupService.java:38)
	at com.example.speedcalendarserver.service.GroupService.getMyGroups(GroupService.java:91)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.GroupService$$SpringCGLIB$$0.getMyGroups(<generated>)
	at com.example.speedcalendarserver.controller.GroupController.getMyGroups(GroupController.java:42)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-12-02 21:39:40 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - "ERROR" dispatch for GET "/api/error", parameters={}
2025-12-02 21:39:40 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-12-02 21:39:40 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:39:40 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{timestamp=Tue Dec 02 21:39:40 CST 2025, status=500, error=Internal Server Error, trace=java.lang.Ru (truncated)...]
2025-12-02 21:39:40 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "ERROR" dispatch, status 500
2025-12-02 21:39:41 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=12", parameters={masked}
2025-12-02 21:39:41 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-12-02 21:39:41 [http-nio-8080-exec-4] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: d60347da-da6f-4d3e-8adc-0bcdbba53692, year: 2025, month: 12
2025-12-02 21:39:41 [http-nio-8080-exec-4] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: d60347da-da6f-4d3e-8adc-0bcdbba53692, 年: 2025, 月: 12
2025-12-02 21:39:41 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 21:39:41 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 21:39:41 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:39:41 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-12-02 21:39:41 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:39:43 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-12-02 21:39:43 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-12-02 21:39:43 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-12-02 21:39:43 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Failed to complete request: java.lang.RuntimeException: User not found or is deleted with id: d60347da-da6f-4d3e-8adc-0bcdbba53692
2025-12-02 21:39:43 [http-nio-8080-exec-5] ERROR o.a.c.c.C.[.[.[.[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [/api] threw exception [Request processing failed: java.lang.RuntimeException: User not found or is deleted with id: d60347da-da6f-4d3e-8adc-0bcdbba53692] with root cause
java.lang.RuntimeException: User not found or is deleted with id: d60347da-da6f-4d3e-8adc-0bcdbba53692
	at com.example.speedcalendarserver.service.GroupService.lambda$getUserByToken$0(GroupService.java:38)
	at java.base/java.util.Optional.orElseThrow(Optional.java:403)
	at com.example.speedcalendarserver.service.GroupService.getUserByToken(GroupService.java:38)
	at com.example.speedcalendarserver.service.GroupService.getMyGroups(GroupService.java:91)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.GroupService$$SpringCGLIB$$0.getMyGroups(<generated>)
	at com.example.speedcalendarserver.controller.GroupController.getMyGroups(GroupController.java:42)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-12-02 21:39:43 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - "ERROR" dispatch for GET "/api/error", parameters={}
2025-12-02 21:39:43 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-12-02 21:39:43 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:39:43 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{timestamp=Tue Dec 02 21:39:43 CST 2025, status=500, error=Internal Server Error, trace=java.lang.Ru (truncated)...]
2025-12-02 21:39:43 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "ERROR" dispatch, status 500
2025-12-02 21:42:28 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=12", parameters={masked}
2025-12-02 21:42:28 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-12-02 21:42:28 [http-nio-8080-exec-6] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: d60347da-da6f-4d3e-8adc-0bcdbba53692, year: 2025, month: 12
2025-12-02 21:42:28 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: d60347da-da6f-4d3e-8adc-0bcdbba53692, 年: 2025, 月: 12
2025-12-02 21:42:28 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 21:42:28 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 21:42:28 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:42:28 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-12-02 21:42:28 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:42:30 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ai/chat/sessions", parameters={}
2025-12-02 21:42:30 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#getSessions(HttpServletRequest)
2025-12-02 21:42:30 [http-nio-8080-exec-7] INFO  c.e.s.controller.AiChatController - 【获取会话列表】userId: d60347da-da6f-4d3e-8adc-0bcdbba53692
2025-12-02 21:42:30 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.user_id=? 
        and cs1_0.is_deleted=? 
    order by
        cs1_0.last_message_at desc,
        cs1_0.created_at desc
2025-12-02 21:42:30 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:42:30 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-12-02 21:42:30 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:42:46 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 21:42:46 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 21:42:46 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我添加一个今天十一点的日程，去洗脸, sessionId=null, userId=null)]
2025-12-02 21:42:46 [http-nio-8080-exec-8] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: d60347da-da6f-4d3e-8adc-0bcdbba53692, sessionId: null, message: 帮我添加一个今天十一点的日程，去洗脸
2025-12-02 21:42:46 [http-nio-8080-exec-8] INFO  c.e.s.service.AiChatService - 准备为用户 d60347da-da6f-4d3e-8adc-0bcdbba53692 创建新会话...
2025-12-02 21:42:46 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=?
2025-12-02 21:42:46 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_sessions
        (created_at, is_deleted, last_message_at, message_count, status, title, updated_at, user_id, session_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:42:46 [http-nio-8080-exec-8] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1452, SQLState: 23000
2025-12-02 21:42:46 [http-nio-8080-exec-8] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)
2025-12-02 21:42:46 [http-nio-8080-exec-8] ERROR c.e.s.controller.AiChatController - 【AI服务异常】could not execute statement [Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)] [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]; SQL [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]; constraint [null]
org.springframework.dao.DataIntegrityViolationException: could not execute statement [Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)] [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]; SQL [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]; constraint [null]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy152.save(Unknown Source)
	at com.example.speedcalendarserver.service.AiChatService.createSession(AiChatService.java:58)
	at com.example.speedcalendarserver.service.AiChatService.sendMessage(AiChatService.java:128)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.AiChatService$$SpringCGLIB$$0.sendMessage(<generated>)
	at com.example.speedcalendarserver.controller.AiChatController.sendMessage(AiChatController.java:182)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)] [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:62)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 68 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:109)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 89 common frames omitted
2025-12-02 21:42:46 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:42:46 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=503, message=AI服务暂时不可用，请稍后重试, data=null)]
2025-12-02 21:42:46 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:43:55 [File Watcher] INFO  o.s.b.d.a.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 1 class path change (0 additions, 0 deletions, 1 modification)
2025-12-02 21:43:55 [Thread-5] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-02 21:43:55 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-02 21:43:55 [Thread-5] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 21:43:55 [Thread-5] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-12-02 21:43:55 [Thread-5] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-12-02 21:43:55 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.7 with PID 12108 (C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server\target\classes started by 18241 in C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server)
2025-12-02 21:43:55 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-02 21:43:55 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-02 21:43:55 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 21:43:55 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-02 21:43:55 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 9 JPA repository interfaces.
2025-12-02 21:43:55 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 21:43:55 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-02 21:43:55 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:43:55 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:43:55 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:43:55 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:43:55 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:43:55 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:43:55 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:43:55 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:43:55 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:43:55 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-12-02 21:43:55 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-02 21:43:55 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-02 21:43:55 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-02 21:43:55 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-02 21:43:55 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 247 ms
2025-12-02 21:43:55 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-02 21:43:55 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-02 21:43:55 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-02 21:43:55 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Starting...
2025-12-02 21:43:55 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-2 - Added connection com.mysql.cj.jdbc.ConnectionImpl@7ccac4fe
2025-12-02 21:43:55 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Start completed.
2025-12-02 21:43:55 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-02 21:43:55 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-12-02 21:43:55 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-2)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-02 21:43:55 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-02 21:43:55 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 21:43:55 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 21:43:55 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-12-02 21:43:55 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-12-02 21:43:55 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-12-02 21:43:55 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-12-02 21:43:55 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-12-02 21:43:55 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 21:43:55 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-12-02 21:43:55 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-12-02 21:43:55 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-02 21:43:55 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 27 mappings in 'requestMappingHandlerMapping'
2025-12-02 21:43:55 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-02 21:43:55 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-02 21:43:55 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-02 21:43:55 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-12-02 21:43:55 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-02 21:43:55 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 0.644 seconds (process running for 480.107)
2025-12-02 21:43:55 [restartedMain] INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener - Condition evaluation unchanged
2025-12-02 21:44:05 [File Watcher] INFO  o.s.b.d.a.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 1 class path change (0 additions, 0 deletions, 1 modification)
2025-12-02 21:44:05 [Thread-7] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-02 21:44:05 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-02 21:44:05 [Thread-7] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 21:44:05 [Thread-7] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown initiated...
2025-12-02 21:44:05 [Thread-7] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown completed.
2025-12-02 21:44:05 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.7 with PID 12108 (C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server\target\classes started by 18241 in C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server)
2025-12-02 21:44:05 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-02 21:44:05 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-02 21:44:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 21:44:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-02 21:44:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 9 JPA repository interfaces.
2025-12-02 21:44:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 21:44:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-02 21:44:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:44:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:44:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:44:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:44:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:44:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:44:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:44:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:44:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:44:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-12-02 21:44:05 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-02 21:44:05 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-02 21:44:05 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-02 21:44:05 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-02 21:44:05 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 233 ms
2025-12-02 21:44:05 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-02 21:44:05 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-02 21:44:05 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-02 21:44:05 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Starting...
2025-12-02 21:44:05 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-3 - Added connection com.mysql.cj.jdbc.ConnectionImpl@3adc0eed
2025-12-02 21:44:05 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Start completed.
2025-12-02 21:44:05 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-02 21:44:05 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-12-02 21:44:05 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-3)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-02 21:44:05 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-02 21:44:05 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 21:44:05 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 21:44:05 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-12-02 21:44:05 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-12-02 21:44:05 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-12-02 21:44:05 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-12-02 21:44:05 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-12-02 21:44:05 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 21:44:05 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-12-02 21:44:05 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-12-02 21:44:06 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-02 21:44:06 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 27 mappings in 'requestMappingHandlerMapping'
2025-12-02 21:44:06 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-02 21:44:06 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-02 21:44:06 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-02 21:44:06 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-12-02 21:44:06 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-02 21:44:06 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 0.539 seconds (process running for 490.362)
2025-12-02 21:44:06 [restartedMain] INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener - Condition evaluation unchanged
2025-12-02 21:45:17 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-02 21:45:17 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-02 21:45:17 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-12-02 21:45:17 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-12-02 21:45:17 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-12-02 21:45:17 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@6f78653b
2025-12-02 21:45:17 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@755009f8
2025-12-02 21:45:17 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-12-02 21:45:17 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-02 21:45:17 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 21:45:17 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 21:45:17 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我添加一个今天十一点的日程，去洗脸, sessionId=null, userId=null)]
2025-12-02 21:45:17 [http-nio-8080-exec-1] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: d60347da-da6f-4d3e-8adc-0bcdbba53692, sessionId: null, message: 帮我添加一个今天十一点的日程，去洗脸
2025-12-02 21:45:17 [http-nio-8080-exec-1] INFO  c.e.s.service.AiChatService - 准备为用户 d60347da-da6f-4d3e-8adc-0bcdbba53692 创建新会话...
2025-12-02 21:45:17 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=?
2025-12-02 21:45:17 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_sessions
        (created_at, is_deleted, last_message_at, message_count, status, title, updated_at, user_id, session_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:45:17 [http-nio-8080-exec-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1452, SQLState: 23000
2025-12-02 21:45:17 [http-nio-8080-exec-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)
2025-12-02 21:45:17 [http-nio-8080-exec-1] ERROR c.e.s.controller.AiChatController - 【AI服务异常】could not execute statement [Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)] [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]; SQL [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]; constraint [null]
org.springframework.dao.DataIntegrityViolationException: could not execute statement [Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)] [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]; SQL [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]; constraint [null]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294) ~[spring-orm-6.2.12.jar:6.2.12]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256) ~[spring-orm-6.2.12.jar:6.2.12]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241) ~[spring-orm-6.2.12.jar:6.2.12]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567) ~[spring-orm-6.2.12.jar:6.2.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795) ~[spring-tx-6.2.12.jar:6.2.12]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758) ~[spring-tx-6.2.12.jar:6.2.12]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698) ~[spring-tx-6.2.12.jar:6.2.12]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416) ~[spring-tx-6.2.12.jar:6.2.12]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165) ~[spring-data-jpa-3.5.5.jar:3.5.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.12.jar:6.2.12]
	at jdk.proxy6/jdk.proxy6.$Proxy189.save(Unknown Source) ~[na:na]
	at com.example.speedcalendarserver.service.AiChatService.createSession(AiChatService.java:58) ~[classes/:na]
	at com.example.speedcalendarserver.service.AiChatService.sendMessage(AiChatService.java:128) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360) ~[spring-aop-6.2.12.jar:6.2.12]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724) ~[spring-aop-6.2.12.jar:6.2.12]
	at com.example.speedcalendarserver.service.AiChatService$$SpringCGLIB$$0.sendMessage(<generated>) ~[classes/:na]
	at com.example.speedcalendarserver.controller.AiChatController.sendMessage(AiChatController.java:182) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.12.jar:6.2.12]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.48.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.12.jar:6.2.12]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.12.jar:6.2.12]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.48.jar:10.1.48]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)] [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:62) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563) ~[spring-orm-6.2.12.jar:6.2.12]
	... 68 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:109) ~[mysql-connector-j-9.4.0.jar:9.4.0]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114) ~[mysql-connector-j-9.4.0.jar:9.4.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988) ~[mysql-connector-j-9.4.0.jar:9.4.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166) ~[mysql-connector-j-9.4.0.jar:9.4.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101) ~[mysql-connector-j-9.4.0.jar:9.4.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448) ~[mysql-connector-j-9.4.0.jar:9.4.0]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084) ~[mysql-connector-j-9.4.0.jar:9.4.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-6.3.3.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-6.3.3.jar:na]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194) ~[hibernate-core-6.6.33.Final.jar:6.6.33.Final]
	... 89 common frames omitted
2025-12-02 21:45:17 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:45:17 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=503, message=AI服务暂时不可用，请稍后重试, data=null)]
2025-12-02 21:45:17 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:45:33 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/code", parameters={}
2025-12-02 21:45:33 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#sendCode(SendCodeRequest, HttpServletRequest)
2025-12-02 21:45:33 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [SendCodeRequest(phone=19818039183)]
2025-12-02 21:45:33 [http-nio-8080-exec-2] INFO  c.e.s.controller.AuthController - 【发送验证码】手机号: 19818039183, IP: 127.0.0.1
2025-12-02 21:45:33 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-12-02 21:45:33 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        count(vc1_0.id) 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.created_at>?
2025-12-02 21:45:33 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.expires_at<? 
        and vc1_0.status=?
2025-12-02 21:45:33 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        verification_codes
        (code, created_at, expires_at, ip_address, phone, status, type, used_at) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:45:33 [http-nio-8080-exec-2] INFO  c.e.s.service.AuthService - 【验证码】手机号: 19818039183, 验证码: 139067, 有效期: 300秒
2025-12-02 21:45:33 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:45:33 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=验证码发送成功, data=null)]
2025-12-02 21:45:33 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:45:42 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/login/phone", parameters={}
2025-12-02 21:45:42 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#phoneLogin(PhoneLoginRequest, HttpServletRequest)
2025-12-02 21:45:42 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PhoneLoginRequest(phone=19818039183, code=139067)]
2025-12-02 21:45:42 [http-nio-8080-exec-3] INFO  c.e.s.controller.AuthController - 【手机号登录】手机号: 19818039183, IP: 127.0.0.1
2025-12-02 21:45:42 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.code=? 
        and vc1_0.type=? 
        and vc1_0.status=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-12-02 21:45:42 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-12-02 21:45:42 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-12-02 21:45:42 [http-nio-8080-exec-3] INFO  c.e.s.service.AuthService - 【注册】新用户注册成功, userId: c6d84871-f654-45f4-b11b-2a8412b6b200, phone: 19818039183
2025-12-02 21:45:42 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (avatar, bio, birthday, created_at, email, gender, is_deleted, last_login_ip, last_login_time, login_type, password, phone, status, updated_at, username, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:45:42 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_tokens
        (access_token, access_token_expires_at, created_at, device_id, device_type, ip_address, refresh_token, refresh_token_expires_at, status, updated_at, user_agent, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:45:42 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    update
        verification_codes 
    set
        code=?,
        expires_at=?,
        ip_address=?,
        phone=?,
        status=?,
        type=?,
        used_at=? 
    where
        id=?
2025-12-02 21:45:42 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    update
        users 
    set
        avatar=?,
        bio=?,
        birthday=?,
        email=?,
        gender=?,
        is_deleted=?,
        last_login_ip=?,
        last_login_time=?,
        login_type=?,
        password=?,
        phone=?,
        status=?,
        updated_at=?,
        username=? 
    where
        user_id=?
2025-12-02 21:45:42 [http-nio-8080-exec-3] INFO  c.e.s.controller.AuthController - 【登录成功】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, phone: 19818039183
2025-12-02 21:45:42 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:45:42 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=登录成功, data=LoginResponse(userId=c6d84871-f654-45f4-b11b-2a8412b6b200,  (truncated)...]
2025-12-02 21:45:42 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:45:49 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ai/chat/sessions", parameters={}
2025-12-02 21:45:49 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#getSessions(HttpServletRequest)
2025-12-02 21:45:49 [http-nio-8080-exec-4] INFO  c.e.s.controller.AiChatController - 【获取会话列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200
2025-12-02 21:45:49 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.user_id=? 
        and cs1_0.is_deleted=? 
    order by
        cs1_0.last_message_at desc,
        cs1_0.created_at desc
2025-12-02 21:45:49 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:45:49 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-12-02 21:45:49 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:45:57 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 21:45:57 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 21:45:57 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我添加一个今天十一点的日程，去洗脸, sessionId=null, userId=null)]
2025-12-02 21:45:57 [http-nio-8080-exec-5] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, sessionId: null, message: 帮我添加一个今天十一点的日程，去洗脸
2025-12-02 21:45:57 [http-nio-8080-exec-5] INFO  c.e.s.service.AiChatService - 准备为用户 c6d84871-f654-45f4-b11b-2a8412b6b200 创建新会话...
2025-12-02 21:45:57 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=?
2025-12-02 21:45:57 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_sessions
        (created_at, is_deleted, last_message_at, message_count, status, title, updated_at, user_id, session_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:45:57 [http-nio-8080-exec-5] INFO  c.e.s.service.AiChatService - 为用户 c6d84871-f654-45f4-b11b-2a8412b6b200 创建新会话成功: dfc0f84e-d259-488d-b923-5191d44bef77
2025-12-02 21:45:57 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        coalesce(max(cm1_0.sequence_num), 0) 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=?
2025-12-02 21:45:57 [http-nio-8080-exec-5] INFO  c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】首次加载会话 dfc0f84e-d259-488d-b923-5191d44bef77 的历史消息
2025-12-02 21:45:57 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num
2025-12-02 21:45:57 [http-nio-8080-exec-5] INFO  c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 dfc0f84e-d259-488d-b923-5191d44bef77 加载了 0 条历史消息
2025-12-02 21:45:57 [http-nio-8080-exec-5] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 dfc0f84e-d259-488d-b923-5191d44bef77 内存缓存更新，当前 1 条消息
2025-12-02 21:45:57 [http-nio-8080-exec-5] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 dfc0f84e-d259-488d-b923-5191d44bef77 内存缓存更新，当前 2 条消息
2025-12-02 21:45:57 [http-nio-8080-exec-5] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）21:45（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）21:45，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）21:45）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加一个今天十一点的日程，去洗脸"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 21:45:57 [http-nio-8080-exec-5] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）21:45（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）21:45，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）21:45）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加一个今天十一点的日程，去洗脸"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 21:45:58 [http-nio-8080-exec-5] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 21:45:58 [http-nio-8080-exec-5] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 13:45:58 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 600], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_ksf0f3g9998psq18p3]
- body: {"id":"0566d95863b14075aa1718b69b12189d","object":"chat.completion","created":1764683158,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"","tool_calls":[{"index":-1,"id":"call_f452197722bb439db35a8424","type":"function","function":{"name":"createSchedule","arguments":"{\"title\": \"去洗脸\", \"date\": \"2025-12-02\", \"startTime\": \"11:00\", \"endTime\": \"\", \"location\": \"\", \"isAllDay\": false}"}}]},"finish_reason":"tool_calls"}],"usage":{"prompt_tokens":2044,"completion_tokens":61,"total_tokens":2105},"system_fingerprint":""}

2025-12-02 21:45:58 [http-nio-8080-exec-5] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 dfc0f84e-d259-488d-b923-5191d44bef77 内存缓存更新，当前 3 条消息
2025-12-02 21:45:58 [http-nio-8080-exec-5] INFO  c.e.s.service.CalendarTools - 【CalendarTools】createSchedule 被调用 - userId: c6d84871-f654-45f4-b11b-2a8412b6b200, title: 去洗脸, date: 2025-12-02, startTime: 11:00, endTime: , location: , isAllDay: false
2025-12-02 21:45:58 [http-nio-8080-exec-5] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 标题: 去洗脸, 群组ID: null
2025-12-02 21:45:58 [http-nio-8080-exec-5] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: 650bf50a-41dd-4c8d-8f30-6d251de2083d
2025-12-02 21:45:58 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:45:58 [http-nio-8080-exec-5] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 dfc0f84e-d259-488d-b923-5191d44bef77 内存缓存更新，当前 4 条消息
2025-12-02 21:45:58 [http-nio-8080-exec-5] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）21:45（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）21:45，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）21:45）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加一个今天十一点的日程，去洗脸"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_f452197722bb439db35a8424",
      "type" : "function",
      "function" : {
        "name" : "createSchedule",
        "arguments" : "{\"title\": \"去洗脸\", \"date\": \"2025-12-02\", \"startTime\": \"11:00\", \"endTime\": \"\", \"location\": \"\", \"isAllDay\": false}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_f452197722bb439db35a8424",
    "content" : "✅ 日程创建成功！\n📅 标题：去洗脸\n📆 日期：2025-12-02\n⏰ 时间：11:00 - 未设置"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 21:45:58 [http-nio-8080-exec-5] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）21:45（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）21:45，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）21:45）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加一个今天十一点的日程，去洗脸"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_f452197722bb439db35a8424",
      "type" : "function",
      "function" : {
        "name" : "createSchedule",
        "arguments" : "{\"title\": \"去洗脸\", \"date\": \"2025-12-02\", \"startTime\": \"11:00\", \"endTime\": \"\", \"location\": \"\", \"isAllDay\": false}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_f452197722bb439db35a8424",
    "content" : "✅ 日程创建成功！\n📅 标题：去洗脸\n📆 日期：2025-12-02\n⏰ 时间：11:00 - 未设置"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 21:45:58 [http-nio-8080-exec-5] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 21:45:58 [http-nio-8080-exec-5] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 13:45:58 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 364], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_8ihzjdg2ozn4vtdk4l]
- body: {"id":"21e293499f644871b7b0884c371f6f2c","object":"chat.completion","created":1764683158,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"✅ 已添加日程：今天11:00 去洗脸"},"finish_reason":"stop"}],"usage":{"prompt_tokens":2160,"completion_tokens":18,"total_tokens":2178},"system_fingerprint":""}

2025-12-02 21:45:58 [http-nio-8080-exec-5] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 dfc0f84e-d259-488d-b923-5191d44bef77 内存缓存更新，当前 5 条消息
2025-12-02 21:45:58 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:45:58 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:45:58 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    update
        chat_sessions 
    set
        is_deleted=?,
        last_message_at=?,
        message_count=?,
        status=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        session_id=?
2025-12-02 21:45:58 [http-nio-8080-exec-5] INFO  c.e.s.service.AiChatService - 会话 dfc0f84e-d259-488d-b923-5191d44bef77 完成一轮对话，当前消息数: 4
2025-12-02 21:45:58 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:45:58 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=发送成功, data=ChatMessageResponse(sessionId=dfc0f84e-d259-488d-b923-5191d (truncated)...]
2025-12-02 21:45:58 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:45:58 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ai/chat/sessions", parameters={}
2025-12-02 21:45:58 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#getSessions(HttpServletRequest)
2025-12-02 21:45:58 [http-nio-8080-exec-6] INFO  c.e.s.controller.AiChatController - 【获取会话列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200
2025-12-02 21:45:58 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.user_id=? 
        and cs1_0.is_deleted=? 
    order by
        cs1_0.last_message_at desc,
        cs1_0.created_at desc
2025-12-02 21:45:58 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-12-02 21:45:58 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:45:58 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ChatSessionDTO(id=dfc0f84e-d259-488d-b923-5191d44bef77, ti (truncated)...]
2025-12-02 21:45:58 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:46:00 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=12", parameters={masked}
2025-12-02 21:46:00 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-12-02 21:46:00 [http-nio-8080-exec-7] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, year: 2025, month: 12
2025-12-02 21:46:00 [http-nio-8080-exec-7] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 12
2025-12-02 21:46:00 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 21:46:00 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 21:46:00 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:46:00 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=650bf50a-41dd-4c8d-8f30-6d251de2083 (truncated)...]
2025-12-02 21:46:00 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:49:42 [File Watcher] INFO  o.s.b.d.a.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 2 class path changes (0 additions, 2 deletions, 0 modifications)
2025-12-02 21:49:42 [Thread-11] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-02 21:49:42 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-02 21:49:42 [Thread-11] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 21:49:42 [Thread-11] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Shutdown initiated...
2025-12-02 21:49:42 [Thread-11] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Shutdown completed.
2025-12-02 21:49:42 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.7 with PID 12108 (C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server\target\classes started by 18241 in C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server)
2025-12-02 21:49:42 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-02 21:49:42 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-02 21:49:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 21:49:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-02 21:49:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 24 ms. Found 9 JPA repository interfaces.
2025-12-02 21:49:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 21:49:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-02 21:49:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:49:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:49:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:49:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:49:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:49:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:49:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:49:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:49:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:49:42 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-12-02 21:49:42 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-02 21:49:42 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-02 21:49:42 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-02 21:49:42 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-02 21:49:42 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 270 ms
2025-12-02 21:49:42 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-02 21:49:42 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-02 21:49:42 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-02 21:49:42 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-4 - Starting...
2025-12-02 21:49:42 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-4 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4adf2861
2025-12-02 21:49:42 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-4 - Start completed.
2025-12-02 21:49:42 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-02 21:49:42 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-12-02 21:49:42 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-4)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-02 21:49:42 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-02 21:49:42 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 21:49:42 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 21:49:42 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-12-02 21:49:42 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-12-02 21:49:42 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-12-02 21:49:42 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-12-02 21:49:42 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-12-02 21:49:42 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 21:49:42 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-12-02 21:49:42 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-12-02 21:49:42 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-02 21:49:42 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 27 mappings in 'requestMappingHandlerMapping'
2025-12-02 21:49:42 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-02 21:49:42 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-02 21:49:42 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-02 21:49:42 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-12-02 21:49:42 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-02 21:49:42 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 0.654 seconds (process running for 826.995)
2025-12-02 21:49:42 [restartedMain] INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener - Condition evaluation unchanged
2025-12-02 21:49:44 [File Watcher] INFO  o.s.b.d.a.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 2 class path changes (2 additions, 0 deletions, 0 modifications)
2025-12-02 21:49:44 [Thread-15] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-02 21:49:44 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-02 21:49:44 [Thread-15] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 21:49:44 [Thread-15] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-4 - Shutdown initiated...
2025-12-02 21:49:44 [Thread-15] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-4 - Shutdown completed.
2025-12-02 21:49:44 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.7 with PID 12108 (C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server\target\classes started by 18241 in C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server)
2025-12-02 21:49:44 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-02 21:49:44 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-02 21:49:44 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 21:49:44 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-02 21:49:44 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 9 JPA repository interfaces.
2025-12-02 21:49:44 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 21:49:44 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-02 21:49:44 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:49:44 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:49:44 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:49:44 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:49:44 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:49:44 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:49:44 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:49:44 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:49:44 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 21:49:44 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-12-02 21:49:44 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-02 21:49:44 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-02 21:49:44 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-02 21:49:44 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-02 21:49:44 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 178 ms
2025-12-02 21:49:44 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-02 21:49:44 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-02 21:49:44 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-02 21:49:44 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-5 - Starting...
2025-12-02 21:49:44 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-5 - Added connection com.mysql.cj.jdbc.ConnectionImpl@12a5c936
2025-12-02 21:49:44 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-5 - Start completed.
2025-12-02 21:49:44 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-02 21:49:44 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-12-02 21:49:44 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-5)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-02 21:49:44 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-02 21:49:44 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 21:49:44 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 21:49:44 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-12-02 21:49:44 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-12-02 21:49:44 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-12-02 21:49:44 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-12-02 21:49:44 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-12-02 21:49:44 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 21:49:44 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-12-02 21:49:44 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-12-02 21:49:44 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-02 21:49:44 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 27 mappings in 'requestMappingHandlerMapping'
2025-12-02 21:49:44 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-02 21:49:44 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-02 21:49:44 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-02 21:49:44 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-12-02 21:49:44 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-02 21:49:44 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 0.491 seconds (process running for 828.997)
2025-12-02 21:49:44 [restartedMain] INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener - Condition evaluation unchanged
2025-12-02 21:50:16 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-02 21:50:16 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-02 21:50:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-12-02 21:50:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-12-02 21:50:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-12-02 21:50:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@7927f955
2025-12-02 21:50:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@a09666a
2025-12-02 21:50:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-12-02 21:50:16 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-02 21:50:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/code", parameters={}
2025-12-02 21:50:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#sendCode(SendCodeRequest, HttpServletRequest)
2025-12-02 21:50:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [SendCodeRequest(phone=19818039183)]
2025-12-02 21:50:16 [http-nio-8080-exec-1] INFO  c.e.s.controller.AuthController - 【发送验证码】手机号: 19818039183, IP: 127.0.0.1
2025-12-02 21:50:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-12-02 21:50:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        count(vc1_0.id) 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.created_at>?
2025-12-02 21:50:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.expires_at<? 
        and vc1_0.status=?
2025-12-02 21:50:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    insert 
    into
        verification_codes
        (code, created_at, expires_at, ip_address, phone, status, type, used_at) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:50:16 [http-nio-8080-exec-1] INFO  c.e.s.service.AuthService - 【验证码】手机号: 19818039183, 验证码: 691554, 有效期: 300秒
2025-12-02 21:50:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:50:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=验证码发送成功, data=null)]
2025-12-02 21:50:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:50:23 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/login/phone", parameters={}
2025-12-02 21:50:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#phoneLogin(PhoneLoginRequest, HttpServletRequest)
2025-12-02 21:50:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PhoneLoginRequest(phone=19818039183, code=691554)]
2025-12-02 21:50:23 [http-nio-8080-exec-2] INFO  c.e.s.controller.AuthController - 【手机号登录】手机号: 19818039183, IP: 127.0.0.1
2025-12-02 21:50:23 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.code=? 
        and vc1_0.type=? 
        and vc1_0.status=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-12-02 21:50:23 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-12-02 21:50:23 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_tokens
        (access_token, access_token_expires_at, created_at, device_id, device_type, ip_address, refresh_token, refresh_token_expires_at, status, updated_at, user_agent, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:50:23 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    update
        verification_codes 
    set
        code=?,
        expires_at=?,
        ip_address=?,
        phone=?,
        status=?,
        type=?,
        used_at=? 
    where
        id=?
2025-12-02 21:50:23 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    update
        users 
    set
        avatar=?,
        bio=?,
        birthday=?,
        email=?,
        gender=?,
        is_deleted=?,
        last_login_ip=?,
        last_login_time=?,
        login_type=?,
        password=?,
        phone=?,
        status=?,
        updated_at=?,
        username=? 
    where
        user_id=?
2025-12-02 21:50:23 [http-nio-8080-exec-2] INFO  c.e.s.controller.AuthController - 【登录成功】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, phone: 19818039183
2025-12-02 21:50:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:50:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=登录成功, data=LoginResponse(userId=c6d84871-f654-45f4-b11b-2a8412b6b200,  (truncated)...]
2025-12-02 21:50:23 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:51:23 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 21:51:23 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 21:51:23 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我添加日程：oo<EOL>16:52 $\textt①}$<EOL><EOL>$81% 1 55 1 401%$<EOL>2025-2026学年...学长联系群(46)<EOL>1<EOL>昨 (truncated)...]
2025-12-02 21:51:23 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:51:23 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=401, message=未授权，请先登录, data=null)]
2025-12-02 21:51:23 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:51:49 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=12", parameters={masked}
2025-12-02 21:51:49 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-12-02 21:51:49 [http-nio-8080-exec-3] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, year: 2025, month: 12
2025-12-02 21:51:49 [http-nio-8080-exec-3] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 12
2025-12-02 21:51:49 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 21:51:49 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 21:51:49 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:51:49 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=650bf50a-41dd-4c8d-8f30-6d251de2083 (truncated)...]
2025-12-02 21:51:49 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:51:51 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-12-02 21:51:51 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-12-02 21:51:51 [http-nio-8080-exec-5] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, year: 2025, month: 11
2025-12-02 21:51:51 [http-nio-8080-exec-5] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 11
2025-12-02 21:51:51 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 21:51:51 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 21:51:51 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:51:51 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-12-02 21:51:51 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:51:52 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=10", parameters={masked}
2025-12-02 21:51:52 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-12-02 21:51:52 [http-nio-8080-exec-6] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, year: 2025, month: 10
2025-12-02 21:51:52 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 10
2025-12-02 21:51:52 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 21:51:52 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 21:51:52 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:51:52 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-12-02 21:51:52 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:51:53 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-12-02 21:51:53 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-12-02 21:51:53 [http-nio-8080-exec-7] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, year: 2025, month: 11
2025-12-02 21:51:53 [http-nio-8080-exec-7] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 11
2025-12-02 21:51:53 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 21:51:53 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 21:51:53 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:51:53 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-12-02 21:51:53 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:52:48 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 21:52:48 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 21:52:48 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我添加日程：5<EOL>4<EOL>6<EOL>7<EOL>11<EOL>12<EOL>14<EOL>13<EOL>20<EOL>21<EOL>18<EOL>19<EOL>26<EOL>28<EOL>25<EOL>27<EOL>, sessionId=null, user (truncated)...]
2025-12-02 21:52:48 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:52:48 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=401, message=未授权，请先登录, data=null)]
2025-12-02 21:52:48 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:53:04 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/code", parameters={}
2025-12-02 21:53:04 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#sendCode(SendCodeRequest, HttpServletRequest)
2025-12-02 21:53:04 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [SendCodeRequest(phone=19818039183)]
2025-12-02 21:53:04 [http-nio-8080-exec-9] INFO  c.e.s.controller.AuthController - 【发送验证码】手机号: 19818039183, IP: 127.0.0.1
2025-12-02 21:53:04 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-12-02 21:53:04 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        count(vc1_0.id) 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.created_at>?
2025-12-02 21:53:04 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.expires_at<? 
        and vc1_0.status=?
2025-12-02 21:53:04 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    insert 
    into
        verification_codes
        (code, created_at, expires_at, ip_address, phone, status, type, used_at) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:53:04 [http-nio-8080-exec-9] INFO  c.e.s.service.AuthService - 【验证码】手机号: 19818039183, 验证码: 654245, 有效期: 300秒
2025-12-02 21:53:04 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:53:04 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=验证码发送成功, data=null)]
2025-12-02 21:53:04 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:53:10 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/login/phone", parameters={}
2025-12-02 21:53:10 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#phoneLogin(PhoneLoginRequest, HttpServletRequest)
2025-12-02 21:53:10 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PhoneLoginRequest(phone=19818039183, code=654245)]
2025-12-02 21:53:10 [http-nio-8080-exec-1] INFO  c.e.s.controller.AuthController - 【手机号登录】手机号: 19818039183, IP: 127.0.0.1
2025-12-02 21:53:10 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.code=? 
        and vc1_0.type=? 
        and vc1_0.status=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-12-02 21:53:10 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-12-02 21:53:10 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_tokens
        (access_token, access_token_expires_at, created_at, device_id, device_type, ip_address, refresh_token, refresh_token_expires_at, status, updated_at, user_agent, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:53:10 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    update
        verification_codes 
    set
        code=?,
        expires_at=?,
        ip_address=?,
        phone=?,
        status=?,
        type=?,
        used_at=? 
    where
        id=?
2025-12-02 21:53:10 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    update
        users 
    set
        avatar=?,
        bio=?,
        birthday=?,
        email=?,
        gender=?,
        is_deleted=?,
        last_login_ip=?,
        last_login_time=?,
        login_type=?,
        password=?,
        phone=?,
        status=?,
        updated_at=?,
        username=? 
    where
        user_id=?
2025-12-02 21:53:10 [http-nio-8080-exec-1] INFO  c.e.s.controller.AuthController - 【登录成功】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, phone: 19818039183
2025-12-02 21:53:10 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:53:10 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=登录成功, data=LoginResponse(userId=c6d84871-f654-45f4-b11b-2a8412b6b200,  (truncated)...]
2025-12-02 21:53:10 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:53:11 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=12", parameters={masked}
2025-12-02 21:53:11 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-12-02 21:53:11 [http-nio-8080-exec-2] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, year: 2025, month: 12
2025-12-02 21:53:11 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 12
2025-12-02 21:53:11 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 21:53:11 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 21:53:11 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:53:11 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=650bf50a-41dd-4c8d-8f30-6d251de2083 (truncated)...]
2025-12-02 21:53:11 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:53:23 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 21:53:23 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 21:53:23 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我添加日程：16:52 $\text{①}$<EOL>$81% 1 55 1 401%$<EOL>2025-2026学年...学长联系群(46)<EOL>1<EOL>昨天10: (truncated)...]
2025-12-02 21:53:23 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:53:23 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=401, message=未授权，请先登录, data=null)]
2025-12-02 21:53:23 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:57:35 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/code", parameters={}
2025-12-02 21:57:35 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#sendCode(SendCodeRequest, HttpServletRequest)
2025-12-02 21:57:35 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [SendCodeRequest(phone=19818039183)]
2025-12-02 21:57:35 [http-nio-8080-exec-5] INFO  c.e.s.controller.AuthController - 【发送验证码】手机号: 19818039183, IP: 127.0.0.1
2025-12-02 21:57:35 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-12-02 21:57:35 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        count(vc1_0.id) 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.created_at>?
2025-12-02 21:57:35 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.expires_at<? 
        and vc1_0.status=?
2025-12-02 21:57:35 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    insert 
    into
        verification_codes
        (code, created_at, expires_at, ip_address, phone, status, type, used_at) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:57:35 [http-nio-8080-exec-5] INFO  c.e.s.service.AuthService - 【验证码】手机号: 19818039183, 验证码: 329859, 有效期: 300秒
2025-12-02 21:57:35 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:57:35 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=验证码发送成功, data=null)]
2025-12-02 21:57:35 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:57:49 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/login/phone", parameters={}
2025-12-02 21:57:49 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#phoneLogin(PhoneLoginRequest, HttpServletRequest)
2025-12-02 21:57:49 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PhoneLoginRequest(phone=19818039183, code=329859)]
2025-12-02 21:57:49 [http-nio-8080-exec-6] INFO  c.e.s.controller.AuthController - 【手机号登录】手机号: 19818039183, IP: 127.0.0.1
2025-12-02 21:57:49 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.code=? 
        and vc1_0.type=? 
        and vc1_0.status=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-12-02 21:57:49 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-12-02 21:57:49 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_tokens
        (access_token, access_token_expires_at, created_at, device_id, device_type, ip_address, refresh_token, refresh_token_expires_at, status, updated_at, user_agent, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:57:49 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    update
        verification_codes 
    set
        code=?,
        expires_at=?,
        ip_address=?,
        phone=?,
        status=?,
        type=?,
        used_at=? 
    where
        id=?
2025-12-02 21:57:49 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    update
        users 
    set
        avatar=?,
        bio=?,
        birthday=?,
        email=?,
        gender=?,
        is_deleted=?,
        last_login_ip=?,
        last_login_time=?,
        login_type=?,
        password=?,
        phone=?,
        status=?,
        updated_at=?,
        username=? 
    where
        user_id=?
2025-12-02 21:57:49 [http-nio-8080-exec-6] INFO  c.e.s.controller.AuthController - 【登录成功】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, phone: 19818039183
2025-12-02 21:57:49 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:57:49 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=登录成功, data=LoginResponse(userId=c6d84871-f654-45f4-b11b-2a8412b6b200,  (truncated)...]
2025-12-02 21:57:49 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:57:51 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=12", parameters={masked}
2025-12-02 21:57:51 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-12-02 21:57:51 [http-nio-8080-exec-7] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, year: 2025, month: 12
2025-12-02 21:57:51 [http-nio-8080-exec-7] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 12
2025-12-02 21:57:51 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 21:57:51 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 21:57:51 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:57:51 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=650bf50a-41dd-4c8d-8f30-6d251de2083 (truncated)...]
2025-12-02 21:57:51 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:58:05 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 21:58:05 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 21:58:05 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我添加日程：16:52 $\text{①$<EOL>$81% 1 55 1 401%$<EOL>2025-2026学年...学长联系群(46)<EOL>1<EOL>昨天10:4 (truncated)...]
2025-12-02 21:58:05 [http-nio-8080-exec-8] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, sessionId: null, message: 帮我添加日程：16:52 $\text{①$
$81% 1 55 1 401%$
2025-2026学年...学长联系群(46)
1
昨天10:40
DX23 计算机 2 徐嘉玲
各位部长上午好:
1...
2025-12-02 21:58:05 [http-nio-8080-exec-8] INFO  c.e.s.service.AiChatService - 准备为用户 c6d84871-f654-45f4-b11b-2a8412b6b200 创建新会话...
2025-12-02 21:58:05 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=?
2025-12-02 21:58:05 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_sessions
        (created_at, is_deleted, last_message_at, message_count, status, title, updated_at, user_id, session_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:58:05 [http-nio-8080-exec-8] INFO  c.e.s.service.AiChatService - 为用户 c6d84871-f654-45f4-b11b-2a8412b6b200 创建新会话成功: 5e3f2113-d677-4713-b5ef-4972caaf0ba0
2025-12-02 21:58:05 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        coalesce(max(cm1_0.sequence_num), 0) 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=?
2025-12-02 21:58:05 [http-nio-8080-exec-8] INFO  c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】首次加载会话 5e3f2113-d677-4713-b5ef-4972caaf0ba0 的历史消息
2025-12-02 21:58:05 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num
2025-12-02 21:58:05 [http-nio-8080-exec-8] INFO  c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 5e3f2113-d677-4713-b5ef-4972caaf0ba0 加载了 0 条历史消息
2025-12-02 21:58:05 [http-nio-8080-exec-8] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 5e3f2113-d677-4713-b5ef-4972caaf0ba0 内存缓存更新，当前 1 条消息
2025-12-02 21:58:05 [http-nio-8080-exec-8] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 5e3f2113-d677-4713-b5ef-4972caaf0ba0 内存缓存更新，当前 2 条消息
2025-12-02 21:58:05 [http-nio-8080-exec-8] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）21:58（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）21:58，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）21:58）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加日程：16:52 $\\text{①$\n$81% 1 55 1 401%$\n2025-2026学年...学长联系群(46)\n1\n昨天10:40\nDX23 计算机 2 徐嘉玲\n各位部长上午好:\n11月 29 日下午 14:00 将举行学\n院的妇联换届大会,现招募 7-9 个\n部长 (必须是女生)出席参加会\n议。参与的同学直接填写下方共\n享表格即可\n DX23 计算机 2 徐嘉玲\n$\\text{V}$\n金山文档IWPS 云文档\n10.31 下午 14 点妇联活动人员\n统计表\n所有人可编辑在线文档\n$itext(S$\n$\\text{田}$\n来自 $\\text{W}$ WPS Office\n小程序\n昨天11:49\nDX23 计算机 2 徐嘉玲\n本次活动会给予相应的 pu 学时\n$\\text{C}$\n"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 21:58:05 [http-nio-8080-exec-8] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）21:58（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）21:58，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）21:58）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加日程：16:52 $\\text{①$\n$81% 1 55 1 401%$\n2025-2026学年...学长联系群(46)\n1\n昨天10:40\nDX23 计算机 2 徐嘉玲\n各位部长上午好:\n11月 29 日下午 14:00 将举行学\n院的妇联换届大会,现招募 7-9 个\n部长 (必须是女生)出席参加会\n议。参与的同学直接填写下方共\n享表格即可\n DX23 计算机 2 徐嘉玲\n$\\text{V}$\n金山文档IWPS 云文档\n10.31 下午 14 点妇联活动人员\n统计表\n所有人可编辑在线文档\n$itext(S$\n$\\text{田}$\n来自 $\\text{W}$ WPS Office\n小程序\n昨天11:49\nDX23 计算机 2 徐嘉玲\n本次活动会给予相应的 pu 学时\n$\\text{C}$\n"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 21:58:05 [http-nio-8080-exec-8] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 21:58:05 [http-nio-8080-exec-8] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 13:58:05 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 344], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_1wcra7wyljetuolq4d]
- body: {"id":"5ec1643efd3f45e5ae8a8ad4c4625103","object":"chat.completion","created":1764683885,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"未识别到日程信息"},"finish_reason":"stop"}],"usage":{"prompt_tokens":2282,"completion_tokens":7,"total_tokens":2289},"system_fingerprint":""}

2025-12-02 21:58:05 [http-nio-8080-exec-8] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 5e3f2113-d677-4713-b5ef-4972caaf0ba0 内存缓存更新，当前 3 条消息
2025-12-02 21:58:05 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:58:05 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:58:05 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    update
        chat_sessions 
    set
        is_deleted=?,
        last_message_at=?,
        message_count=?,
        status=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        session_id=?
2025-12-02 21:58:05 [http-nio-8080-exec-8] INFO  c.e.s.service.AiChatService - 会话 5e3f2113-d677-4713-b5ef-4972caaf0ba0 完成一轮对话，当前消息数: 4
2025-12-02 21:58:05 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:58:05 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=发送成功, data=ChatMessageResponse(sessionId=5e3f2113-d677-4713-b5ef-4972c (truncated)...]
2025-12-02 21:58:05 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:58:43 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 21:58:43 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 21:58:43 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我添加日程：O<EOL>16:52 $\text{①}$<EOL>$81% 1 55 1 401%$<EOL>2025-2026学年...学长联系群(46)<EOL>1<EOL>昨天1 (truncated)...]
2025-12-02 21:58:43 [http-nio-8080-exec-10] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, sessionId: null, message: 帮我添加日程：O
16:52 $\text{①}$
$81% 1 55 1 401%$
2025-2026学年...学长联系群(46)
1
昨天10:40
DX23 计算机 2 徐嘉玲
各位部长上午好...
2025-12-02 21:58:43 [http-nio-8080-exec-10] INFO  c.e.s.service.AiChatService - 准备为用户 c6d84871-f654-45f4-b11b-2a8412b6b200 创建新会话...
2025-12-02 21:58:43 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=?
2025-12-02 21:58:43 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_sessions
        (created_at, is_deleted, last_message_at, message_count, status, title, updated_at, user_id, session_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:58:43 [http-nio-8080-exec-10] INFO  c.e.s.service.AiChatService - 为用户 c6d84871-f654-45f4-b11b-2a8412b6b200 创建新会话成功: 62e3827d-9fff-41ff-b541-b3b22ebb8f69
2025-12-02 21:58:43 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        coalesce(max(cm1_0.sequence_num), 0) 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=?
2025-12-02 21:58:43 [http-nio-8080-exec-10] INFO  c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】首次加载会话 62e3827d-9fff-41ff-b541-b3b22ebb8f69 的历史消息
2025-12-02 21:58:43 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num
2025-12-02 21:58:43 [http-nio-8080-exec-10] INFO  c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 62e3827d-9fff-41ff-b541-b3b22ebb8f69 加载了 0 条历史消息
2025-12-02 21:58:43 [http-nio-8080-exec-10] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 62e3827d-9fff-41ff-b541-b3b22ebb8f69 内存缓存更新，当前 1 条消息
2025-12-02 21:58:43 [http-nio-8080-exec-10] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 62e3827d-9fff-41ff-b541-b3b22ebb8f69 内存缓存更新，当前 2 条消息
2025-12-02 21:58:43 [http-nio-8080-exec-10] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）21:58（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）21:58，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）21:58）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加日程：O\n16:52 $\\text{①}$\n$81% 1 55 1 401%$\n2025-2026学年...学长联系群(46)\n1\n昨天10:40\nDX23 计算机 2 徐嘉玲\n各位部长上午好:\n12 月5 日下午 14:00将举行学\n院的妇联换届大会，现招募 7-9个\n部长 (必须是女生)出席参加会\n议。参与的同学直接填写下方共\n享表格即可\nDX23 计算机 2 徐嘉玲\n$\\texttV$\n金山文档IWPS 云文档\n12.5 下午 14 点妇联活动人员\n统计表\n所有人可编辑在线文档\n$\\text(S)$\n$\\text田$\n来自 $\\text{W}$ WPS Office\n小程序\n昨天11:49\nDX23 计算机 2 徐嘉玲\n本次活动会给予相应的 pu 学时\n$\\text{C}$\n\n"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 21:58:43 [http-nio-8080-exec-10] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）21:58（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）21:58，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）21:58）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加日程：O\n16:52 $\\text{①}$\n$81% 1 55 1 401%$\n2025-2026学年...学长联系群(46)\n1\n昨天10:40\nDX23 计算机 2 徐嘉玲\n各位部长上午好:\n12 月5 日下午 14:00将举行学\n院的妇联换届大会，现招募 7-9个\n部长 (必须是女生)出席参加会\n议。参与的同学直接填写下方共\n享表格即可\nDX23 计算机 2 徐嘉玲\n$\\texttV$\n金山文档IWPS 云文档\n12.5 下午 14 点妇联活动人员\n统计表\n所有人可编辑在线文档\n$\\text(S)$\n$\\text田$\n来自 $\\text{W}$ WPS Office\n小程序\n昨天11:49\nDX23 计算机 2 徐嘉玲\n本次活动会给予相应的 pu 学时\n$\\text{C}$\n\n"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 21:58:44 [http-nio-8080-exec-10] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 21:58:44 [http-nio-8080-exec-10] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 13:58:44 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 609], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_v4p8dhaiyd01zfnuhv]
- body: {"id":"55204997d25c45fd96783e470b550119","object":"chat.completion","created":1764683924,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"","tool_calls":[{"index":-1,"id":"call_6260ef7e42914dfda8fbd7e6","type":"function","function":{"name":"createSchedule","arguments":"{\"title\": \"妇联换届大会\", \"date\": \"2025-12-05\", \"startTime\": \"14:00\", \"endTime\": \"\", \"location\": \"\", \"isAllDay\": false}"}}]},"finish_reason":"tool_calls"}],"usage":{"prompt_tokens":2278,"completion_tokens":62,"total_tokens":2340},"system_fingerprint":""}

2025-12-02 21:58:44 [http-nio-8080-exec-10] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 62e3827d-9fff-41ff-b541-b3b22ebb8f69 内存缓存更新，当前 3 条消息
2025-12-02 21:58:44 [http-nio-8080-exec-10] INFO  c.e.s.service.CalendarTools - 【CalendarTools】createSchedule 被调用 - userId: c6d84871-f654-45f4-b11b-2a8412b6b200, title: 妇联换届大会, date: 2025-12-05, startTime: 14:00, endTime: , location: , isAllDay: false
2025-12-02 21:58:44 [http-nio-8080-exec-10] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 标题: 妇联换届大会, 群组ID: null
2025-12-02 21:58:44 [http-nio-8080-exec-10] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: c2758597-9db5-4b3c-81f6-b812c11dd69e
2025-12-02 21:58:44 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:58:44 [http-nio-8080-exec-10] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 62e3827d-9fff-41ff-b541-b3b22ebb8f69 内存缓存更新，当前 4 条消息
2025-12-02 21:58:44 [http-nio-8080-exec-10] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）21:58（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）21:58，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）21:58）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加日程：O\n16:52 $\\text{①}$\n$81% 1 55 1 401%$\n2025-2026学年...学长联系群(46)\n1\n昨天10:40\nDX23 计算机 2 徐嘉玲\n各位部长上午好:\n12 月5 日下午 14:00将举行学\n院的妇联换届大会，现招募 7-9个\n部长 (必须是女生)出席参加会\n议。参与的同学直接填写下方共\n享表格即可\nDX23 计算机 2 徐嘉玲\n$\\texttV$\n金山文档IWPS 云文档\n12.5 下午 14 点妇联活动人员\n统计表\n所有人可编辑在线文档\n$\\text(S)$\n$\\text田$\n来自 $\\text{W}$ WPS Office\n小程序\n昨天11:49\nDX23 计算机 2 徐嘉玲\n本次活动会给予相应的 pu 学时\n$\\text{C}$\n\n"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_6260ef7e42914dfda8fbd7e6",
      "type" : "function",
      "function" : {
        "name" : "createSchedule",
        "arguments" : "{\"title\": \"妇联换届大会\", \"date\": \"2025-12-05\", \"startTime\": \"14:00\", \"endTime\": \"\", \"location\": \"\", \"isAllDay\": false}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_6260ef7e42914dfda8fbd7e6",
    "content" : "✅ 日程创建成功！\n📅 标题：妇联换届大会\n📆 日期：2025-12-05\n⏰ 时间：14:00 - 未设置"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 21:58:44 [http-nio-8080-exec-10] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）21:58（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）21:58，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）21:58）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加日程：O\n16:52 $\\text{①}$\n$81% 1 55 1 401%$\n2025-2026学年...学长联系群(46)\n1\n昨天10:40\nDX23 计算机 2 徐嘉玲\n各位部长上午好:\n12 月5 日下午 14:00将举行学\n院的妇联换届大会，现招募 7-9个\n部长 (必须是女生)出席参加会\n议。参与的同学直接填写下方共\n享表格即可\nDX23 计算机 2 徐嘉玲\n$\\texttV$\n金山文档IWPS 云文档\n12.5 下午 14 点妇联活动人员\n统计表\n所有人可编辑在线文档\n$\\text(S)$\n$\\text田$\n来自 $\\text{W}$ WPS Office\n小程序\n昨天11:49\nDX23 计算机 2 徐嘉玲\n本次活动会给予相应的 pu 学时\n$\\text{C}$\n\n"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_6260ef7e42914dfda8fbd7e6",
      "type" : "function",
      "function" : {
        "name" : "createSchedule",
        "arguments" : "{\"title\": \"妇联换届大会\", \"date\": \"2025-12-05\", \"startTime\": \"14:00\", \"endTime\": \"\", \"location\": \"\", \"isAllDay\": false}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_6260ef7e42914dfda8fbd7e6",
    "content" : "✅ 日程创建成功！\n📅 标题：妇联换届大会\n📆 日期：2025-12-05\n⏰ 时间：14:00 - 未设置"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 21:58:44 [http-nio-8080-exec-10] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 21:58:44 [http-nio-8080-exec-10] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 13:58:44 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 390], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_a6j75j8vulo79rl5ub]
- body: {"id":"3c52ede5888343c7be2d08d7ede21255","object":"chat.completion","created":1764683924,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"✅ 已添加日程：2025年12月5日 下午14:00 妇联换届大会"},"finish_reason":"stop"}],"usage":{"prompt_tokens":2396,"completion_tokens":30,"total_tokens":2426},"system_fingerprint":""}

2025-12-02 21:58:44 [http-nio-8080-exec-10] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 62e3827d-9fff-41ff-b541-b3b22ebb8f69 内存缓存更新，当前 5 条消息
2025-12-02 21:58:44 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:58:44 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:58:44 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    update
        chat_sessions 
    set
        is_deleted=?,
        last_message_at=?,
        message_count=?,
        status=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        session_id=?
2025-12-02 21:58:44 [http-nio-8080-exec-10] INFO  c.e.s.service.AiChatService - 会话 62e3827d-9fff-41ff-b541-b3b22ebb8f69 完成一轮对话，当前消息数: 4
2025-12-02 21:58:44 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:58:44 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=发送成功, data=ChatMessageResponse(sessionId=62e3827d-9fff-41ff-b541-b3b22 (truncated)...]
2025-12-02 21:58:44 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:58:48 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=12", parameters={masked}
2025-12-02 21:58:48 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-12-02 21:58:48 [http-nio-8080-exec-9] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, year: 2025, month: 12
2025-12-02 21:58:48 [http-nio-8080-exec-9] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 12
2025-12-02 21:58:48 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 21:58:48 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 21:58:48 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:58:48 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=650bf50a-41dd-4c8d-8f30-6d251de2083 (truncated)...]
2025-12-02 21:58:48 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:59:21 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ai/chat/sessions", parameters={}
2025-12-02 21:59:21 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#getSessions(HttpServletRequest)
2025-12-02 21:59:21 [http-nio-8080-exec-1] INFO  c.e.s.controller.AiChatController - 【获取会话列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200
2025-12-02 21:59:21 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.user_id=? 
        and cs1_0.is_deleted=? 
    order by
        cs1_0.last_message_at desc,
        cs1_0.created_at desc
2025-12-02 21:59:21 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-12-02 21:59:21 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-12-02 21:59:21 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-12-02 21:59:21 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:59:21 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ChatSessionDTO(id=62e3827d-9fff-41ff-b541-b3b22ebb8f69, ti (truncated)...]
2025-12-02 21:59:21 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:59:38 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 21:59:38 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 21:59:38 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=can you seek my dick？, sessionId=null, userId=null)]
2025-12-02 21:59:38 [http-nio-8080-exec-2] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, sessionId: null, message: can you seek my dick？
2025-12-02 21:59:38 [http-nio-8080-exec-2] INFO  c.e.s.service.AiChatService - 准备为用户 c6d84871-f654-45f4-b11b-2a8412b6b200 创建新会话...
2025-12-02 21:59:38 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=?
2025-12-02 21:59:38 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_sessions
        (created_at, is_deleted, last_message_at, message_count, status, title, updated_at, user_id, session_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:59:38 [http-nio-8080-exec-2] INFO  c.e.s.service.AiChatService - 为用户 c6d84871-f654-45f4-b11b-2a8412b6b200 创建新会话成功: ce67e930-c06a-4a90-b164-4c4104aba6d2
2025-12-02 21:59:38 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        coalesce(max(cm1_0.sequence_num), 0) 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=?
2025-12-02 21:59:38 [http-nio-8080-exec-2] INFO  c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】首次加载会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 的历史消息
2025-12-02 21:59:38 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num
2025-12-02 21:59:38 [http-nio-8080-exec-2] INFO  c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 加载了 0 条历史消息
2025-12-02 21:59:38 [http-nio-8080-exec-2] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 1 条消息
2025-12-02 21:59:38 [http-nio-8080-exec-2] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 2 条消息
2025-12-02 21:59:38 [http-nio-8080-exec-2] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）21:59（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）21:59，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）21:59）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "can you seek my dick？"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 21:59:38 [http-nio-8080-exec-2] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）21:59（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）21:59，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）21:59）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "can you seek my dick？"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 21:59:38 [http-nio-8080-exec-2] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 21:59:38 [http-nio-8080-exec-2] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 13:59:38 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 344], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_vsdijr7ek8ept3pop8]
- body: {"id":"418f22e0f96449e0bcc61881f8b0831f","object":"chat.completion","created":1764683978,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"未识别到日程信息"},"finish_reason":"stop"}],"usage":{"prompt_tokens":2039,"completion_tokens":7,"total_tokens":2046},"system_fingerprint":""}

2025-12-02 21:59:38 [http-nio-8080-exec-2] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 3 条消息
2025-12-02 21:59:38 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:59:38 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:59:38 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    update
        chat_sessions 
    set
        is_deleted=?,
        last_message_at=?,
        message_count=?,
        status=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        session_id=?
2025-12-02 21:59:38 [http-nio-8080-exec-2] INFO  c.e.s.service.AiChatService - 会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 完成一轮对话，当前消息数: 4
2025-12-02 21:59:38 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:59:38 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=发送成功, data=ChatMessageResponse(sessionId=ce67e930-c06a-4a90-b164-4c410 (truncated)...]
2025-12-02 21:59:38 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:59:38 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ai/chat/sessions", parameters={}
2025-12-02 21:59:38 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#getSessions(HttpServletRequest)
2025-12-02 21:59:38 [http-nio-8080-exec-4] INFO  c.e.s.controller.AiChatController - 【获取会话列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200
2025-12-02 21:59:38 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.user_id=? 
        and cs1_0.is_deleted=? 
    order by
        cs1_0.last_message_at desc,
        cs1_0.created_at desc
2025-12-02 21:59:38 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-12-02 21:59:38 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-12-02 21:59:38 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-12-02 21:59:38 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-12-02 21:59:38 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:59:38 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ChatSessionDTO(id=ce67e930-c06a-4a90-b164-4c4104aba6d2, ti (truncated)...]
2025-12-02 21:59:38 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 21:59:49 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 21:59:49 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 21:59:49 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=？, sessionId=ce67e930-c06a-4a90-b164-4c4104aba6d2, userId=null)]
2025-12-02 21:59:49 [http-nio-8080-exec-3] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, sessionId: ce67e930-c06a-4a90-b164-4c4104aba6d2, message: ？
2025-12-02 21:59:49 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=? 
        and cs1_0.user_id=? 
        and cs1_0.is_deleted=?
2025-12-02 21:59:49 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        coalesce(max(cm1_0.sequence_num), 0) 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=?
2025-12-02 21:59:49 [http-nio-8080-exec-3] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 4 条消息
2025-12-02 21:59:49 [http-nio-8080-exec-3] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）21:59（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）21:59，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）21:59）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "can you seek my dick？"
  }, {
    "role" : "assistant",
    "content" : "未识别到日程信息"
  }, {
    "role" : "user",
    "content" : "？"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 21:59:49 [http-nio-8080-exec-3] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）21:59（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）21:59，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）21:59）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "can you seek my dick？"
  }, {
    "role" : "assistant",
    "content" : "未识别到日程信息"
  }, {
    "role" : "user",
    "content" : "？"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 21:59:49 [http-nio-8080-exec-3] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 21:59:49 [http-nio-8080-exec-3] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 13:59:49 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 507], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_rw5vv18v8c3pjn1met]
- body: {"id":"249f34d7a2ed47fabb25a7ae8a22e1b1","object":"chat.completion","created":1764683989,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"},"finish_reason":"stop"}],"usage":{"prompt_tokens":2056,"completion_tokens":39,"total_tokens":2095},"system_fingerprint":""}

2025-12-02 21:59:49 [http-nio-8080-exec-3] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 5 条消息
2025-12-02 21:59:49 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:59:49 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 21:59:49 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    update
        chat_sessions 
    set
        is_deleted=?,
        last_message_at=?,
        message_count=?,
        status=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        session_id=?
2025-12-02 21:59:49 [http-nio-8080-exec-3] INFO  c.e.s.service.AiChatService - 会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 完成一轮对话，当前消息数: 6
2025-12-02 21:59:49 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 21:59:49 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=发送成功, data=ChatMessageResponse(sessionId=ce67e930-c06a-4a90-b164-4c410 (truncated)...]
2025-12-02 21:59:49 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:00:00 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 22:00:00 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 22:00:00 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=你不会聊天吗？, sessionId=ce67e930-c06a-4a90-b164-4c4104aba6d2, userId=null)]
2025-12-02 22:00:00 [http-nio-8080-exec-5] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, sessionId: ce67e930-c06a-4a90-b164-4c4104aba6d2, message: 你不会聊天吗？
2025-12-02 22:00:00 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=? 
        and cs1_0.user_id=? 
        and cs1_0.is_deleted=?
2025-12-02 22:00:00 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        coalesce(max(cm1_0.sequence_num), 0) 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=?
2025-12-02 22:00:00 [http-nio-8080-exec-5] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 5 条消息
2025-12-02 22:00:00 [http-nio-8080-exec-5] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 6 条消息
2025-12-02 22:00:00 [http-nio-8080-exec-5] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "can you seek my dick？"
  }, {
    "role" : "assistant",
    "content" : "未识别到日程信息"
  }, {
    "role" : "user",
    "content" : "？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:00（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:00，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:00）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "你不会聊天吗？"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 22:00:00 [http-nio-8080-exec-5] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "can you seek my dick？"
  }, {
    "role" : "assistant",
    "content" : "未识别到日程信息"
  }, {
    "role" : "user",
    "content" : "？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:00（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:00，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:00）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "你不会聊天吗？"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 22:00:01 [http-nio-8080-exec-5] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 22:00:01 [http-nio-8080-exec-5] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 14:00:01 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 537], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_hv4hqaphcn2ohk0ym3]
- body: {"id":"b423f4c4c5644b48933dc93297ec64db","object":"chat.completion","created":1764684001,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"},"finish_reason":"stop"}],"usage":{"prompt_tokens":2113,"completion_tokens":46,"total_tokens":2159},"system_fingerprint":""}

2025-12-02 22:00:01 [http-nio-8080-exec-5] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 7 条消息
2025-12-02 22:00:01 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:00:01 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:00:01 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    update
        chat_sessions 
    set
        is_deleted=?,
        last_message_at=?,
        message_count=?,
        status=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        session_id=?
2025-12-02 22:00:01 [http-nio-8080-exec-5] INFO  c.e.s.service.AiChatService - 会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 完成一轮对话，当前消息数: 8
2025-12-02 22:00:01 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:00:01 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=发送成功, data=ChatMessageResponse(sessionId=ce67e930-c06a-4a90-b164-4c410 (truncated)...]
2025-12-02 22:00:01 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:00:12 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 22:00:12 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 22:00:12 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=你傻福啊？, sessionId=ce67e930-c06a-4a90-b164-4c4104aba6d2, userId=null)]
2025-12-02 22:00:12 [http-nio-8080-exec-6] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, sessionId: ce67e930-c06a-4a90-b164-4c4104aba6d2, message: 你傻福啊？
2025-12-02 22:00:12 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=? 
        and cs1_0.user_id=? 
        and cs1_0.is_deleted=?
2025-12-02 22:00:12 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        coalesce(max(cm1_0.sequence_num), 0) 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=?
2025-12-02 22:00:12 [http-nio-8080-exec-6] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 8 条消息
2025-12-02 22:00:12 [http-nio-8080-exec-6] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "can you seek my dick？"
  }, {
    "role" : "assistant",
    "content" : "未识别到日程信息"
  }, {
    "role" : "user",
    "content" : "？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:00（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:00，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:00）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "你不会聊天吗？"
  }, {
    "role" : "assistant",
    "content" : "我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"
  }, {
    "role" : "user",
    "content" : "你傻福啊？"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 22:00:12 [http-nio-8080-exec-6] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "can you seek my dick？"
  }, {
    "role" : "assistant",
    "content" : "未识别到日程信息"
  }, {
    "role" : "user",
    "content" : "？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:00（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:00，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:00）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "你不会聊天吗？"
  }, {
    "role" : "assistant",
    "content" : "我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"
  }, {
    "role" : "user",
    "content" : "你傻福啊？"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 22:00:13 [http-nio-8080-exec-6] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 22:00:13 [http-nio-8080-exec-6] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 14:00:13 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 486], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_nv51ix46u6kx2fwcle]
- body: {"id":"3d70fa69158c425caa67bae0eef78d56","object":"chat.completion","created":1764684013,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"},"finish_reason":"stop"}],"usage":{"prompt_tokens":2173,"completion_tokens":34,"total_tokens":2207},"system_fingerprint":""}

2025-12-02 22:00:13 [http-nio-8080-exec-6] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 9 条消息
2025-12-02 22:00:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:00:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:00:13 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    update
        chat_sessions 
    set
        is_deleted=?,
        last_message_at=?,
        message_count=?,
        status=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        session_id=?
2025-12-02 22:00:13 [http-nio-8080-exec-6] INFO  c.e.s.service.AiChatService - 会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 完成一轮对话，当前消息数: 10
2025-12-02 22:00:13 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:00:13 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=发送成功, data=ChatMessageResponse(sessionId=ce67e930-c06a-4a90-b164-4c410 (truncated)...]
2025-12-02 22:00:13 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:08:54 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 22:08:54 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 22:08:54 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=删除12.5的日程, sessionId=ce67e930-c06a-4a90-b164-4c4104aba6d2, userId=null)]
2025-12-02 22:08:54 [http-nio-8080-exec-8] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, sessionId: ce67e930-c06a-4a90-b164-4c4104aba6d2, message: 删除12.5的日程
2025-12-02 22:08:54 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=? 
        and cs1_0.user_id=? 
        and cs1_0.is_deleted=?
2025-12-02 22:08:54 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        coalesce(max(cm1_0.sequence_num), 0) 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=?
2025-12-02 22:08:54 [http-nio-8080-exec-8] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 9 条消息
2025-12-02 22:08:54 [http-nio-8080-exec-8] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 10 条消息
2025-12-02 22:08:54 [http-nio-8080-exec-8] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "can you seek my dick？"
  }, {
    "role" : "assistant",
    "content" : "未识别到日程信息"
  }, {
    "role" : "user",
    "content" : "？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"
  }, {
    "role" : "user",
    "content" : "你不会聊天吗？"
  }, {
    "role" : "assistant",
    "content" : "我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"
  }, {
    "role" : "user",
    "content" : "你傻福啊？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:08（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:08，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:08）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "删除12.5的日程"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 22:08:54 [http-nio-8080-exec-8] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "can you seek my dick？"
  }, {
    "role" : "assistant",
    "content" : "未识别到日程信息"
  }, {
    "role" : "user",
    "content" : "？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"
  }, {
    "role" : "user",
    "content" : "你不会聊天吗？"
  }, {
    "role" : "assistant",
    "content" : "我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"
  }, {
    "role" : "user",
    "content" : "你傻福啊？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:08（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:08，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:08）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "删除12.5的日程"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 22:08:55 [http-nio-8080-exec-8] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 22:08:55 [http-nio-8080-exec-8] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 14:08:55 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 490], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_mbkzwnt3htgipot12r]
- body: {"id":"d154bd6caa6c49338f0e5f3c90ae2010","object":"chat.completion","created":1764684535,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"","tool_calls":[{"index":-1,"id":"call_720a5fa8feb94cd1bedd679c","type":"function","function":{"name":"deleteSchedule","arguments":"{\"titleKeyword\": \"12.5\"}"}}]},"finish_reason":"tool_calls"}],"usage":{"prompt_tokens":2223,"completion_tokens":24,"total_tokens":2247},"system_fingerprint":""}

2025-12-02 22:08:55 [http-nio-8080-exec-8] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 11 条消息
2025-12-02 22:08:55 [http-nio-8080-exec-8] INFO  c.e.s.service.CalendarTools - 【CalendarTools】deleteSchedule - userId: c6d84871-f654-45f4-b11b-2a8412b6b200, keyword: 12.5
2025-12-02 22:08:55 [http-nio-8080-exec-8] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 12
2025-12-02 22:08:55 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 22:08:55 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 22:08:55 [http-nio-8080-exec-8] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 12 条消息
2025-12-02 22:08:55 [http-nio-8080-exec-8] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "can you seek my dick？"
  }, {
    "role" : "assistant",
    "content" : "未识别到日程信息"
  }, {
    "role" : "user",
    "content" : "？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"
  }, {
    "role" : "user",
    "content" : "你不会聊天吗？"
  }, {
    "role" : "assistant",
    "content" : "我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"
  }, {
    "role" : "user",
    "content" : "你傻福啊？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:08（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:08，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:08）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "删除12.5的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_720a5fa8feb94cd1bedd679c",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_720a5fa8feb94cd1bedd679c",
    "content" : "找不到标题包含「12.5」的日程。"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 22:08:55 [http-nio-8080-exec-8] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "can you seek my dick？"
  }, {
    "role" : "assistant",
    "content" : "未识别到日程信息"
  }, {
    "role" : "user",
    "content" : "？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"
  }, {
    "role" : "user",
    "content" : "你不会聊天吗？"
  }, {
    "role" : "assistant",
    "content" : "我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"
  }, {
    "role" : "user",
    "content" : "你傻福啊？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:08（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:08，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:08）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "删除12.5的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_720a5fa8feb94cd1bedd679c",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_720a5fa8feb94cd1bedd679c",
    "content" : "找不到标题包含「12.5」的日程。"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 22:08:55 [http-nio-8080-exec-8] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 22:08:55 [http-nio-8080-exec-8] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 14:08:55 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 466], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_9oujqd2ah8drmn22nj]
- body: {"id":"0d9e9849819748e1aa02cf3944741a37","object":"chat.completion","created":1764684535,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"},"finish_reason":"stop"}],"usage":{"prompt_tokens":2271,"completion_tokens":36,"total_tokens":2307},"system_fingerprint":""}

2025-12-02 22:08:55 [http-nio-8080-exec-8] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 13 条消息
2025-12-02 22:08:55 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:08:55 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:08:55 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    update
        chat_sessions 
    set
        is_deleted=?,
        last_message_at=?,
        message_count=?,
        status=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        session_id=?
2025-12-02 22:08:55 [http-nio-8080-exec-8] INFO  c.e.s.service.AiChatService - 会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 完成一轮对话，当前消息数: 12
2025-12-02 22:08:55 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:08:55 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=发送成功, data=ChatMessageResponse(sessionId=ce67e930-c06a-4a90-b164-4c410 (truncated)...]
2025-12-02 22:08:55 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:09:06 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 22:09:06 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 22:09:06 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我删除12.5日的日程, sessionId=ce67e930-c06a-4a90-b164-4c4104aba6d2, userId=null (truncated)...]
2025-12-02 22:09:06 [http-nio-8080-exec-10] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, sessionId: ce67e930-c06a-4a90-b164-4c4104aba6d2, message: 帮我删除12.5日的日程
2025-12-02 22:09:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=? 
        and cs1_0.user_id=? 
        and cs1_0.is_deleted=?
2025-12-02 22:09:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        coalesce(max(cm1_0.sequence_num), 0) 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=?
2025-12-02 22:09:06 [http-nio-8080-exec-10] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 13 条消息
2025-12-02 22:09:06 [http-nio-8080-exec-10] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 14 条消息
2025-12-02 22:09:06 [http-nio-8080-exec-10] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "can you seek my dick？"
  }, {
    "role" : "assistant",
    "content" : "未识别到日程信息"
  }, {
    "role" : "user",
    "content" : "？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"
  }, {
    "role" : "user",
    "content" : "你不会聊天吗？"
  }, {
    "role" : "assistant",
    "content" : "我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"
  }, {
    "role" : "user",
    "content" : "你傻福啊？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"
  }, {
    "role" : "user",
    "content" : "删除12.5的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_720a5fa8feb94cd1bedd679c",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_720a5fa8feb94cd1bedd679c",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 22:09:06 [http-nio-8080-exec-10] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "can you seek my dick？"
  }, {
    "role" : "assistant",
    "content" : "未识别到日程信息"
  }, {
    "role" : "user",
    "content" : "？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"
  }, {
    "role" : "user",
    "content" : "你不会聊天吗？"
  }, {
    "role" : "assistant",
    "content" : "我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"
  }, {
    "role" : "user",
    "content" : "你傻福啊？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"
  }, {
    "role" : "user",
    "content" : "删除12.5的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_720a5fa8feb94cd1bedd679c",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_720a5fa8feb94cd1bedd679c",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 22:09:06 [http-nio-8080-exec-10] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 22:09:06 [http-nio-8080-exec-10] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 14:09:06 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 490], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_cjtwmpw9vxxvkxlq3b]
- body: {"id":"ed9729e36c5f4e41ad7b8823a5fb2c25","object":"chat.completion","created":1764684546,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"","tool_calls":[{"index":-1,"id":"call_047841cd57184d50adbc87db","type":"function","function":{"name":"deleteSchedule","arguments":"{\"titleKeyword\": \"12.5\"}"}}]},"finish_reason":"tool_calls"}],"usage":{"prompt_tokens":2325,"completion_tokens":24,"total_tokens":2349},"system_fingerprint":""}

2025-12-02 22:09:06 [http-nio-8080-exec-10] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 15 条消息
2025-12-02 22:09:06 [http-nio-8080-exec-10] INFO  c.e.s.service.CalendarTools - 【CalendarTools】deleteSchedule - userId: c6d84871-f654-45f4-b11b-2a8412b6b200, keyword: 12.5
2025-12-02 22:09:06 [http-nio-8080-exec-10] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 12
2025-12-02 22:09:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 22:09:06 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 22:09:06 [http-nio-8080-exec-10] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 16 条消息
2025-12-02 22:09:06 [http-nio-8080-exec-10] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "can you seek my dick？"
  }, {
    "role" : "assistant",
    "content" : "未识别到日程信息"
  }, {
    "role" : "user",
    "content" : "？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"
  }, {
    "role" : "user",
    "content" : "你不会聊天吗？"
  }, {
    "role" : "assistant",
    "content" : "我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"
  }, {
    "role" : "user",
    "content" : "你傻福啊？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"
  }, {
    "role" : "user",
    "content" : "删除12.5的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_720a5fa8feb94cd1bedd679c",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_720a5fa8feb94cd1bedd679c",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_047841cd57184d50adbc87db",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_047841cd57184d50adbc87db",
    "content" : "找不到标题包含「12.5」的日程。"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 22:09:06 [http-nio-8080-exec-10] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "can you seek my dick？"
  }, {
    "role" : "assistant",
    "content" : "未识别到日程信息"
  }, {
    "role" : "user",
    "content" : "？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"
  }, {
    "role" : "user",
    "content" : "你不会聊天吗？"
  }, {
    "role" : "assistant",
    "content" : "我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"
  }, {
    "role" : "user",
    "content" : "你傻福啊？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"
  }, {
    "role" : "user",
    "content" : "删除12.5的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_720a5fa8feb94cd1bedd679c",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_720a5fa8feb94cd1bedd679c",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_047841cd57184d50adbc87db",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_047841cd57184d50adbc87db",
    "content" : "找不到标题包含「12.5」的日程。"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 22:09:07 [http-nio-8080-exec-10] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 22:09:07 [http-nio-8080-exec-10] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 14:09:07 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 466], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_z31272g9kq70quiqb5]
- body: {"id":"8d7fcc59ba6446f5ac12e1b8c46e95af","object":"chat.completion","created":1764684547,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"},"finish_reason":"stop"}],"usage":{"prompt_tokens":2373,"completion_tokens":36,"total_tokens":2409},"system_fingerprint":""}

2025-12-02 22:09:07 [http-nio-8080-exec-10] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 17 条消息
2025-12-02 22:09:07 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:09:07 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:09:07 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    update
        chat_sessions 
    set
        is_deleted=?,
        last_message_at=?,
        message_count=?,
        status=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        session_id=?
2025-12-02 22:09:07 [http-nio-8080-exec-10] INFO  c.e.s.service.AiChatService - 会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 完成一轮对话，当前消息数: 14
2025-12-02 22:09:07 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:09:07 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=发送成功, data=ChatMessageResponse(sessionId=ce67e930-c06a-4a90-b164-4c410 (truncated)...]
2025-12-02 22:09:07 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:09:18 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 22:09:18 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 22:09:18 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我删除12月5号的日程, sessionId=ce67e930-c06a-4a90-b164-4c4104aba6d2, userId=null (truncated)...]
2025-12-02 22:09:18 [http-nio-8080-exec-9] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, sessionId: ce67e930-c06a-4a90-b164-4c4104aba6d2, message: 帮我删除12月5号的日程
2025-12-02 22:09:18 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=? 
        and cs1_0.user_id=? 
        and cs1_0.is_deleted=?
2025-12-02 22:09:18 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        coalesce(max(cm1_0.sequence_num), 0) 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=?
2025-12-02 22:09:18 [http-nio-8080-exec-9] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 18 条消息
2025-12-02 22:09:18 [http-nio-8080-exec-9] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "can you seek my dick？"
  }, {
    "role" : "assistant",
    "content" : "未识别到日程信息"
  }, {
    "role" : "user",
    "content" : "？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"
  }, {
    "role" : "user",
    "content" : "你不会聊天吗？"
  }, {
    "role" : "assistant",
    "content" : "我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"
  }, {
    "role" : "user",
    "content" : "你傻福啊？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"
  }, {
    "role" : "user",
    "content" : "删除12.5的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_720a5fa8feb94cd1bedd679c",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_720a5fa8feb94cd1bedd679c",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_047841cd57184d50adbc87db",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_047841cd57184d50adbc87db",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12月5号的日程"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 22:09:18 [http-nio-8080-exec-9] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "can you seek my dick？"
  }, {
    "role" : "assistant",
    "content" : "未识别到日程信息"
  }, {
    "role" : "user",
    "content" : "？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"
  }, {
    "role" : "user",
    "content" : "你不会聊天吗？"
  }, {
    "role" : "assistant",
    "content" : "我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"
  }, {
    "role" : "user",
    "content" : "你傻福啊？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"
  }, {
    "role" : "user",
    "content" : "删除12.5的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_720a5fa8feb94cd1bedd679c",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_720a5fa8feb94cd1bedd679c",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_047841cd57184d50adbc87db",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_047841cd57184d50adbc87db",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12月5号的日程"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 22:09:19 [http-nio-8080-exec-9] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 22:09:19 [http-nio-8080-exec-9] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 14:09:19 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 495], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_fnm1e158yxbhxomjra]
- body: {"id":"120a9e102b3542afb5fc85eca3e9ecc5","object":"chat.completion","created":1764684559,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"","tool_calls":[{"index":-1,"id":"call_58359a5238c64156acfaea5f","type":"function","function":{"name":"deleteSchedule","arguments":"{\"titleKeyword\": \"12月5号\"}"}}]},"finish_reason":"tool_calls"}],"usage":{"prompt_tokens":2427,"completion_tokens":25,"total_tokens":2452},"system_fingerprint":""}

2025-12-02 22:09:19 [http-nio-8080-exec-9] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 19 条消息
2025-12-02 22:09:19 [http-nio-8080-exec-9] INFO  c.e.s.service.CalendarTools - 【CalendarTools】deleteSchedule - userId: c6d84871-f654-45f4-b11b-2a8412b6b200, keyword: 12月5号
2025-12-02 22:09:19 [http-nio-8080-exec-9] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 12
2025-12-02 22:09:19 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 22:09:19 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 22:09:19 [http-nio-8080-exec-9] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 20 条消息
2025-12-02 22:09:19 [http-nio-8080-exec-9] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "can you seek my dick？"
  }, {
    "role" : "assistant",
    "content" : "未识别到日程信息"
  }, {
    "role" : "user",
    "content" : "？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"
  }, {
    "role" : "user",
    "content" : "你不会聊天吗？"
  }, {
    "role" : "assistant",
    "content" : "我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"
  }, {
    "role" : "user",
    "content" : "你傻福啊？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"
  }, {
    "role" : "user",
    "content" : "删除12.5的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_720a5fa8feb94cd1bedd679c",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_720a5fa8feb94cd1bedd679c",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_047841cd57184d50adbc87db",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_047841cd57184d50adbc87db",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12月5号的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_58359a5238c64156acfaea5f",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12月5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_58359a5238c64156acfaea5f",
    "content" : "找不到标题包含「12月5号」的日程。"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 22:09:19 [http-nio-8080-exec-9] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "can you seek my dick？"
  }, {
    "role" : "assistant",
    "content" : "未识别到日程信息"
  }, {
    "role" : "user",
    "content" : "？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"
  }, {
    "role" : "user",
    "content" : "你不会聊天吗？"
  }, {
    "role" : "assistant",
    "content" : "我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"
  }, {
    "role" : "user",
    "content" : "你傻福啊？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"
  }, {
    "role" : "user",
    "content" : "删除12.5的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_720a5fa8feb94cd1bedd679c",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_720a5fa8feb94cd1bedd679c",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_047841cd57184d50adbc87db",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_047841cd57184d50adbc87db",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12月5号的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_58359a5238c64156acfaea5f",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12月5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_58359a5238c64156acfaea5f",
    "content" : "找不到标题包含「12月5号」的日程。"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 22:09:19 [http-nio-8080-exec-9] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 22:09:19 [http-nio-8080-exec-9] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 14:09:19 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 471], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_4k41qohdoppu1489e7]
- body: {"id":"682e3728854340c480e92c461e89976c","object":"chat.completion","created":1764684559,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"未找到标题包含“12月5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"},"finish_reason":"stop"}],"usage":{"prompt_tokens":2477,"completion_tokens":37,"total_tokens":2514},"system_fingerprint":""}

2025-12-02 22:09:19 [http-nio-8080-exec-9] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 20 条消息
2025-12-02 22:09:19 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:09:19 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:09:19 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    update
        chat_sessions 
    set
        is_deleted=?,
        last_message_at=?,
        message_count=?,
        status=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        session_id=?
2025-12-02 22:09:19 [http-nio-8080-exec-9] INFO  c.e.s.service.AiChatService - 会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 完成一轮对话，当前消息数: 16
2025-12-02 22:09:19 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:09:19 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=发送成功, data=ChatMessageResponse(sessionId=ce67e930-c06a-4a90-b164-4c410 (truncated)...]
2025-12-02 22:09:19 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:09:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 22:09:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 22:09:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我删除12.5号的所有日程, sessionId=ce67e930-c06a-4a90-b164-4c4104aba6d2, userId=nu (truncated)...]
2025-12-02 22:09:28 [http-nio-8080-exec-1] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, sessionId: ce67e930-c06a-4a90-b164-4c4104aba6d2, message: 帮我删除12.5号的所有日程
2025-12-02 22:09:28 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=? 
        and cs1_0.user_id=? 
        and cs1_0.is_deleted=?
2025-12-02 22:09:28 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        coalesce(max(cm1_0.sequence_num), 0) 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=?
2025-12-02 22:09:28 [http-nio-8080-exec-1] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 20 条消息
2025-12-02 22:09:28 [http-nio-8080-exec-1] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"
  }, {
    "role" : "user",
    "content" : "你不会聊天吗？"
  }, {
    "role" : "assistant",
    "content" : "我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"
  }, {
    "role" : "user",
    "content" : "你傻福啊？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"
  }, {
    "role" : "user",
    "content" : "删除12.5的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_720a5fa8feb94cd1bedd679c",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_720a5fa8feb94cd1bedd679c",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_047841cd57184d50adbc87db",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_047841cd57184d50adbc87db",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12月5号的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_58359a5238c64156acfaea5f",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12月5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_58359a5238c64156acfaea5f",
    "content" : "找不到标题包含「12月5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12月5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5号的所有日程"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 22:09:28 [http-nio-8080-exec-1] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，可以帮助您添加、查询或删除日程安排。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会帮您处理！"
  }, {
    "role" : "user",
    "content" : "你不会聊天吗？"
  }, {
    "role" : "assistant",
    "content" : "我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"
  }, {
    "role" : "user",
    "content" : "你傻福啊？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"
  }, {
    "role" : "user",
    "content" : "删除12.5的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_720a5fa8feb94cd1bedd679c",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_720a5fa8feb94cd1bedd679c",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_047841cd57184d50adbc87db",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_047841cd57184d50adbc87db",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12月5号的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_58359a5238c64156acfaea5f",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12月5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_58359a5238c64156acfaea5f",
    "content" : "找不到标题包含「12月5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12月5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5号的所有日程"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 22:09:29 [http-nio-8080-exec-1] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 22:09:29 [http-nio-8080-exec-1] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 14:09:29 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 493], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_tvkv1ey6sz7krbi0fe]
- body: {"id":"3ce4e6394020402385965cc3cb85d171","object":"chat.completion","created":1764684569,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"","tool_calls":[{"index":-1,"id":"call_2be26cdde77f4338ae937f6d","type":"function","function":{"name":"deleteSchedule","arguments":"{\"titleKeyword\": \"12.5号\"}"}}]},"finish_reason":"tool_calls"}],"usage":{"prompt_tokens":2511,"completion_tokens":25,"total_tokens":2536},"system_fingerprint":""}

2025-12-02 22:09:29 [http-nio-8080-exec-1] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 20 条消息
2025-12-02 22:09:29 [http-nio-8080-exec-1] INFO  c.e.s.service.CalendarTools - 【CalendarTools】deleteSchedule - userId: c6d84871-f654-45f4-b11b-2a8412b6b200, keyword: 12.5号
2025-12-02 22:09:29 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 12
2025-12-02 22:09:29 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 22:09:29 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 22:09:29 [http-nio-8080-exec-1] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 20 条消息
2025-12-02 22:09:29 [http-nio-8080-exec-1] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "你不会聊天吗？"
  }, {
    "role" : "assistant",
    "content" : "我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"
  }, {
    "role" : "user",
    "content" : "你傻福啊？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"
  }, {
    "role" : "user",
    "content" : "删除12.5的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_720a5fa8feb94cd1bedd679c",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_720a5fa8feb94cd1bedd679c",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_047841cd57184d50adbc87db",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_047841cd57184d50adbc87db",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12月5号的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_58359a5238c64156acfaea5f",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12月5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_58359a5238c64156acfaea5f",
    "content" : "找不到标题包含「12月5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12月5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5号的所有日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_2be26cdde77f4338ae937f6d",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_2be26cdde77f4338ae937f6d",
    "content" : "找不到标题包含「12.5号」的日程。"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 22:09:29 [http-nio-8080-exec-1] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "你不会聊天吗？"
  }, {
    "role" : "assistant",
    "content" : "我是一个专为管理日程安排而设计的助手，可以帮助您添加、查询或删除日程。如果您有需要记录的事项，比如会议、提醒或计划，请告诉我，我会立即帮您处理！"
  }, {
    "role" : "user",
    "content" : "你傻福啊？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"
  }, {
    "role" : "user",
    "content" : "删除12.5的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_720a5fa8feb94cd1bedd679c",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_720a5fa8feb94cd1bedd679c",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_047841cd57184d50adbc87db",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_047841cd57184d50adbc87db",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12月5号的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_58359a5238c64156acfaea5f",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12月5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_58359a5238c64156acfaea5f",
    "content" : "找不到标题包含「12月5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12月5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5号的所有日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_2be26cdde77f4338ae937f6d",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_2be26cdde77f4338ae937f6d",
    "content" : "找不到标题包含「12.5号」的日程。"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 22:09:29 [http-nio-8080-exec-1] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 22:09:29 [http-nio-8080-exec-1] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 14:09:29 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 469], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_9za7pof7ou2bpvjvsv]
- body: {"id":"8683f9d91d0a477b8ea30750b19e6181","object":"chat.completion","created":1764684569,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"未找到标题包含“12.5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"},"finish_reason":"stop"}],"usage":{"prompt_tokens":2512,"completion_tokens":37,"total_tokens":2549},"system_fingerprint":""}

2025-12-02 22:09:29 [http-nio-8080-exec-1] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 20 条消息
2025-12-02 22:09:29 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:09:29 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:09:29 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    update
        chat_sessions 
    set
        is_deleted=?,
        last_message_at=?,
        message_count=?,
        status=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        session_id=?
2025-12-02 22:09:29 [http-nio-8080-exec-1] INFO  c.e.s.service.AiChatService - 会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 完成一轮对话，当前消息数: 18
2025-12-02 22:09:29 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:09:29 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=发送成功, data=ChatMessageResponse(sessionId=ce67e930-c06a-4a90-b164-4c410 (truncated)...]
2025-12-02 22:09:29 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:09:36 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 22:09:36 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 22:09:36 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我删除妇联日程, sessionId=ce67e930-c06a-4a90-b164-4c4104aba6d2, userId=null)]
2025-12-02 22:09:36 [http-nio-8080-exec-2] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, sessionId: ce67e930-c06a-4a90-b164-4c4104aba6d2, message: 帮我删除妇联日程
2025-12-02 22:09:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=? 
        and cs1_0.user_id=? 
        and cs1_0.is_deleted=?
2025-12-02 22:09:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        coalesce(max(cm1_0.sequence_num), 0) 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=?
2025-12-02 22:09:36 [http-nio-8080-exec-2] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 20 条消息
2025-12-02 22:09:36 [http-nio-8080-exec-2] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "你傻福啊？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"
  }, {
    "role" : "user",
    "content" : "删除12.5的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_720a5fa8feb94cd1bedd679c",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_720a5fa8feb94cd1bedd679c",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_047841cd57184d50adbc87db",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_047841cd57184d50adbc87db",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12月5号的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_58359a5238c64156acfaea5f",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12月5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_58359a5238c64156acfaea5f",
    "content" : "找不到标题包含「12月5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12月5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5号的所有日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_2be26cdde77f4338ae937f6d",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_2be26cdde77f4338ae937f6d",
    "content" : "找不到标题包含「12.5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除妇联日程"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 22:09:36 [http-nio-8080-exec-2] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "你傻福啊？"
  }, {
    "role" : "assistant",
    "content" : "我是一个日程助手，专注于帮您管理日程安排。如果您有需要添加、查询或删除的事项，请随时告诉我，我会立即为您处理。"
  }, {
    "role" : "user",
    "content" : "删除12.5的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_720a5fa8feb94cd1bedd679c",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_720a5fa8feb94cd1bedd679c",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_047841cd57184d50adbc87db",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_047841cd57184d50adbc87db",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12月5号的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_58359a5238c64156acfaea5f",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12月5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_58359a5238c64156acfaea5f",
    "content" : "找不到标题包含「12月5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12月5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5号的所有日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_2be26cdde77f4338ae937f6d",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_2be26cdde77f4338ae937f6d",
    "content" : "找不到标题包含「12.5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除妇联日程"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 22:09:37 [http-nio-8080-exec-2] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 22:09:37 [http-nio-8080-exec-2] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 14:09:37 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 492], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_eayy6o5m6cvecd1w0y]
- body: {"id":"d338d2acd1be427f954b7566b7156c48","object":"chat.completion","created":1764684577,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"","tool_calls":[{"index":-1,"id":"call_bc6f05aadbee4652bbf6a9e2","type":"function","function":{"name":"deleteSchedule","arguments":"{\"titleKeyword\": \"妇联\"}"}}]},"finish_reason":"tool_calls"}],"usage":{"prompt_tokens":2503,"completion_tokens":21,"total_tokens":2524},"system_fingerprint":""}

2025-12-02 22:09:37 [http-nio-8080-exec-2] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 20 条消息
2025-12-02 22:09:37 [http-nio-8080-exec-2] INFO  c.e.s.service.CalendarTools - 【CalendarTools】deleteSchedule - userId: c6d84871-f654-45f4-b11b-2a8412b6b200, keyword: 妇联
2025-12-02 22:09:37 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 12
2025-12-02 22:09:37 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 22:09:37 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 22:09:37 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 删除日程 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 日程ID: c2758597-9db5-4b3c-81f6-b812c11dd69e
2025-12-02 22:09:37 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.schedule_id=? 
        and s1_0.is_deleted=?
2025-12-02 22:09:37 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 日程删除成功 - 日程ID: c2758597-9db5-4b3c-81f6-b812c11dd69e
2025-12-02 22:09:37 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    update
        schedules 
    set
        end_time=?,
        group_id=?,
        is_all_day=?,
        is_deleted=?,
        location=?,
        schedule_date=?,
        start_time=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        schedule_id=?
2025-12-02 22:09:37 [http-nio-8080-exec-2] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 20 条消息
2025-12-02 22:09:37 [http-nio-8080-exec-2] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "删除12.5的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_720a5fa8feb94cd1bedd679c",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_720a5fa8feb94cd1bedd679c",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_047841cd57184d50adbc87db",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_047841cd57184d50adbc87db",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12月5号的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_58359a5238c64156acfaea5f",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12月5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_58359a5238c64156acfaea5f",
    "content" : "找不到标题包含「12月5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12月5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5号的所有日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_2be26cdde77f4338ae937f6d",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_2be26cdde77f4338ae937f6d",
    "content" : "找不到标题包含「12.5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除妇联日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_bc6f05aadbee4652bbf6a9e2",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"妇联\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_bc6f05aadbee4652bbf6a9e2",
    "content" : "✅ 已删除日程：【2025-12-05】妇联换届大会 14:00"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 22:09:37 [http-nio-8080-exec-2] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "删除12.5的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_720a5fa8feb94cd1bedd679c",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_720a5fa8feb94cd1bedd679c",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_047841cd57184d50adbc87db",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_047841cd57184d50adbc87db",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12月5号的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_58359a5238c64156acfaea5f",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12月5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_58359a5238c64156acfaea5f",
    "content" : "找不到标题包含「12月5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12月5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5号的所有日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_2be26cdde77f4338ae937f6d",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_2be26cdde77f4338ae937f6d",
    "content" : "找不到标题包含「12.5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除妇联日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_bc6f05aadbee4652bbf6a9e2",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"妇联\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_bc6f05aadbee4652bbf6a9e2",
    "content" : "✅ 已删除日程：【2025-12-05】妇联换届大会 14:00"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 22:09:37 [http-nio-8080-exec-2] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 22:09:37 [http-nio-8080-exec-2] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 14:09:37 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 383], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_r3z2r582t32b807xye]
- body: {"id":"d8e589004da24ef197f97803180a4df3","object":"chat.completion","created":1764684577,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"✅ 已删除日程：【2025-12-05】妇联换届大会 14:00"},"finish_reason":"stop"}],"usage":{"prompt_tokens":2517,"completion_tokens":29,"total_tokens":2546},"system_fingerprint":""}

2025-12-02 22:09:37 [http-nio-8080-exec-2] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 20 条消息
2025-12-02 22:09:37 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:09:37 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:09:37 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    update
        chat_sessions 
    set
        is_deleted=?,
        last_message_at=?,
        message_count=?,
        status=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        session_id=?
2025-12-02 22:09:37 [http-nio-8080-exec-2] INFO  c.e.s.service.AiChatService - 会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 完成一轮对话，当前消息数: 20
2025-12-02 22:09:37 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:09:37 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=发送成功, data=ChatMessageResponse(sessionId=ce67e930-c06a-4a90-b164-4c410 (truncated)...]
2025-12-02 22:09:37 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:09:40 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=12", parameters={masked}
2025-12-02 22:09:40 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-12-02 22:09:40 [http-nio-8080-exec-4] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, year: 2025, month: 12
2025-12-02 22:09:40 [http-nio-8080-exec-4] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 12
2025-12-02 22:09:40 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 22:09:40 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 22:09:40 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:09:40 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=650bf50a-41dd-4c8d-8f30-6d251de2083 (truncated)...]
2025-12-02 22:09:40 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:09:58 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 22:09:58 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 22:09:58 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我添加日程：DX23 计算机 2 徐嘉玲<EOL>各位部长上午好:<EOL>12 月5 日下午 14:00将举行学<EOL>院的妇联换届大会，现招募 7-9 个<EOL>部长( (truncated)...]
2025-12-02 22:09:58 [http-nio-8080-exec-3] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, sessionId: null, message: 帮我添加日程：DX23 计算机 2 徐嘉玲
各位部长上午好:
12 月5 日下午 14:00将举行学
院的妇联换届大会，现招募 7-9 个
部长(必须是女生)出席参加会
议。参与的同学直接填写下方共
...
2025-12-02 22:09:58 [http-nio-8080-exec-3] INFO  c.e.s.service.AiChatService - 准备为用户 c6d84871-f654-45f4-b11b-2a8412b6b200 创建新会话...
2025-12-02 22:09:58 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=?
2025-12-02 22:09:58 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_sessions
        (created_at, is_deleted, last_message_at, message_count, status, title, updated_at, user_id, session_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:09:58 [http-nio-8080-exec-3] INFO  c.e.s.service.AiChatService - 为用户 c6d84871-f654-45f4-b11b-2a8412b6b200 创建新会话成功: 5edb86ff-b752-43df-86b8-69949f24b975
2025-12-02 22:09:58 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        coalesce(max(cm1_0.sequence_num), 0) 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=?
2025-12-02 22:09:58 [http-nio-8080-exec-3] INFO  c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】首次加载会话 5edb86ff-b752-43df-86b8-69949f24b975 的历史消息
2025-12-02 22:09:58 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num
2025-12-02 22:09:58 [http-nio-8080-exec-3] INFO  c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 5edb86ff-b752-43df-86b8-69949f24b975 加载了 0 条历史消息
2025-12-02 22:09:58 [http-nio-8080-exec-3] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 5edb86ff-b752-43df-86b8-69949f24b975 内存缓存更新，当前 1 条消息
2025-12-02 22:09:58 [http-nio-8080-exec-3] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 5edb86ff-b752-43df-86b8-69949f24b975 内存缓存更新，当前 2 条消息
2025-12-02 22:09:58 [http-nio-8080-exec-3] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加日程：DX23 计算机 2 徐嘉玲\n各位部长上午好:\n12 月5 日下午 14:00将举行学\n院的妇联换届大会，现招募 7-9 个\n部长(必须是女生)出席参加会\n议。参与的同学直接填写下方共\n享表格即可\nDX23 计算机 2 徐嘉玲\n$\\text{V}$\n金山文档IWPS 云文档\n12.5 下午 14 点妇联活动人员\n统计表\n所有人可编辑在线文档\n$\\text{S}$\n$\\text{田$\n来自 $\\text{W}$ WPS Office\n小程序\n昨天 11:49\nDX23 计算机 2 徐嘉玲\n本次活动会给予相应的 pu 学时\n$\\text{C}$\n\n"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 22:09:58 [http-nio-8080-exec-3] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加日程：DX23 计算机 2 徐嘉玲\n各位部长上午好:\n12 月5 日下午 14:00将举行学\n院的妇联换届大会，现招募 7-9 个\n部长(必须是女生)出席参加会\n议。参与的同学直接填写下方共\n享表格即可\nDX23 计算机 2 徐嘉玲\n$\\text{V}$\n金山文档IWPS 云文档\n12.5 下午 14 点妇联活动人员\n统计表\n所有人可编辑在线文档\n$\\text{S}$\n$\\text{田$\n来自 $\\text{W}$ WPS Office\n小程序\n昨天 11:49\nDX23 计算机 2 徐嘉玲\n本次活动会给予相应的 pu 学时\n$\\text{C}$\n\n"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 22:09:58 [http-nio-8080-exec-3] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 22:09:58 [http-nio-8080-exec-3] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 14:09:58 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 609], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_h4ud0lyxzw6btjxfjx]
- body: {"id":"617f92d50e4d4cee99afced0b0e8f68a","object":"chat.completion","created":1764684598,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"","tool_calls":[{"index":-1,"id":"call_43e09f5aca1046768ac09743","type":"function","function":{"name":"createSchedule","arguments":"{\"title\": \"妇联换届大会\", \"date\": \"2025-12-05\", \"startTime\": \"14:00\", \"endTime\": \"\", \"location\": \"\", \"isAllDay\": false}"}}]},"finish_reason":"tool_calls"}],"usage":{"prompt_tokens":2223,"completion_tokens":62,"total_tokens":2285},"system_fingerprint":""}

2025-12-02 22:09:58 [http-nio-8080-exec-3] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 5edb86ff-b752-43df-86b8-69949f24b975 内存缓存更新，当前 3 条消息
2025-12-02 22:09:58 [http-nio-8080-exec-3] INFO  c.e.s.service.CalendarTools - 【CalendarTools】createSchedule 被调用 - userId: c6d84871-f654-45f4-b11b-2a8412b6b200, title: 妇联换届大会, date: 2025-12-05, startTime: 14:00, endTime: , location: , isAllDay: false
2025-12-02 22:09:58 [http-nio-8080-exec-3] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 标题: 妇联换届大会, 群组ID: null
2025-12-02 22:09:58 [http-nio-8080-exec-3] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: f2c63522-0d8b-4d52-834a-f278d02d0d73
2025-12-02 22:09:58 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, group_id, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:09:58 [http-nio-8080-exec-3] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 5edb86ff-b752-43df-86b8-69949f24b975 内存缓存更新，当前 4 条消息
2025-12-02 22:09:58 [http-nio-8080-exec-3] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加日程：DX23 计算机 2 徐嘉玲\n各位部长上午好:\n12 月5 日下午 14:00将举行学\n院的妇联换届大会，现招募 7-9 个\n部长(必须是女生)出席参加会\n议。参与的同学直接填写下方共\n享表格即可\nDX23 计算机 2 徐嘉玲\n$\\text{V}$\n金山文档IWPS 云文档\n12.5 下午 14 点妇联活动人员\n统计表\n所有人可编辑在线文档\n$\\text{S}$\n$\\text{田$\n来自 $\\text{W}$ WPS Office\n小程序\n昨天 11:49\nDX23 计算机 2 徐嘉玲\n本次活动会给予相应的 pu 学时\n$\\text{C}$\n\n"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_43e09f5aca1046768ac09743",
      "type" : "function",
      "function" : {
        "name" : "createSchedule",
        "arguments" : "{\"title\": \"妇联换届大会\", \"date\": \"2025-12-05\", \"startTime\": \"14:00\", \"endTime\": \"\", \"location\": \"\", \"isAllDay\": false}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_43e09f5aca1046768ac09743",
    "content" : "✅ 日程创建成功！\n📅 标题：妇联换届大会\n📆 日期：2025-12-05\n⏰ 时间：14:00 - 未设置"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 22:09:58 [http-nio-8080-exec-3] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:09（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:09，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:09）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加日程：DX23 计算机 2 徐嘉玲\n各位部长上午好:\n12 月5 日下午 14:00将举行学\n院的妇联换届大会，现招募 7-9 个\n部长(必须是女生)出席参加会\n议。参与的同学直接填写下方共\n享表格即可\nDX23 计算机 2 徐嘉玲\n$\\text{V}$\n金山文档IWPS 云文档\n12.5 下午 14 点妇联活动人员\n统计表\n所有人可编辑在线文档\n$\\text{S}$\n$\\text{田$\n来自 $\\text{W}$ WPS Office\n小程序\n昨天 11:49\nDX23 计算机 2 徐嘉玲\n本次活动会给予相应的 pu 学时\n$\\text{C}$\n\n"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_43e09f5aca1046768ac09743",
      "type" : "function",
      "function" : {
        "name" : "createSchedule",
        "arguments" : "{\"title\": \"妇联换届大会\", \"date\": \"2025-12-05\", \"startTime\": \"14:00\", \"endTime\": \"\", \"location\": \"\", \"isAllDay\": false}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_43e09f5aca1046768ac09743",
    "content" : "✅ 日程创建成功！\n📅 标题：妇联换届大会\n📆 日期：2025-12-05\n⏰ 时间：14:00 - 未设置"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 22:09:59 [http-nio-8080-exec-3] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 22:09:59 [http-nio-8080-exec-3] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 14:09:59 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 382], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_wutx7y0l75mqu8gcdp]
- body: {"id":"9082954aa44749e4a0f3f5a1ba5b16e6","object":"chat.completion","created":1764684599,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"✅ 已添加日程：12月5日下午14:00 妇联换届大会"},"finish_reason":"stop"}],"usage":{"prompt_tokens":2341,"completion_tokens":24,"total_tokens":2365},"system_fingerprint":""}

2025-12-02 22:09:59 [http-nio-8080-exec-3] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 5edb86ff-b752-43df-86b8-69949f24b975 内存缓存更新，当前 5 条消息
2025-12-02 22:09:59 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:09:59 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:09:59 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    update
        chat_sessions 
    set
        is_deleted=?,
        last_message_at=?,
        message_count=?,
        status=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        session_id=?
2025-12-02 22:09:59 [http-nio-8080-exec-3] INFO  c.e.s.service.AiChatService - 会话 5edb86ff-b752-43df-86b8-69949f24b975 完成一轮对话，当前消息数: 4
2025-12-02 22:09:59 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:09:59 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=发送成功, data=ChatMessageResponse(sessionId=5edb86ff-b752-43df-86b8-69949 (truncated)...]
2025-12-02 22:09:59 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:10:15 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-12-02 22:10:15 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-12-02 22:10:15 [http-nio-8080-exec-5] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, year: 2025, month: 11
2025-12-02 22:10:15 [http-nio-8080-exec-5] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 11
2025-12-02 22:10:15 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 22:10:15 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 22:10:15 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:10:15 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-12-02 22:10:15 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:10:16 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=12", parameters={masked}
2025-12-02 22:10:16 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-12-02 22:10:16 [http-nio-8080-exec-6] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, year: 2025, month: 12
2025-12-02 22:10:16 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 12
2025-12-02 22:10:16 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 22:10:16 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 22:10:16 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:10:16 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=650bf50a-41dd-4c8d-8f30-6d251de2083 (truncated)...]
2025-12-02 22:10:16 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:11:16 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ai/chat/sessions", parameters={}
2025-12-02 22:11:16 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#getSessions(HttpServletRequest)
2025-12-02 22:11:16 [http-nio-8080-exec-7] INFO  c.e.s.controller.AiChatController - 【获取会话列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200
2025-12-02 22:11:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.user_id=? 
        and cs1_0.is_deleted=? 
    order by
        cs1_0.last_message_at desc,
        cs1_0.created_at desc
2025-12-02 22:11:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-12-02 22:11:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-12-02 22:11:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-12-02 22:11:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-12-02 22:11:16 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-12-02 22:11:16 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:11:16 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ChatSessionDTO(id=5edb86ff-b752-43df-86b8-69949f24b975, ti (truncated)...]
2025-12-02 22:11:16 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:11:26 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-12-02 22:11:26 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-12-02 22:11:26 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=我12.5号不想去妇联大会了, sessionId=ce67e930-c06a-4a90-b164-4c4104aba6d2, userId=nu (truncated)...]
2025-12-02 22:11:26 [http-nio-8080-exec-8] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, sessionId: ce67e930-c06a-4a90-b164-4c4104aba6d2, message: 我12.5号不想去妇联大会了
2025-12-02 22:11:26 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=? 
        and cs1_0.user_id=? 
        and cs1_0.is_deleted=?
2025-12-02 22:11:26 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        coalesce(max(cm1_0.sequence_num), 0) 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=?
2025-12-02 22:11:26 [http-nio-8080-exec-8] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 20 条消息
2025-12-02 22:11:26 [http-nio-8080-exec-8] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 19 条消息
2025-12-02 22:11:26 [http-nio-8080-exec-8] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_047841cd57184d50adbc87db",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_047841cd57184d50adbc87db",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12月5号的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_58359a5238c64156acfaea5f",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12月5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_58359a5238c64156acfaea5f",
    "content" : "找不到标题包含「12月5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12月5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5号的所有日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_2be26cdde77f4338ae937f6d",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_2be26cdde77f4338ae937f6d",
    "content" : "找不到标题包含「12.5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除妇联日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_bc6f05aadbee4652bbf6a9e2",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"妇联\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_bc6f05aadbee4652bbf6a9e2",
    "content" : "✅ 已删除日程：【2025-12-05】妇联换届大会 14:00"
  }, {
    "role" : "assistant",
    "content" : "✅ 已删除日程：【2025-12-05】妇联换届大会 14:00"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:11（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:11，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:11）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "我12.5号不想去妇联大会了"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 22:11:26 [http-nio-8080-exec-8] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_047841cd57184d50adbc87db",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_047841cd57184d50adbc87db",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12月5号的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_58359a5238c64156acfaea5f",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12月5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_58359a5238c64156acfaea5f",
    "content" : "找不到标题包含「12月5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12月5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5号的所有日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_2be26cdde77f4338ae937f6d",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_2be26cdde77f4338ae937f6d",
    "content" : "找不到标题包含「12.5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除妇联日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_bc6f05aadbee4652bbf6a9e2",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"妇联\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_bc6f05aadbee4652bbf6a9e2",
    "content" : "✅ 已删除日程：【2025-12-05】妇联换届大会 14:00"
  }, {
    "role" : "assistant",
    "content" : "✅ 已删除日程：【2025-12-05】妇联换届大会 14:00"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:11（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:11，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:11）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "我12.5号不想去妇联大会了"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 22:11:27 [http-nio-8080-exec-8] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 22:11:27 [http-nio-8080-exec-8] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 14:11:27 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 492], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_r0o8ai8qtye6xw7rs4]
- body: {"id":"efb4c810d28644ddb6f7cdd15e0805d6","object":"chat.completion","created":1764684687,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"","tool_calls":[{"index":-1,"id":"call_ea63b0468f714691a5833eec","type":"function","function":{"name":"deleteSchedule","arguments":"{\"titleKeyword\": \"妇联\"}"}}]},"finish_reason":"tool_calls"}],"usage":{"prompt_tokens":2506,"completion_tokens":21,"total_tokens":2527},"system_fingerprint":""}

2025-12-02 22:11:27 [http-nio-8080-exec-8] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 20 条消息
2025-12-02 22:11:27 [http-nio-8080-exec-8] INFO  c.e.s.service.CalendarTools - 【CalendarTools】deleteSchedule - userId: c6d84871-f654-45f4-b11b-2a8412b6b200, keyword: 妇联
2025-12-02 22:11:27 [http-nio-8080-exec-8] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 12
2025-12-02 22:11:27 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 22:11:27 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 22:11:27 [http-nio-8080-exec-8] INFO  c.e.s.service.ScheduleService - 删除日程 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 日程ID: f2c63522-0d8b-4d52-834a-f278d02d0d73
2025-12-02 22:11:27 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.schedule_id=? 
        and s1_0.is_deleted=?
2025-12-02 22:11:27 [http-nio-8080-exec-8] INFO  c.e.s.service.ScheduleService - 日程删除成功 - 日程ID: f2c63522-0d8b-4d52-834a-f278d02d0d73
2025-12-02 22:11:27 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    update
        schedules 
    set
        end_time=?,
        group_id=?,
        is_all_day=?,
        is_deleted=?,
        location=?,
        schedule_date=?,
        start_time=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        schedule_id=?
2025-12-02 22:11:27 [http-nio-8080-exec-8] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 20 条消息
2025-12-02 22:11:27 [http-nio-8080-exec-8] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_047841cd57184d50adbc87db",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_047841cd57184d50adbc87db",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12月5号的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_58359a5238c64156acfaea5f",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12月5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_58359a5238c64156acfaea5f",
    "content" : "找不到标题包含「12月5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12月5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5号的所有日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_2be26cdde77f4338ae937f6d",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_2be26cdde77f4338ae937f6d",
    "content" : "找不到标题包含「12.5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除妇联日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_bc6f05aadbee4652bbf6a9e2",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"妇联\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_bc6f05aadbee4652bbf6a9e2",
    "content" : "✅ 已删除日程：【2025-12-05】妇联换届大会 14:00"
  }, {
    "role" : "assistant",
    "content" : "✅ 已删除日程：【2025-12-05】妇联换届大会 14:00"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:11（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:11，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:11）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "我12.5号不想去妇联大会了"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_ea63b0468f714691a5833eec",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"妇联\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_ea63b0468f714691a5833eec",
    "content" : "✅ 已删除日程：【2025-12-05】妇联换届大会 14:00"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}

2025-12-02 22:11:27 [http-nio-8080-exec-8] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "user",
    "content" : "帮我删除12.5日的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_047841cd57184d50adbc87db",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_047841cd57184d50adbc87db",
    "content" : "找不到标题包含「12.5」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12月5号的日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_58359a5238c64156acfaea5f",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12月5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_58359a5238c64156acfaea5f",
    "content" : "找不到标题包含「12月5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12月5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除12.5号的所有日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_2be26cdde77f4338ae937f6d",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"12.5号\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_2be26cdde77f4338ae937f6d",
    "content" : "找不到标题包含「12.5号」的日程。"
  }, {
    "role" : "assistant",
    "content" : "未找到标题包含“12.5号”的日程，无法删除。请确认您要删除的日程标题关键词，例如“会议”、“健身”等。"
  }, {
    "role" : "user",
    "content" : "帮我删除妇联日程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_bc6f05aadbee4652bbf6a9e2",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"妇联\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_bc6f05aadbee4652bbf6a9e2",
    "content" : "✅ 已删除日程：【2025-12-05】妇联换届大会 14:00"
  }, {
    "role" : "assistant",
    "content" : "✅ 已删除日程：【2025-12-05】妇联换届大会 14:00"
  }, {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-12-02（星期二）22:11（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-12-02（星期二）22:11，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-12-02（星期二）22:11）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "我12.5号不想去妇联大会了"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_ea63b0468f714691a5833eec",
      "type" : "function",
      "function" : {
        "name" : "deleteSchedule",
        "arguments" : "{\"titleKeyword\": \"妇联\"}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_ea63b0468f714691a5833eec",
    "content" : "✅ 已删除日程：【2025-12-05】妇联换届大会 14:00"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-12-02 22:11:28 [http-nio-8080-exec-8] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-12-02 22:11:28 [http-nio-8080-exec-8] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Tue, 02 Dec 2025 14:11:28 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 383], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_769t3kxengan41ku0c]
- body: {"id":"5ef756b5cabd4ea381043f2ad8333736","object":"chat.completion","created":1764684688,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"✅ 已删除日程：【2025-12-05】妇联换届大会 14:00"},"finish_reason":"stop"}],"usage":{"prompt_tokens":2528,"completion_tokens":29,"total_tokens":2557},"system_fingerprint":""}

2025-12-02 22:11:28 [http-nio-8080-exec-8] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 内存缓存更新，当前 20 条消息
2025-12-02 22:11:28 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:11:28 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:11:28 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    update
        chat_sessions 
    set
        is_deleted=?,
        last_message_at=?,
        message_count=?,
        status=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        session_id=?
2025-12-02 22:11:28 [http-nio-8080-exec-8] INFO  c.e.s.service.AiChatService - 会话 ce67e930-c06a-4a90-b164-4c4104aba6d2 完成一轮对话，当前消息数: 22
2025-12-02 22:11:28 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:11:28 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=发送成功, data=ChatMessageResponse(sessionId=ce67e930-c06a-4a90-b164-4c410 (truncated)...]
2025-12-02 22:11:28 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:11:30 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=12", parameters={masked}
2025-12-02 22:11:30 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-12-02 22:11:30 [http-nio-8080-exec-10] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, year: 2025, month: 12
2025-12-02 22:11:30 [http-nio-8080-exec-10] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 12
2025-12-02 22:11:30 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 22:11:30 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 22:11:30 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:11:30 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=650bf50a-41dd-4c8d-8f30-6d251de2083 (truncated)...]
2025-12-02 22:11:30 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:11:40 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ai/chat/sessions", parameters={}
2025-12-02 22:11:40 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#getSessions(HttpServletRequest)
2025-12-02 22:11:40 [http-nio-8080-exec-9] INFO  c.e.s.controller.AiChatController - 【获取会话列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200
2025-12-02 22:11:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.user_id=? 
        and cs1_0.is_deleted=? 
    order by
        cs1_0.last_message_at desc,
        cs1_0.created_at desc
2025-12-02 22:11:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-12-02 22:11:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-12-02 22:11:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-12-02 22:11:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-12-02 22:11:40 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-12-02 22:11:40 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:11:40 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ChatSessionDTO(id=ce67e930-c06a-4a90-b164-4c4104aba6d2, ti (truncated)...]
2025-12-02 22:11:40 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:13:36 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=12", parameters={masked}
2025-12-02 22:13:36 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-12-02 22:13:36 [http-nio-8080-exec-2] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, year: 2025, month: 12
2025-12-02 22:13:36 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 12
2025-12-02 22:13:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 22:13:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 22:13:36 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:13:36 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=650bf50a-41dd-4c8d-8f30-6d251de2083 (truncated)...]
2025-12-02 22:13:36 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:39:59 [File Watcher] INFO  o.s.b.d.a.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 2 class path changes (2 additions, 0 deletions, 0 modifications)
2025-12-02 22:39:59 [Thread-19] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-02 22:39:59 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-02 22:39:59 [Thread-19] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:39:59 [Thread-19] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-5 - Shutdown initiated...
2025-12-02 22:39:59 [Thread-19] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-5 - Shutdown completed.
2025-12-02 22:39:59 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.7 with PID 12108 (C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server\target\classes started by 18241 in C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server)
2025-12-02 22:39:59 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-02 22:39:59 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-02 22:40:00 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 22:40:00 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-02 22:40:00 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 16 ms. Found 9 JPA repository interfaces.
2025-12-02 22:40:00 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 22:40:00 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-02 22:40:00 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:00 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:00 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:00 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:00 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:00 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:00 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:00 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:00 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:00 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-12-02 22:40:00 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-02 22:40:00 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-02 22:40:00 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-02 22:40:00 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-02 22:40:00 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 250 ms
2025-12-02 22:40:00 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-02 22:40:00 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-02 22:40:00 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-02 22:40:00 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-6 - Starting...
2025-12-02 22:40:00 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-6 - Added connection com.mysql.cj.jdbc.ConnectionImpl@634855bb
2025-12-02 22:40:00 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-6 - Start completed.
2025-12-02 22:40:00 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-02 22:40:00 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-12-02 22:40:00 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-6)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-02 22:40:00 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-02 22:40:00 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:40:00 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 22:40:00 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-12-02 22:40:00 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-12-02 22:40:00 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-12-02 22:40:00 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-12-02 22:40:00 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-12-02 22:40:00 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 22:40:00 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-12-02 22:40:00 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-12-02 22:40:00 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-02 22:40:00 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 27 mappings in 'requestMappingHandlerMapping'
2025-12-02 22:40:00 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-02 22:40:00 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-02 22:40:00 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-02 22:40:00 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-12-02 22:40:00 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-02 22:40:00 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 0.607 seconds (process running for 3844.789)
2025-12-02 22:40:00 [restartedMain] INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener - Condition evaluation unchanged
2025-12-02 22:40:18 [File Watcher] INFO  o.s.b.d.a.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 2 class path changes (0 additions, 0 deletions, 2 modifications)
2025-12-02 22:40:18 [Thread-23] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-02 22:40:18 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-02 22:40:18 [Thread-23] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:40:18 [Thread-23] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-6 - Shutdown initiated...
2025-12-02 22:40:18 [Thread-23] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-6 - Shutdown completed.
2025-12-02 22:40:18 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.7 with PID 12108 (C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server\target\classes started by 18241 in C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server)
2025-12-02 22:40:18 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-02 22:40:18 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-02 22:40:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 22:40:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-02 22:40:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 9 JPA repository interfaces.
2025-12-02 22:40:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 22:40:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-02 22:40:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-12-02 22:40:18 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-02 22:40:18 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-02 22:40:18 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-02 22:40:18 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-02 22:40:18 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 200 ms
2025-12-02 22:40:18 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-02 22:40:18 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-02 22:40:18 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-02 22:40:18 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-7 - Starting...
2025-12-02 22:40:18 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-7 - Added connection com.mysql.cj.jdbc.ConnectionImpl@52df6418
2025-12-02 22:40:18 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-7 - Start completed.
2025-12-02 22:40:18 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-02 22:40:18 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-12-02 22:40:18 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-7)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-02 22:40:18 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-02 22:40:18 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:40:18 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 22:40:18 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-12-02 22:40:18 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-12-02 22:40:18 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-12-02 22:40:18 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-12-02 22:40:18 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-12-02 22:40:18 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 22:40:18 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-12-02 22:40:18 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-12-02 22:40:18 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-02 22:40:18 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 27 mappings in 'requestMappingHandlerMapping'
2025-12-02 22:40:18 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-02 22:40:18 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-02 22:40:18 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-02 22:40:18 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-12-02 22:40:18 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-02 22:40:18 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 0.522 seconds (process running for 3863.221)
2025-12-02 22:40:18 [restartedMain] INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener - Condition evaluation unchanged
2025-12-02 22:40:37 [File Watcher] INFO  o.s.b.d.a.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 1 class path change (0 additions, 0 deletions, 1 modification)
2025-12-02 22:40:37 [Thread-27] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-02 22:40:37 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-02 22:40:37 [Thread-27] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:40:37 [Thread-27] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-7 - Shutdown initiated...
2025-12-02 22:40:37 [Thread-27] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-7 - Shutdown completed.
2025-12-02 22:40:37 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.7 with PID 12108 (C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server\target\classes started by 18241 in C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server)
2025-12-02 22:40:37 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-02 22:40:37 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-02 22:40:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 22:40:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-02 22:40:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 9 JPA repository interfaces.
2025-12-02 22:40:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 22:40:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-02 22:40:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:40:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-12-02 22:40:38 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-02 22:40:38 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-02 22:40:38 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-02 22:40:38 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-02 22:40:38 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 195 ms
2025-12-02 22:40:38 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-02 22:40:38 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-02 22:40:38 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-02 22:40:38 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-8 - Starting...
2025-12-02 22:40:38 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-8 - Added connection com.mysql.cj.jdbc.ConnectionImpl@292bddde
2025-12-02 22:40:38 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-8 - Start completed.
2025-12-02 22:40:38 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-02 22:40:38 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-12-02 22:40:38 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-8)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-02 22:40:38 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-02 22:40:38 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:40:38 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 22:40:38 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-12-02 22:40:38 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-12-02 22:40:38 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-12-02 22:40:38 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-12-02 22:40:38 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-12-02 22:40:38 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 22:40:38 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-12-02 22:40:38 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-12-02 22:40:38 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-02 22:40:38 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 29 mappings in 'requestMappingHandlerMapping'
2025-12-02 22:40:38 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-02 22:40:38 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-02 22:40:38 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-02 22:40:38 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-12-02 22:40:38 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-02 22:40:38 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 0.482 seconds (process running for 3882.634)
2025-12-02 22:40:38 [restartedMain] INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener - Condition evaluation unchanged
2025-12-02 22:41:59 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-02 22:41:59 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-02 22:41:59 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:41:59 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-8 - Shutdown initiated...
2025-12-02 22:41:59 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-8 - Shutdown completed.
2025-12-02 22:42:03 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.7 with PID 27368 (C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server\target\classes started by 18241 in C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server)
2025-12-02 22:42:03 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-02 22:42:03 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-02 22:42:03 [restartedMain] INFO  o.s.b.d.restart.ChangeableUrls - The Class-Path manifest attribute in C:\Users\18241\.m2\repository\org\apache\opennlp\opennlp-tools\2.5.4\opennlp-tools-2.5.4.jar referenced one or more files that do not exist: file:/C:/Users/18241/.m2/repository/org/apache/opennlp/opennlp-tools/2.5.4/slf4j-api-2.0.17.jar
2025-12-02 22:42:03 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-12-02 22:42:03 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-12-02 22:42:04 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 22:42:04 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-02 22:42:04 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 108 ms. Found 9 JPA repository interfaces.
2025-12-02 22:42:04 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 22:42:04 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-02 22:42:04 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:42:04 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:42:04 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:42:04 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:42:04 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:42:04 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:42:04 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:42:04 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:42:04 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:42:04 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-12-02 22:42:05 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-02 22:42:05 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-02 22:42:05 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-02 22:42:05 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-02 22:42:05 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1394 ms
2025-12-02 22:42:05 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-02 22:42:05 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-12-02 22:42:05 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-02 22:42:05 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-02 22:42:05 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-12-02 22:42:05 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@35bc8da6
2025-12-02 22:42:05 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-12-02 22:42:05 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-02 22:42:05 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-12-02 22:42:05 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-02 22:42:06 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-02 22:42:06 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:42:07 [restartedMain] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-12-02 22:42:08 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 22:42:08 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-12-02 22:42:08 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-12-02 22:42:08 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-12-02 22:42:08 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-12-02 22:42:08 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-12-02 22:42:08 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 22:42:08 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-12-02 22:42:08 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-12-02 22:42:08 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-02 22:42:08 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 29 mappings in 'requestMappingHandlerMapping'
2025-12-02 22:42:08 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-02 22:42:08 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-02 22:42:08 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-02 22:42:09 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-12-02 22:42:09 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-02 22:42:09 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 5.644 seconds (process running for 6.221)
2025-12-02 22:42:13 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-02 22:42:13 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-02 22:42:13 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-12-02 22:42:13 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-12-02 22:42:13 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-12-02 22:42:13 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@3fbfe391
2025-12-02 22:42:13 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@372bfe83
2025-12-02 22:42:13 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-12-02 22:42:13 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-02 22:42:13 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=12", parameters={masked}
2025-12-02 22:42:13 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-12-02 22:42:13 [http-nio-8080-exec-1] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: c6d84871-f654-45f4-b11b-2a8412b6b200, year: 2025, month: 12
2025-12-02 22:42:13 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: c6d84871-f654-45f4-b11b-2a8412b6b200, 年: 2025, 月: 12
2025-12-02 22:42:13 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-12-02 22:42:13 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.group_id,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.is_deleted=0 
        and s1_0.schedule_date between ? and ? 
        and (
            (
                s1_0.group_id is null 
                and s1_0.user_id=?
            ) 
            or (
                s1_0.group_id is not null 
                and 1=0
            )
        ) 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-12-02 22:42:13 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:42:13 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=650bf50a-41dd-4c8d-8f30-6d251de2083 (truncated)...]
2025-12-02 22:42:13 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:42:36 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/login", parameters={}
2025-12-02 22:42:36 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#login(PasswordLoginRequest, HttpServletRequest)
2025-12-02 22:42:36 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PasswordLoginRequest(phone=19818039183, password=123456)]
2025-12-02 22:42:36 [http-nio-8080-exec-5] INFO  c.e.s.controller.AuthController - 【密码登录】手机号: 19818039183
2025-12-02 22:42:36 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-12-02 22:42:36 [http-nio-8080-exec-5] WARN  c.e.s.controller.AuthController - 【登录失败】密码错误
2025-12-02 22:42:36 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:42:36 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=密码错误, data=null)]
2025-12-02 22:42:36 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:43:01 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/register", parameters={}
2025-12-02 22:43:01 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#register(RegisterRequest)
2025-12-02 22:43:01 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [RegisterRequest(phone=19818039183, password=123456)]
2025-12-02 22:43:01 [http-nio-8080-exec-3] INFO  c.e.s.controller.AuthController - 【注册】手机号: 19818039183
2025-12-02 22:43:01 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-12-02 22:43:01 [http-nio-8080-exec-3] WARN  c.e.s.controller.AuthController - 【注册失败】该手机号已注册
2025-12-02 22:43:01 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:43:01 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=该手机号已注册, data=null)]
2025-12-02 22:43:01 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:43:32 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/register", parameters={}
2025-12-02 22:43:32 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#register(RegisterRequest)
2025-12-02 22:43:32 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [RegisterRequest(phone=15158587505, password=123456)]
2025-12-02 22:43:32 [http-nio-8080-exec-4] INFO  c.e.s.controller.AuthController - 【注册】手机号: 15158587505
2025-12-02 22:43:32 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-12-02 22:43:32 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-12-02 22:43:32 [http-nio-8080-exec-4] INFO  c.e.s.service.AuthService - 【注册成功】手机号: 15158587505, userId: 924424c0-1fb7-41d8-9369-45100045e0cb
2025-12-02 22:43:32 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (avatar, bio, birthday, created_at, email, gender, is_deleted, last_login_ip, last_login_time, login_type, password, phone, status, updated_at, username, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:43:32 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:43:32 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=注册成功, data=null)]
2025-12-02 22:43:32 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:44:40 [File Watcher] INFO  o.s.b.d.a.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 1 class path change (0 additions, 0 deletions, 1 modification)
2025-12-02 22:44:40 [Thread-5] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-02 22:44:40 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-02 22:44:40 [Thread-5] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:44:40 [Thread-5] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-12-02 22:44:40 [Thread-5] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-12-02 22:44:40 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.7 with PID 27368 (C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server\target\classes started by 18241 in C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server)
2025-12-02 22:44:40 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-02 22:44:40 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-02 22:44:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 22:44:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-02 22:44:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 19 ms. Found 9 JPA repository interfaces.
2025-12-02 22:44:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 22:44:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-02 22:44:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:44:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:44:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:44:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:44:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:44:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:44:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:44:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:44:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:44:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-12-02 22:44:40 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-02 22:44:40 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-02 22:44:40 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-02 22:44:40 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-02 22:44:40 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 292 ms
2025-12-02 22:44:40 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-02 22:44:40 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-02 22:44:40 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-02 22:44:40 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Starting...
2025-12-02 22:44:40 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-2 - Added connection com.mysql.cj.jdbc.ConnectionImpl@724883fd
2025-12-02 22:44:40 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Start completed.
2025-12-02 22:44:40 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-02 22:44:40 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-12-02 22:44:40 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-2)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-02 22:44:40 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-02 22:44:40 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:44:40 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 22:44:40 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-12-02 22:44:40 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-12-02 22:44:40 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-12-02 22:44:40 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-12-02 22:44:40 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-12-02 22:44:40 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 22:44:40 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-12-02 22:44:40 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-12-02 22:44:40 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-02 22:44:40 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 29 mappings in 'requestMappingHandlerMapping'
2025-12-02 22:44:40 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-02 22:44:40 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-02 22:44:40 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-02 22:44:40 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-12-02 22:44:40 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-02 22:44:40 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 0.679 seconds (process running for 158.169)
2025-12-02 22:44:41 [restartedMain] INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener - Condition evaluation unchanged
2025-12-02 22:45:18 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-02 22:45:18 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-02 22:45:18 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-12-02 22:45:18 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-12-02 22:45:18 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-12-02 22:45:18 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@461949ab
2025-12-02 22:45:18 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@6748d5f
2025-12-02 22:45:18 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-12-02 22:45:18 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-02 22:45:18 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/register", parameters={}
2025-12-02 22:45:18 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#register(RegisterRequest)
2025-12-02 22:45:18 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [RegisterRequest(phone=15158587505, password=123456)]
2025-12-02 22:45:18 [http-nio-8080-exec-2] INFO  c.e.s.controller.AuthController - 【注册】手机号: 15158587505
2025-12-02 22:45:18 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-12-02 22:45:18 [http-nio-8080-exec-2] WARN  c.e.s.controller.AuthController - 【注册失败】该手机号已注册
2025-12-02 22:45:18 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:45:18 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=该手机号已注册, data=null)]
2025-12-02 22:45:18 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:45:18 [File Watcher] INFO  o.s.b.d.a.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 1 class path change (0 additions, 0 deletions, 1 modification)
2025-12-02 22:45:18 [Thread-7] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-02 22:45:18 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-02 22:45:18 [Thread-7] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:45:18 [Thread-7] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown initiated...
2025-12-02 22:45:18 [Thread-7] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown completed.
2025-12-02 22:45:18 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.7 with PID 27368 (C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server\target\classes started by 18241 in C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server)
2025-12-02 22:45:18 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-02 22:45:18 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-02 22:45:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 22:45:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-02 22:45:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 9 JPA repository interfaces.
2025-12-02 22:45:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 22:45:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-02 22:45:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-12-02 22:45:18 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-02 22:45:18 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-02 22:45:18 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-02 22:45:18 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-02 22:45:18 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 195 ms
2025-12-02 22:45:18 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-02 22:45:18 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-02 22:45:18 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-02 22:45:18 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Starting...
2025-12-02 22:45:18 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-3 - Added connection com.mysql.cj.jdbc.ConnectionImpl@6e7bfaf1
2025-12-02 22:45:18 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Start completed.
2025-12-02 22:45:18 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-02 22:45:18 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-12-02 22:45:18 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-3)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-02 22:45:18 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-02 22:45:18 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:45:18 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 22:45:18 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-12-02 22:45:18 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-12-02 22:45:18 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-12-02 22:45:18 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-12-02 22:45:18 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-12-02 22:45:18 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 22:45:18 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-12-02 22:45:18 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-12-02 22:45:18 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-02 22:45:18 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 29 mappings in 'requestMappingHandlerMapping'
2025-12-02 22:45:18 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-02 22:45:18 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-02 22:45:18 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-02 22:45:18 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-12-02 22:45:18 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-02 22:45:18 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 0.554 seconds (process running for 196.145)
2025-12-02 22:45:18 [restartedMain] INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener - Condition evaluation unchanged
2025-12-02 22:45:28 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-02 22:45:28 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-02 22:45:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-12-02 22:45:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-12-02 22:45:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-12-02 22:45:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@1f5faea0
2025-12-02 22:45:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@3bba1184
2025-12-02 22:45:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-12-02 22:45:28 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-02 22:45:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/register", parameters={}
2025-12-02 22:45:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#register(RegisterRequest)
2025-12-02 22:45:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [RegisterRequest(phone=15158587505, password=123456)]
2025-12-02 22:45:28 [http-nio-8080-exec-1] INFO  c.e.s.controller.AuthController - 【注册】手机号: 15158587505
2025-12-02 22:45:28 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-12-02 22:45:28 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-12-02 22:45:28 [http-nio-8080-exec-1] INFO  c.e.s.service.AuthService - 【注册成功】手机号: 15158587505, userId: bcc2ddf4-19fe-4913-8069-6e85c26c2c3c
2025-12-02 22:45:28 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (avatar, bio, birthday, created_at, email, gender, is_deleted, last_login_ip, last_login_time, login_type, password, phone, status, updated_at, username, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:45:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:45:28 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=注册成功, data=ok)]
2025-12-02 22:45:28 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:45:33 [File Watcher] INFO  o.s.b.d.a.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 1 class path change (0 additions, 1 deletion, 0 modifications)
2025-12-02 22:45:33 [Thread-11] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-02 22:45:33 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-02 22:45:33 [Thread-11] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:45:33 [Thread-11] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Shutdown initiated...
2025-12-02 22:45:33 [Thread-11] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Shutdown completed.
2025-12-02 22:45:33 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.7 with PID 27368 (C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server\target\classes started by 18241 in C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server)
2025-12-02 22:45:33 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-02 22:45:33 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-02 22:45:33 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 22:45:33 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-02 22:45:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 9 JPA repository interfaces.
2025-12-02 22:45:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 22:45:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-02 22:45:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-12-02 22:45:34 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-02 22:45:34 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-02 22:45:34 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-02 22:45:34 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-02 22:45:34 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 230 ms
2025-12-02 22:45:34 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-02 22:45:34 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-02 22:45:34 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-02 22:45:34 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-4 - Starting...
2025-12-02 22:45:34 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-4 - Added connection com.mysql.cj.jdbc.ConnectionImpl@69530525
2025-12-02 22:45:34 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-4 - Start completed.
2025-12-02 22:45:34 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-02 22:45:34 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-12-02 22:45:34 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-4)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-02 22:45:34 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-02 22:45:34 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:45:34 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 22:45:34 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-12-02 22:45:34 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-12-02 22:45:34 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-12-02 22:45:34 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-12-02 22:45:34 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-12-02 22:45:34 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 22:45:34 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-12-02 22:45:34 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-12-02 22:45:34 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-02 22:45:34 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 29 mappings in 'requestMappingHandlerMapping'
2025-12-02 22:45:34 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-02 22:45:34 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-02 22:45:34 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-02 22:45:34 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-12-02 22:45:34 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-02 22:45:34 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 0.571 seconds (process running for 211.589)
2025-12-02 22:45:34 [restartedMain] INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener - Condition evaluation unchanged
2025-12-02 22:45:35 [File Watcher] INFO  o.s.b.d.a.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 1 class path change (1 addition, 0 deletions, 0 modifications)
2025-12-02 22:45:35 [Thread-15] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-02 22:45:35 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-02 22:45:35 [Thread-15] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:45:35 [Thread-15] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-4 - Shutdown initiated...
2025-12-02 22:45:35 [Thread-15] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-4 - Shutdown completed.
2025-12-02 22:45:35 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.7 with PID 27368 (C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server\target\classes started by 18241 in C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server)
2025-12-02 22:45:35 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-02 22:45:35 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-02 22:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 22:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-02 22:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 9 JPA repository interfaces.
2025-12-02 22:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 22:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-02 22:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:45:36 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-12-02 22:45:36 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-02 22:45:36 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-02 22:45:36 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-02 22:45:36 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-02 22:45:36 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 190 ms
2025-12-02 22:45:36 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-02 22:45:36 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-02 22:45:36 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-02 22:45:36 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-5 - Starting...
2025-12-02 22:45:36 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-5 - Added connection com.mysql.cj.jdbc.ConnectionImpl@755d6092
2025-12-02 22:45:36 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-5 - Start completed.
2025-12-02 22:45:36 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-02 22:45:36 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-12-02 22:45:36 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-5)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-02 22:45:36 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-02 22:45:36 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:45:36 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 22:45:36 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-12-02 22:45:36 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-12-02 22:45:36 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-12-02 22:45:36 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-12-02 22:45:36 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-12-02 22:45:36 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 22:45:36 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-12-02 22:45:36 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-12-02 22:45:36 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-02 22:45:36 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 29 mappings in 'requestMappingHandlerMapping'
2025-12-02 22:45:36 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-02 22:45:36 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-02 22:45:36 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-02 22:45:36 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-12-02 22:45:36 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-02 22:45:36 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 0.523 seconds (process running for 213.616)
2025-12-02 22:45:36 [restartedMain] INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener - Condition evaluation unchanged
2025-12-02 22:45:39 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-02 22:45:39 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-02 22:45:39 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-12-02 22:45:39 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-12-02 22:45:39 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-12-02 22:45:39 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@6ea37205
2025-12-02 22:45:39 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@2d47a25c
2025-12-02 22:45:39 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-12-02 22:45:39 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-12-02 22:45:39 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/register", parameters={}
2025-12-02 22:45:39 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#register(RegisterRequest)
2025-12-02 22:45:39 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [RegisterRequest(phone=15158587505, password=123456)]
2025-12-02 22:45:39 [http-nio-8080-exec-1] INFO  c.e.s.controller.AuthController - 【注册】手机号: 15158587505
2025-12-02 22:45:39 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-12-02 22:45:39 [http-nio-8080-exec-1] WARN  c.e.s.controller.AuthController - 【注册失败】该手机号已注册
2025-12-02 22:45:39 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:45:39 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=该手机号已注册, data=null)]
2025-12-02 22:45:39 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:45:46 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/register", parameters={}
2025-12-02 22:45:46 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#register(RegisterRequest)
2025-12-02 22:45:46 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [RegisterRequest(phone=15158587505, password=123456)]
2025-12-02 22:45:46 [http-nio-8080-exec-3] INFO  c.e.s.controller.AuthController - 【注册】手机号: 15158587505
2025-12-02 22:45:46 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-12-02 22:45:46 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-12-02 22:45:46 [http-nio-8080-exec-3] INFO  c.e.s.service.AuthService - 【注册成功】手机号: 15158587505, userId: 62db937a-0535-4404-8261-1bbf7eb27216
2025-12-02 22:45:46 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (avatar, bio, birthday, created_at, email, gender, is_deleted, last_login_ip, last_login_time, login_type, password, phone, status, updated_at, username, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:45:46 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:45:46 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=注册成功, data=ok)]
2025-12-02 22:45:46 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:46:10 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/register", parameters={}
2025-12-02 22:46:10 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#register(RegisterRequest)
2025-12-02 22:46:10 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [RegisterRequest(phone=15158587505, password=123456)]
2025-12-02 22:46:10 [http-nio-8080-exec-6] INFO  c.e.s.controller.AuthController - 【注册】手机号: 15158587505
2025-12-02 22:46:10 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-12-02 22:46:10 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-12-02 22:46:10 [http-nio-8080-exec-6] INFO  c.e.s.service.AuthService - 【注册成功】手机号: 15158587505, userId: d499a53b-4da4-42e7-9209-73b729cae647
2025-12-02 22:46:10 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (avatar, bio, birthday, created_at, email, gender, is_deleted, last_login_ip, last_login_time, login_type, password, phone, status, updated_at, username, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-12-02 22:46:10 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-12-02 22:46:10 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=注册成功, data=ok)]
2025-12-02 22:46:10 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-02 22:50:35 [File Watcher] INFO  o.s.b.d.a.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 2 class path changes (0 additions, 0 deletions, 2 modifications)
2025-12-02 22:50:35 [Thread-19] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-02 22:50:35 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-02 22:50:35 [Thread-19] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:50:35 [Thread-19] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-5 - Shutdown initiated...
2025-12-02 22:50:35 [Thread-19] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-5 - Shutdown completed.
2025-12-02 22:50:35 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.7 with PID 27368 (C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server\target\classes started by 18241 in C:\Users\18241\Desktop\SpeedCalendar-server\SpeedCalendar-server)
2025-12-02 22:50:35 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-02 22:50:35 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-02 22:50:35 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 22:50:35 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-02 22:50:35 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 9 JPA repository interfaces.
2025-12-02 22:50:35 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-02 22:50:35 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-02 22:50:35 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:50:35 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:50:35 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:50:35 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:50:35 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:50:35 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:50:35 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:50:35 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:50:35 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-12-02 22:50:35 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 2 ms. Found 0 Redis repository interfaces.
2025-12-02 22:50:35 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-02 22:50:35 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-02 22:50:35 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-02 22:50:35 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-02 22:50:35 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 212 ms
2025-12-02 22:50:35 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-02 22:50:35 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-12-02 22:50:35 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-02 22:50:35 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-6 - Starting...
2025-12-02 22:50:35 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-6 - Added connection com.mysql.cj.jdbc.ConnectionImpl@52fa7d3a
2025-12-02 22:50:35 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-6 - Start completed.
2025-12-02 22:50:35 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-12-02 22:50:35 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-12-02 22:50:35 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-6)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-12-02 22:50:35 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-02 22:50:35 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:50:35 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 22:50:35 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-12-02 22:50:35 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-12-02 22:50:35 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-12-02 22:50:35 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-12-02 22:50:35 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-12-02 22:50:35 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-12-02 22:50:35 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-12-02 22:50:35 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-12-02 22:50:35 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-02 22:50:35 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 29 mappings in 'requestMappingHandlerMapping'
2025-12-02 22:50:35 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-02 22:50:35 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-02 22:50:35 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-02 22:50:35 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-12-02 22:50:35 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-02 22:50:35 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 0.524 seconds (process running for 513.097)
2025-12-02 22:50:35 [restartedMain] INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener - Condition evaluation unchanged
2025-12-02 22:51:00 [File Watcher] INFO  o.s.b.d.a.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 2 class path changes (0 additions, 0 deletions, 2 modifications)
2025-12-02 22:51:00 [Thread-23] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-02 22:51:00 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-02 22:51:00 [Thread-23] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-12-02 22:51:00 [Thread-23] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-6 - Shutdown initiated...
2025-12-02 22:51:00 [Thread-23] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-6 - Shutdown completed.
