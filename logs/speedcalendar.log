2025-11-28 00:01:30 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-28 00:01:30 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-28 00:01:30 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-11-28 00:01:30 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-11-28 00:01:30 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-11-28 00:01:30 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@5a203c0a
2025-11-28 00:01:30 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@2937f1bf
2025-11-28 00:01:30 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-11-28 00:01:30 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-11-28 00:01:30 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/code", parameters={}
2025-11-28 00:01:30 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#sendCode(SendCodeRequest, HttpServletRequest)
2025-11-28 00:01:30 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [SendCodeRequest(phone=18006569106)]
2025-11-28 00:01:30 [http-nio-8080-exec-2] INFO  c.e.s.controller.AuthController - 【发送验证码】手机号: 18006569106, IP: 192.168.43.1
2025-11-28 00:01:30 [http-nio-8080-exec-2] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-28 00:01:31 [http-nio-8080-exec-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1045, SQLState: 28000
2025-11-28 00:01:31 [http-nio-8080-exec-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Access denied for user 'root'@'localhost' (using password: YES)
2025-11-28 00:01:31 [http-nio-8080-exec-2] ERROR c.e.s.controller.AuthController - 【发送验证码失败】Could not open JPA EntityManager for transaction
2025-11-28 00:01:31 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:01:31 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=Could not open JPA EntityManager for transaction, data=null)]
2025-11-28 00:01:31 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:01:37 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/code", parameters={}
2025-11-28 00:01:37 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#sendCode(SendCodeRequest, HttpServletRequest)
2025-11-28 00:01:37 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [SendCodeRequest(phone=18006569106)]
2025-11-28 00:01:37 [http-nio-8080-exec-3] INFO  c.e.s.controller.AuthController - 【发送验证码】手机号: 18006569106, IP: 192.168.43.1
2025-11-28 00:01:37 [http-nio-8080-exec-3] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-28 00:01:38 [http-nio-8080-exec-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1045, SQLState: 28000
2025-11-28 00:01:38 [http-nio-8080-exec-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Access denied for user 'root'@'localhost' (using password: YES)
2025-11-28 00:01:38 [http-nio-8080-exec-3] ERROR c.e.s.controller.AuthController - 【发送验证码失败】Could not open JPA EntityManager for transaction
2025-11-28 00:01:38 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:01:38 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=Could not open JPA EntityManager for transaction, data=null)]
2025-11-28 00:01:38 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:01:49 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/code", parameters={}
2025-11-28 00:01:49 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#sendCode(SendCodeRequest, HttpServletRequest)
2025-11-28 00:01:49 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [SendCodeRequest(phone=18006569106)]
2025-11-28 00:01:49 [http-nio-8080-exec-1] INFO  c.e.s.controller.AuthController - 【发送验证码】手机号: 18006569106, IP: 192.168.43.1
2025-11-28 00:01:49 [http-nio-8080-exec-1] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-28 00:01:50 [http-nio-8080-exec-1] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1045, SQLState: 28000
2025-11-28 00:01:50 [http-nio-8080-exec-1] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Access denied for user 'root'@'localhost' (using password: YES)
2025-11-28 00:01:50 [http-nio-8080-exec-1] ERROR c.e.s.controller.AuthController - 【发送验证码失败】Could not open JPA EntityManager for transaction
2025-11-28 00:01:50 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:01:50 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=Could not open JPA EntityManager for transaction, data=null)]
2025-11-28 00:01:50 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:01:53 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-28 00:01:53 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-28 00:01:53 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 00:01:56 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.8 with PID 11168 (E:\develop\Android Studio\workspace\SpeedCalendar-server\target\classes started by jiang in E:\develop\Android Studio\workspace\SpeedCalendar-server)
2025-11-28 00:01:56 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-28 00:01:56 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-28 00:01:56 [restartedMain] INFO  o.s.b.d.restart.ChangeableUrls - The Class-Path manifest attribute in C:\Users\jiang\.m2\repository\org\apache\opennlp\opennlp-tools\2.5.4\opennlp-tools-2.5.4.jar referenced one or more files that do not exist: file:/C:/Users/jiang/.m2/repository/org/apache/opennlp/opennlp-tools/2.5.4/slf4j-api-2.0.17.jar
2025-11-28 00:01:56 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-28 00:01:56 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-28 00:01:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 00:01:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-28 00:01:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 134 ms. Found 7 JPA repository interfaces.
2025-11-28 00:01:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 00:01:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-28 00:01:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:01:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:01:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:01:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:01:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:01:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:01:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:01:57 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-11-28 00:01:58 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-28 00:01:58 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-28 00:01:58 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-28 00:01:58 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-28 00:01:58 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1574 ms
2025-11-28 00:01:58 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-28 00:01:58 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-28 00:01:58 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-28 00:01:58 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-28 00:01:58 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-28 00:02:00 [restartedMain] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1045, SQLState: 28000
2025-11-28 00:02:00 [restartedMain] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Access denied for user 'root'@'localhost' (using password: YES)
2025-11-28 00:02:00 [restartedMain] WARN  o.h.e.j.e.i.JdbcEnvironmentInitiator - HHH000342: Could not obtain connection to query metadata
org.hibernate.exception.GenericJDBCException: unable to obtain isolated JDBC connection [Access denied for user 'root'@'localhost' (using password: YES)] [n/a]
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:63)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcIsolationDelegate.delegateWork(JdbcIsolationDelegate.java:116)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.getJdbcEnvironmentUsingJdbcMetadata(JdbcEnvironmentInitiator.java:334)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:129)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:81)
	at org.hibernate.boot.registry.internal.StandardServiceRegistryImpl.initiateService(StandardServiceRegistryImpl.java:130)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.createService(AbstractServiceRegistryImpl.java:263)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:238)
	at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:215)
	at org.hibernate.boot.model.relational.Database.<init>(Database.java:45)
	at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.getDatabase(InFlightMetadataCollectorImpl.java:226)
	at org.hibernate.boot.internal.InFlightMetadataCollectorImpl.<init>(InFlightMetadataCollectorImpl.java:194)
	at org.hibernate.boot.model.process.spi.MetadataBuildingProcess.complete(MetadataBuildingProcess.java:171)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.metadata(EntityManagerFactoryBuilderImpl.java:1442)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1513)
	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)
	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1873)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1822)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:373)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:973)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at com.example.speedcalendarserver.SpeedCalendarServerApplication.main(SpeedCalendarServerApplication.java:10)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:50)
Caused by: java.sql.SQLException: Access denied for user 'root'@'localhost' (using password: YES)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:121)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:839)
	at com.mysql.cj.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:415)
	at com.mysql.cj.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:237)
	at com.mysql.cj.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:180)
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:144)
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:370)
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:207)
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:488)
	at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:576)
	at com.zaxxer.hikari.pool.HikariPool.<init>(HikariPool.java:97)
	at com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:111)
	at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.getConnection(DatasourceConnectionProviderImpl.java:126)
	at org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$ConnectionProviderJdbcConnectionAccess.obtainConnection(JdbcEnvironmentInitiator.java:485)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcIsolationDelegate.delegateWork(JdbcIsolationDelegate.java:61)
	... 38 common frames omitted
2025-11-28 00:02:00 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-28 00:02:00 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-11-28 00:02:00 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (null)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-28 00:02:01 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-28 00:02:01 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 00:02:01 [restartedMain] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-28 00:02:02 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 00:02:02 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-11-28 00:02:02 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-11-28 00:02:02 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-11-28 00:02:02 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-11-28 00:02:02 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-11-28 00:02:02 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 00:02:02 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-11-28 00:02:02 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-11-28 00:02:02 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-28 00:02:02 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 23 mappings in 'requestMappingHandlerMapping'
2025-11-28 00:02:02 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-11-28 00:02:02 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-11-28 00:02:02 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-11-28 00:02:03 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-28 00:02:03 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-28 00:02:03 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 6.997 seconds (process running for 7.888)
2025-11-28 00:02:08 [http-nio-8080-exec-2] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-28 00:02:08 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-28 00:02:08 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-11-28 00:02:08 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-11-28 00:02:08 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-11-28 00:02:08 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@4b0c0584
2025-11-28 00:02:08 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@50a84409
2025-11-28 00:02:08 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-11-28 00:02:08 [http-nio-8080-exec-2] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-28 00:02:08 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/code", parameters={}
2025-11-28 00:02:08 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#sendCode(SendCodeRequest, HttpServletRequest)
2025-11-28 00:02:09 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [SendCodeRequest(phone=18006569106)]
2025-11-28 00:02:09 [http-nio-8080-exec-2] INFO  c.e.s.controller.AuthController - 【发送验证码】手机号: 18006569106, IP: 192.168.43.1
2025-11-28 00:02:09 [http-nio-8080-exec-2] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-28 00:02:10 [http-nio-8080-exec-2] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1045, SQLState: 28000
2025-11-28 00:02:10 [http-nio-8080-exec-2] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Access denied for user 'root'@'localhost' (using password: YES)
2025-11-28 00:02:10 [http-nio-8080-exec-2] ERROR c.e.s.controller.AuthController - 【发送验证码失败】Could not open JPA EntityManager for transaction
2025-11-28 00:02:10 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:02:10 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=Could not open JPA EntityManager for transaction, data=null)]
2025-11-28 00:02:10 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:06:31 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-28 00:06:31 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-28 00:06:31 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 00:06:33 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.8 with PID 24868 (E:\develop\Android Studio\workspace\SpeedCalendar-server\target\classes started by jiang in E:\develop\Android Studio\workspace\SpeedCalendar-server)
2025-11-28 00:06:33 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-28 00:06:33 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-28 00:06:33 [restartedMain] INFO  o.s.b.d.restart.ChangeableUrls - The Class-Path manifest attribute in C:\Users\jiang\.m2\repository\org\apache\opennlp\opennlp-tools\2.5.4\opennlp-tools-2.5.4.jar referenced one or more files that do not exist: file:/C:/Users/jiang/.m2/repository/org/apache/opennlp/opennlp-tools/2.5.4/slf4j-api-2.0.17.jar
2025-11-28 00:06:33 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-28 00:06:33 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-28 00:06:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 00:06:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-28 00:06:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 106 ms. Found 7 JPA repository interfaces.
2025-11-28 00:06:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 00:06:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-28 00:06:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:06:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:06:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:06:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:06:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:06:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:06:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:06:34 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 6 ms. Found 0 Redis repository interfaces.
2025-11-28 00:06:34 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-28 00:06:34 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-28 00:06:34 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-28 00:06:34 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-28 00:06:34 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1205 ms
2025-11-28 00:06:34 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-28 00:06:35 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-28 00:06:35 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-28 00:06:35 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-28 00:06:35 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-28 00:06:35 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@7bc6d5e0
2025-11-28 00:06:35 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-28 00:06:35 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-28 00:06:35 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-11-28 00:06:35 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-28 00:06:36 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-28 00:06:36 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 00:06:36 [restartedMain] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-28 00:06:36 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 00:06:36 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-11-28 00:06:36 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-11-28 00:06:36 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-11-28 00:06:36 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-11-28 00:06:36 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-11-28 00:06:36 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 00:06:37 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-11-28 00:06:37 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-11-28 00:06:37 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-28 00:06:37 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 23 mappings in 'requestMappingHandlerMapping'
2025-11-28 00:06:37 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-11-28 00:06:37 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-11-28 00:06:37 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-11-28 00:06:37 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-28 00:06:37 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-28 00:06:37 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 4.549 seconds (process running for 5.249)
2025-11-28 00:06:50 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-28 00:06:50 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-28 00:06:50 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-11-28 00:06:50 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-11-28 00:06:50 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-11-28 00:06:50 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@164c092b
2025-11-28 00:06:50 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@46840c65
2025-11-28 00:06:50 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-11-28 00:06:50 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-11-28 00:06:50 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/code", parameters={}
2025-11-28 00:06:50 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#sendCode(SendCodeRequest, HttpServletRequest)
2025-11-28 00:06:50 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [SendCodeRequest(phone=18006569106)]
2025-11-28 00:06:50 [http-nio-8080-exec-1] INFO  c.e.s.controller.AuthController - 【发送验证码】手机号: 18006569106, IP: 192.168.43.1
2025-11-28 00:06:50 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-28 00:06:50 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        count(vc1_0.id) 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.created_at>?
2025-11-28 00:06:50 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.expires_at<? 
        and vc1_0.status=?
2025-11-28 00:06:50 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    insert 
    into
        verification_codes
        (code, created_at, expires_at, ip_address, phone, status, type, used_at) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:06:50 [http-nio-8080-exec-1] INFO  c.e.s.service.AuthService - 【验证码】手机号: 18006569106, 验证码: 382973, 有效期: 300秒
2025-11-28 00:06:50 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:06:50 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=验证码发送成功, data=null)]
2025-11-28 00:06:50 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:06:59 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/login/phone", parameters={}
2025-11-28 00:06:59 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#phoneLogin(PhoneLoginRequest, HttpServletRequest)
2025-11-28 00:06:59 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PhoneLoginRequest(phone=18006569106, code=382973)]
2025-11-28 00:06:59 [http-nio-8080-exec-2] INFO  c.e.s.controller.AuthController - 【手机号登录】手机号: 18006569106, IP: 192.168.43.1
2025-11-28 00:06:59 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.code=? 
        and vc1_0.type=? 
        and vc1_0.status=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-28 00:06:59 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-11-28 00:06:59 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-11-28 00:06:59 [http-nio-8080-exec-2] INFO  c.e.s.service.AuthService - 【注册】新用户注册成功, userId: cbc0c459-c85a-4bde-8927-957ba24ee420, phone: 18006569106
2025-11-28 00:06:59 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (avatar, bio, birthday, created_at, email, gender, is_deleted, last_login_ip, last_login_time, login_type, password, phone, status, updated_at, username, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:06:59 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_tokens
        (access_token, access_token_expires_at, created_at, device_id, device_type, ip_address, refresh_token, refresh_token_expires_at, status, updated_at, user_agent, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:06:59 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    update
        verification_codes 
    set
        code=?,
        expires_at=?,
        ip_address=?,
        phone=?,
        status=?,
        type=?,
        used_at=? 
    where
        id=?
2025-11-28 00:06:59 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    update
        users 
    set
        avatar=?,
        bio=?,
        birthday=?,
        email=?,
        gender=?,
        is_deleted=?,
        last_login_ip=?,
        last_login_time=?,
        login_type=?,
        password=?,
        phone=?,
        status=?,
        updated_at=?,
        username=? 
    where
        user_id=?
2025-11-28 00:06:59 [http-nio-8080-exec-2] INFO  c.e.s.controller.AuthController - 【登录成功】userId: cbc0c459-c85a-4bde-8927-957ba24ee420, phone: 18006569106
2025-11-28 00:06:59 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:06:59 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=登录成功, data=LoginResponse(userId=cbc0c459-c85a-4bde-8927-957ba24ee420,  (truncated)...]
2025-11-28 00:06:59 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:07:06 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ai/chat/sessions", parameters={}
2025-11-28 00:07:06 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#getSessions(HttpServletRequest)
2025-11-28 00:07:06 [http-nio-8080-exec-3] INFO  c.e.s.controller.AiChatController - 【获取会话列表】userId: cbc0c459-c85a-4bde-8927-957ba24ee420
2025-11-28 00:07:06 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.user_id=? 
        and cs1_0.is_deleted=? 
    order by
        cs1_0.last_message_at desc,
        cs1_0.created_at desc
2025-11-28 00:07:06 [http-nio-8080-exec-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1146, SQLState: 42S02
2025-11-28 00:07:06 [http-nio-8080-exec-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Table 'speed_calendar.chat_sessions' doesn't exist
2025-11-28 00:07:06 [http-nio-8080-exec-3] ERROR c.e.s.controller.AiChatController - 【获取会话列表失败】JDBC exception executing SQL [select cs1_0.session_id,cs1_0.created_at,cs1_0.is_deleted,cs1_0.last_message_at,cs1_0.message_count,cs1_0.status,cs1_0.title,cs1_0.updated_at,cs1_0.user_id from chat_sessions cs1_0 where cs1_0.user_id=? and cs1_0.is_deleted=? order by cs1_0.last_message_at desc,cs1_0.created_at desc] [Table 'speed_calendar.chat_sessions' doesn't exist] [n/a]; SQL [n/a]
org.springframework.dao.InvalidDataAccessResourceUsageException: JDBC exception executing SQL [select cs1_0.session_id,cs1_0.created_at,cs1_0.is_deleted,cs1_0.last_message_at,cs1_0.message_count,cs1_0.status,cs1_0.title,cs1_0.updated_at,cs1_0.user_id from chat_sessions cs1_0 where cs1_0.user_id=? and cs1_0.is_deleted=? order by cs1_0.last_message_at desc,cs1_0.created_at desc] [Table 'speed_calendar.chat_sessions' doesn't exist] [n/a]; SQL [n/a]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:281)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy149.findByUserIdAndIsDeletedOrderByLastMessageAtDesc(Unknown Source)
	at com.example.speedcalendarserver.service.AiChatService.getUserSessions(AiChatService.java:68)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.AiChatService$$SpringCGLIB$$0.getUserSessions(<generated>)
	at com.example.speedcalendarserver.controller.AiChatController.getSessions(AiChatController.java:68)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.SQLGrammarException: JDBC exception executing SQL [select cs1_0.session_id,cs1_0.created_at,cs1_0.is_deleted,cs1_0.last_message_at,cs1_0.message_count,cs1_0.status,cs1_0.title,cs1_0.updated_at,cs1_0.user_id from chat_sessions cs1_0 where cs1_0.user_id=? and cs1_0.is_deleted=? order by cs1_0.last_message_at desc,cs1_0.created_at desc] [Table 'speed_calendar.chat_sessions' doesn't exist] [n/a]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:66)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:94)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:269)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.getResultSet(DeferredResultSetAccess.java:172)
	at org.hibernate.sql.results.jdbc.internal.JdbcValuesResultSetImpl.<init>(JdbcValuesResultSetImpl.java:74)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.resolveJdbcValuesSource(JdbcSelectExecutorStandardImpl.java:355)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.doExecuteQuery(JdbcSelectExecutorStandardImpl.java:137)
	at org.hibernate.sql.exec.internal.JdbcSelectExecutorStandardImpl.executeQuery(JdbcSelectExecutorStandardImpl.java:102)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.executeQuery(JdbcSelectExecutor.java:91)
	at org.hibernate.sql.exec.spi.JdbcSelectExecutor.list(JdbcSelectExecutor.java:165)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.lambda$new$1(ConcreteSqmSelectQueryPlan.java:149)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.withCacheableSqmInterpretation(ConcreteSqmSelectQueryPlan.java:439)
	at org.hibernate.query.sqm.internal.ConcreteSqmSelectQueryPlan.performList(ConcreteSqmSelectQueryPlan.java:359)
	at org.hibernate.query.sqm.internal.QuerySqmImpl.doList(QuerySqmImpl.java:380)
	at org.hibernate.query.spi.AbstractSelectionQuery.list(AbstractSelectionQuery.java:143)
	at org.hibernate.query.Query.getResultList(Query.java:120)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:132)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:95)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:160)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:148)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 60 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Table 'speed_calendar.chat_sessions' doesn't exist
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:112)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeQuery(ClientPreparedStatement.java:1056)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at org.hibernate.sql.results.jdbc.internal.DeferredResultSetAccess.executeQuery(DeferredResultSetAccess.java:251)
	... 88 common frames omitted
2025-11-28 00:07:06 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:07:06 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=500, message=JDBC exception executing SQL [select cs1_0.session_id,cs1_0.created_at (truncated)...]
2025-11-28 00:07:06 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:10:13 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-28 00:10:13 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-28 00:10:13 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 00:10:13 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-28 00:10:13 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-28 00:10:16 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.8 with PID 24336 (E:\develop\Android Studio\workspace\SpeedCalendar-server\target\classes started by jiang in E:\develop\Android Studio\workspace\SpeedCalendar-server)
2025-11-28 00:10:16 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-28 00:10:16 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-28 00:10:16 [restartedMain] INFO  o.s.b.d.restart.ChangeableUrls - The Class-Path manifest attribute in C:\Users\jiang\.m2\repository\org\apache\opennlp\opennlp-tools\2.5.4\opennlp-tools-2.5.4.jar referenced one or more files that do not exist: file:/C:/Users/jiang/.m2/repository/org/apache/opennlp/opennlp-tools/2.5.4/slf4j-api-2.0.17.jar
2025-11-28 00:10:16 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-28 00:10:16 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-28 00:10:17 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 00:10:17 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-28 00:10:17 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 105 ms. Found 7 JPA repository interfaces.
2025-11-28 00:10:17 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 00:10:17 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-28 00:10:17 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:10:17 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:10:17 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:10:17 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:10:17 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:10:17 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:10:17 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:10:17 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 0 Redis repository interfaces.
2025-11-28 00:10:17 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-28 00:10:17 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-28 00:10:17 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-28 00:10:17 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-28 00:10:17 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1164 ms
2025-11-28 00:10:17 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-28 00:10:17 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-28 00:10:17 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-28 00:10:18 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-28 00:10:18 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-28 00:10:18 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@c5f63a2
2025-11-28 00:10:18 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-28 00:10:18 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-28 00:10:18 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-11-28 00:10:18 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-28 00:10:18 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-28 00:10:18 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 00:10:19 [restartedMain] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-28 00:10:19 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 00:10:19 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-11-28 00:10:19 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-11-28 00:10:19 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-11-28 00:10:19 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-11-28 00:10:19 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-11-28 00:10:19 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 00:10:19 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-11-28 00:10:19 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-11-28 00:10:19 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-28 00:10:19 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 23 mappings in 'requestMappingHandlerMapping'
2025-11-28 00:10:19 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-11-28 00:10:19 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-11-28 00:10:20 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-11-28 00:10:20 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-28 00:10:20 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-28 00:10:20 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 4.019 seconds (process running for 4.63)
2025-11-28 00:10:26 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-28 00:10:26 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-28 00:10:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-11-28 00:10:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-11-28 00:10:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-11-28 00:10:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@a9276f8
2025-11-28 00:10:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@3c50bdfa
2025-11-28 00:10:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-11-28 00:10:26 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-28 00:10:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ai/chat/sessions", parameters={}
2025-11-28 00:10:26 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#getSessions(HttpServletRequest)
2025-11-28 00:10:26 [http-nio-8080-exec-1] INFO  c.e.s.controller.AiChatController - 【获取会话列表】userId: cbc0c459-c85a-4bde-8927-957ba24ee420
2025-11-28 00:10:26 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.user_id=? 
        and cs1_0.is_deleted=? 
    order by
        cs1_0.last_message_at desc,
        cs1_0.created_at desc
2025-11-28 00:10:26 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:10:26 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 00:10:26 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:10:32 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-11-28 00:10:32 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-11-28 00:10:32 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=你好, sessionId=null, userId=null)]
2025-11-28 00:10:32 [http-nio-8080-exec-4] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: cbc0c459-c85a-4bde-8927-957ba24ee420, sessionId: null, message: 你好
2025-11-28 00:10:32 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=?
2025-11-28 00:10:32 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_sessions
        (created_at, is_deleted, last_message_at, message_count, status, title, updated_at, user_id, session_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:10:32 [http-nio-8080-exec-4] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1452, SQLState: 23000
2025-11-28 00:10:32 [http-nio-8080-exec-4] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)
2025-11-28 00:10:32 [http-nio-8080-exec-4] ERROR c.e.s.controller.AiChatController - 【AI服务异常】could not execute statement [Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)] [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]; SQL [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]; constraint [null]
org.springframework.dao.DataIntegrityViolationException: could not execute statement [Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)] [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]; SQL [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]; constraint [null]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy149.save(Unknown Source)
	at com.example.speedcalendarserver.service.AiChatService.createSession(AiChatService.java:58)
	at com.example.speedcalendarserver.service.AiChatService.sendMessage(AiChatService.java:127)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.AiChatService$$SpringCGLIB$$0.sendMessage(<generated>)
	at com.example.speedcalendarserver.controller.AiChatController.sendMessage(AiChatController.java:182)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)] [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:62)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 68 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:109)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 89 common frames omitted
2025-11-28 00:10:32 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:10:32 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=503, message=AI服务暂时不可用，请稍后重试, data=null)]
2025-11-28 00:10:32 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:10:44 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-11-28 00:10:44 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-11-28 00:10:44 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=你好, sessionId=null, userId=null)]
2025-11-28 00:10:44 [http-nio-8080-exec-3] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: cbc0c459-c85a-4bde-8927-957ba24ee420, sessionId: null, message: 你好
2025-11-28 00:10:44 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=?
2025-11-28 00:10:44 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_sessions
        (created_at, is_deleted, last_message_at, message_count, status, title, updated_at, user_id, session_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:10:44 [http-nio-8080-exec-3] WARN  o.h.e.jdbc.spi.SqlExceptionHelper - SQL Error: 1452, SQLState: 23000
2025-11-28 00:10:44 [http-nio-8080-exec-3] ERROR o.h.e.jdbc.spi.SqlExceptionHelper - Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)
2025-11-28 00:10:44 [http-nio-8080-exec-3] ERROR c.e.s.controller.AiChatController - 【AI服务异常】could not execute statement [Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)] [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]; SQL [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]; constraint [null]
org.springframework.dao.DataIntegrityViolationException: could not execute statement [Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)] [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]; SQL [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]; constraint [null]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:294)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:567)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:795)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:758)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:698)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:416)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy4/jdk.proxy4.$Proxy149.save(Unknown Source)
	at com.example.speedcalendarserver.service.AiChatService.createSession(AiChatService.java:58)
	at com.example.speedcalendarserver.service.AiChatService.sendMessage(AiChatService.java:127)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.speedcalendarserver.service.AiChatService$$SpringCGLIB$$0.sendMessage(<generated>)
	at com.example.speedcalendarserver.controller.AiChatController.sendMessage(AiChatController.java:182)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.exception.ConstraintViolationException: could not execute statement [Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)] [insert into chat_sessions (created_at,is_deleted,last_message_at,message_count,status,title,updated_at,user_id,session_id) values (?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:62)
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:58)
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:134)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:55)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:55)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.doStaticInserts(InsertCoordinatorStandard.java:194)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.coordinateInsert(InsertCoordinatorStandard.java:132)
	at org.hibernate.persister.entity.mutation.InsertCoordinatorStandard.insert(InsertCoordinatorStandard.java:104)
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:110)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:644)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:511)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:414)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:41)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1429)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:491)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2354)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1978)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:563)
	... 68 common frames omitted
Caused by: java.sql.SQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`speed_calendar`.`chat_sessions`, CONSTRAINT `fk_chat_sessions_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:109)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:114)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:988)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1166)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1101)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1448)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1084)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:194)
	... 89 common frames omitted
2025-11-28 00:10:44 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:10:44 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=503, message=AI服务暂时不可用，请稍后重试, data=null)]
2025-11-28 00:10:44 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:11:49 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/code", parameters={}
2025-11-28 00:11:49 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#sendCode(SendCodeRequest, HttpServletRequest)
2025-11-28 00:11:49 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [SendCodeRequest(phone=18006569106)]
2025-11-28 00:11:49 [http-nio-8080-exec-5] INFO  c.e.s.controller.AuthController - 【发送验证码】手机号: 18006569106, IP: 192.168.43.1
2025-11-28 00:11:49 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-28 00:11:49 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        count(vc1_0.id) 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.created_at>?
2025-11-28 00:11:49 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.expires_at<? 
        and vc1_0.status=?
2025-11-28 00:11:49 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    insert 
    into
        verification_codes
        (code, created_at, expires_at, ip_address, phone, status, type, used_at) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:11:49 [http-nio-8080-exec-5] INFO  c.e.s.service.AuthService - 【验证码】手机号: 18006569106, 验证码: 196262, 有效期: 300秒
2025-11-28 00:11:49 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:11:49 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=验证码发送成功, data=null)]
2025-11-28 00:11:49 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:12:34 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/login/phone", parameters={}
2025-11-28 00:12:34 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#phoneLogin(PhoneLoginRequest, HttpServletRequest)
2025-11-28 00:12:34 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PhoneLoginRequest(phone=18006569106, code=196262)]
2025-11-28 00:12:34 [http-nio-8080-exec-6] INFO  c.e.s.controller.AuthController - 【手机号登录】手机号: 18006569106, IP: 192.168.43.1
2025-11-28 00:12:34 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.code=? 
        and vc1_0.type=? 
        and vc1_0.status=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-28 00:12:34 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-11-28 00:12:34 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=?
2025-11-28 00:12:34 [http-nio-8080-exec-6] INFO  c.e.s.service.AuthService - 【注册】新用户注册成功, userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, phone: 18006569106
2025-11-28 00:12:34 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (avatar, bio, birthday, created_at, email, gender, is_deleted, last_login_ip, last_login_time, login_type, password, phone, status, updated_at, username, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:12:34 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_tokens
        (access_token, access_token_expires_at, created_at, device_id, device_type, ip_address, refresh_token, refresh_token_expires_at, status, updated_at, user_agent, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:12:34 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    update
        verification_codes 
    set
        code=?,
        expires_at=?,
        ip_address=?,
        phone=?,
        status=?,
        type=?,
        used_at=? 
    where
        id=?
2025-11-28 00:12:34 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    update
        users 
    set
        avatar=?,
        bio=?,
        birthday=?,
        email=?,
        gender=?,
        is_deleted=?,
        last_login_ip=?,
        last_login_time=?,
        login_type=?,
        password=?,
        phone=?,
        status=?,
        updated_at=?,
        username=? 
    where
        user_id=?
2025-11-28 00:12:34 [http-nio-8080-exec-6] INFO  c.e.s.controller.AuthController - 【登录成功】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, phone: 18006569106
2025-11-28 00:12:34 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:12:34 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=登录成功, data=LoginResponse(userId=bcf5dc6d-0107-4578-b150-72a0661b9eef,  (truncated)...]
2025-11-28 00:12:34 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:12:39 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ai/chat/sessions", parameters={}
2025-11-28 00:12:39 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#getSessions(HttpServletRequest)
2025-11-28 00:12:39 [http-nio-8080-exec-7] INFO  c.e.s.controller.AiChatController - 【获取会话列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef
2025-11-28 00:12:39 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.user_id=? 
        and cs1_0.is_deleted=? 
    order by
        cs1_0.last_message_at desc,
        cs1_0.created_at desc
2025-11-28 00:12:39 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:12:39 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 00:12:39 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:12:42 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-11-28 00:12:42 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-11-28 00:12:42 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=你好, sessionId=null, userId=null)]
2025-11-28 00:12:42 [http-nio-8080-exec-8] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, sessionId: null, message: 你好
2025-11-28 00:12:42 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=?
2025-11-28 00:12:42 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_sessions
        (created_at, is_deleted, last_message_at, message_count, status, title, updated_at, user_id, session_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:12:42 [http-nio-8080-exec-8] INFO  c.e.s.service.AiChatService - 为用户 bcf5dc6d-0107-4578-b150-72a0661b9eef 创建新会话: df27272b-16f2-449e-b8cc-3ccae2905e5a
2025-11-28 00:12:42 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        coalesce(max(cm1_0.sequence_num), 0) 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=?
2025-11-28 00:12:42 [http-nio-8080-exec-8] INFO  c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】首次加载会话 df27272b-16f2-449e-b8cc-3ccae2905e5a 的历史消息
2025-11-28 00:12:42 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num
2025-11-28 00:12:42 [http-nio-8080-exec-8] INFO  c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 df27272b-16f2-449e-b8cc-3ccae2905e5a 加载了 0 条历史消息
2025-11-28 00:12:42 [http-nio-8080-exec-8] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 df27272b-16f2-449e-b8cc-3ccae2905e5a 内存缓存更新，当前 1 条消息
2025-11-28 00:12:42 [http-nio-8080-exec-8] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 df27272b-16f2-449e-b8cc-3ccae2905e5a 内存缓存更新，当前 2 条消息
2025-11-28 00:12:42 [http-nio-8080-exec-8] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-11-28（星期五）00:12（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-11-28（星期五）00:12，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-11-28（星期五）00:12）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "你好"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  } ]
}

2025-11-28 00:12:42 [http-nio-8080-exec-8] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-11-28（星期五）00:12（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-11-28（星期五）00:12，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-11-28（星期五）00:12）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "你好"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-11-28 00:12:43 [http-nio-8080-exec-8] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-11-28 00:12:43 [http-nio-8080-exec-8] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Thu, 27 Nov 2025 16:12:43 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 396], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_z229jusv6c1nodqy3m]
- body: {"id":"64bcb68f71784a87816f7e97f00a689c","object":"chat.completion","created":1764259963,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"你好！有什么日程安排需要我帮你添加、查询或删除吗？"},"finish_reason":"stop"}],"usage":{"prompt_tokens":2034,"completion_tokens":17,"total_tokens":2051},"system_fingerprint":""}

2025-11-28 00:12:43 [http-nio-8080-exec-8] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 df27272b-16f2-449e-b8cc-3ccae2905e5a 内存缓存更新，当前 3 条消息
2025-11-28 00:12:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:12:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:12:43 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    update
        chat_sessions 
    set
        is_deleted=?,
        last_message_at=?,
        message_count=?,
        status=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        session_id=?
2025-11-28 00:12:43 [http-nio-8080-exec-8] INFO  c.e.s.service.AiChatService - 会话 df27272b-16f2-449e-b8cc-3ccae2905e5a 完成一轮对话，当前消息数: 4
2025-11-28 00:12:43 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:12:43 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=发送成功, data=ChatMessageResponse(sessionId=df27272b-16f2-449e-b8cc-3ccae (truncated)...]
2025-11-28 00:12:43 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:12:43 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ai/chat/sessions", parameters={}
2025-11-28 00:12:43 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#getSessions(HttpServletRequest)
2025-11-28 00:12:43 [http-nio-8080-exec-9] INFO  c.e.s.controller.AiChatController - 【获取会话列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef
2025-11-28 00:12:43 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.user_id=? 
        and cs1_0.is_deleted=? 
    order by
        cs1_0.last_message_at desc,
        cs1_0.created_at desc
2025-11-28 00:12:43 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-11-28 00:12:43 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:12:43 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ChatSessionDTO(id=df27272b-16f2-449e-b8cc-3ccae2905e5a, ti (truncated)...]
2025-11-28 00:12:43 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:12:54 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ai/chat/sessions", parameters={}
2025-11-28 00:12:54 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#getSessions(HttpServletRequest)
2025-11-28 00:12:54 [http-nio-8080-exec-10] INFO  c.e.s.controller.AiChatController - 【获取会话列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef
2025-11-28 00:12:54 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.user_id=? 
        and cs1_0.is_deleted=? 
    order by
        cs1_0.last_message_at desc,
        cs1_0.created_at desc
2025-11-28 00:12:54 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-11-28 00:12:54 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:12:54 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ChatSessionDTO(id=df27272b-16f2-449e-b8cc-3ccae2905e5a, ti (truncated)...]
2025-11-28 00:12:54 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:13:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-11-28 00:13:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-11-28 00:13:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=明天中午12点20分有培训课程, sessionId=null, userId=null)]
2025-11-28 00:13:16 [http-nio-8080-exec-1] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, sessionId: null, message: 明天中午12点20分有培训课程
2025-11-28 00:13:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=?
2025-11-28 00:13:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_sessions
        (created_at, is_deleted, last_message_at, message_count, status, title, updated_at, user_id, session_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:13:16 [http-nio-8080-exec-1] INFO  c.e.s.service.AiChatService - 为用户 bcf5dc6d-0107-4578-b150-72a0661b9eef 创建新会话: 136d55c5-c1e0-45f4-b2ec-eaf80eaad852
2025-11-28 00:13:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        coalesce(max(cm1_0.sequence_num), 0) 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=?
2025-11-28 00:13:16 [http-nio-8080-exec-1] INFO  c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】首次加载会话 136d55c5-c1e0-45f4-b2ec-eaf80eaad852 的历史消息
2025-11-28 00:13:16 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num
2025-11-28 00:13:16 [http-nio-8080-exec-1] INFO  c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 136d55c5-c1e0-45f4-b2ec-eaf80eaad852 加载了 0 条历史消息
2025-11-28 00:13:16 [http-nio-8080-exec-1] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 136d55c5-c1e0-45f4-b2ec-eaf80eaad852 内存缓存更新，当前 1 条消息
2025-11-28 00:13:16 [http-nio-8080-exec-1] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 136d55c5-c1e0-45f4-b2ec-eaf80eaad852 内存缓存更新，当前 2 条消息
2025-11-28 00:13:16 [http-nio-8080-exec-1] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-11-28（星期五）00:13（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-11-28（星期五）00:13，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-11-28（星期五）00:13）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "明天中午12点20分有培训课程"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  } ]
}

2025-11-28 00:13:16 [http-nio-8080-exec-1] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-11-28（星期五）00:13（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-11-28（星期五）00:13，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-11-28（星期五）00:13）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "明天中午12点20分有培训课程"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-11-28 00:13:18 [http-nio-8080-exec-1] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-11-28 00:13:18 [http-nio-8080-exec-1] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Thu, 27 Nov 2025 16:13:17 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 603], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_u428cv5vu173n3jox2]
- body: {"id":"a4312d43fdf84e0d86224c938ea73399","object":"chat.completion","created":1764259997,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"","tool_calls":[{"index":-1,"id":"call_fde6c161fa9948c4bbc410e3","type":"function","function":{"name":"createSchedule","arguments":"{\"title\": \"培训课程\", \"date\": \"2025-11-29\", \"startTime\": \"12:20\", \"endTime\": \"\", \"location\": \"\", \"isAllDay\": false}"}}]},"finish_reason":"tool_calls"}],"usage":{"prompt_tokens":2044,"completion_tokens":61,"total_tokens":2105},"system_fingerprint":""}

2025-11-28 00:13:18 [http-nio-8080-exec-1] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 136d55c5-c1e0-45f4-b2ec-eaf80eaad852 内存缓存更新，当前 3 条消息
2025-11-28 00:13:18 [http-nio-8080-exec-1] INFO  c.e.s.service.CalendarTools - 【CalendarTools】createSchedule 被调用 - userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, title: 培训课程, date: 2025-11-29, startTime: 12:20, endTime: , location: , isAllDay: false
2025-11-28 00:13:18 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 标题: 培训课程
2025-11-28 00:13:18 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: 2c10e514-bef7-4beb-ab4e-a5477712ffd9
2025-11-28 00:13:18 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:13:18 [http-nio-8080-exec-1] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 136d55c5-c1e0-45f4-b2ec-eaf80eaad852 内存缓存更新，当前 4 条消息
2025-11-28 00:13:18 [http-nio-8080-exec-1] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-11-28（星期五）00:13（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-11-28（星期五）00:13，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-11-28（星期五）00:13）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "明天中午12点20分有培训课程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_fde6c161fa9948c4bbc410e3",
      "type" : "function",
      "function" : {
        "name" : "createSchedule",
        "arguments" : "{\"title\": \"培训课程\", \"date\": \"2025-11-29\", \"startTime\": \"12:20\", \"endTime\": \"\", \"location\": \"\", \"isAllDay\": false}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_fde6c161fa9948c4bbc410e3",
    "content" : "✅ 日程创建成功！\n📅 标题：培训课程\n📆 日期：2025-11-29\n⏰ 时间：12:20 - 未设置"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  } ]
}

2025-11-28 00:13:18 [http-nio-8080-exec-1] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-11-28（星期五）00:13（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-11-28（星期五）00:13，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-11-28（星期五）00:13）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "明天中午12点20分有培训课程"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_fde6c161fa9948c4bbc410e3",
      "type" : "function",
      "function" : {
        "name" : "createSchedule",
        "arguments" : "{\"title\": \"培训课程\", \"date\": \"2025-11-29\", \"startTime\": \"12:20\", \"endTime\": \"\", \"location\": \"\", \"isAllDay\": false}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_fde6c161fa9948c4bbc410e3",
    "content" : "✅ 日程创建成功！\n📅 标题：培训课程\n📆 日期：2025-11-29\n⏰ 时间：12:20 - 未设置"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-11-28 00:13:18 [http-nio-8080-exec-1] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-11-28 00:13:18 [http-nio-8080-exec-1] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Thu, 27 Nov 2025 16:13:18 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 373], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_15lh0sljsrua8k6o21]
- body: {"id":"ca9908ba47a04966be5b357f9155634e","object":"chat.completion","created":1764259998,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"✅ 已添加日程：明天中午12:20 培训课程"},"finish_reason":"stop"}],"usage":{"prompt_tokens":2160,"completion_tokens":20,"total_tokens":2180},"system_fingerprint":""}

2025-11-28 00:13:18 [http-nio-8080-exec-1] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 136d55c5-c1e0-45f4-b2ec-eaf80eaad852 内存缓存更新，当前 5 条消息
2025-11-28 00:13:18 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:13:18 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:13:18 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    update
        chat_sessions 
    set
        is_deleted=?,
        last_message_at=?,
        message_count=?,
        status=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        session_id=?
2025-11-28 00:13:18 [http-nio-8080-exec-1] INFO  c.e.s.service.AiChatService - 会话 136d55c5-c1e0-45f4-b2ec-eaf80eaad852 完成一轮对话，当前消息数: 4
2025-11-28 00:13:18 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:13:18 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=发送成功, data=ChatMessageResponse(sessionId=136d55c5-c1e0-45f4-b2ec-eaf80 (truncated)...]
2025-11-28 00:13:18 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:13:18 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ai/chat/sessions", parameters={}
2025-11-28 00:13:18 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#getSessions(HttpServletRequest)
2025-11-28 00:13:18 [http-nio-8080-exec-4] INFO  c.e.s.controller.AiChatController - 【获取会话列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef
2025-11-28 00:13:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.user_id=? 
        and cs1_0.is_deleted=? 
    order by
        cs1_0.last_message_at desc,
        cs1_0.created_at desc
2025-11-28 00:13:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-11-28 00:13:18 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-11-28 00:13:18 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:13:18 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ChatSessionDTO(id=136d55c5-c1e0-45f4-b2ec-eaf80eaad852, ti (truncated)...]
2025-11-28 00:13:18 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:13:20 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 00:13:20 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 00:13:20 [http-nio-8080-exec-3] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 00:13:20 [http-nio-8080-exec-3] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 00:13:20 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 00:13:20 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:13:20 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=2c10e514-bef7-4beb-ab4e-a5477712ffd (truncated)...]
2025-11-28 00:13:20 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:13:23 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ai/chat/sessions", parameters={}
2025-11-28 00:13:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#getSessions(HttpServletRequest)
2025-11-28 00:13:23 [http-nio-8080-exec-2] INFO  c.e.s.controller.AiChatController - 【获取会话列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef
2025-11-28 00:13:23 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.user_id=? 
        and cs1_0.is_deleted=? 
    order by
        cs1_0.last_message_at desc,
        cs1_0.created_at desc
2025-11-28 00:13:23 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-11-28 00:13:23 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-11-28 00:13:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:13:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ChatSessionDTO(id=136d55c5-c1e0-45f4-b2ec-eaf80eaad852, ti (truncated)...]
2025-11-28 00:13:23 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:13:41 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 00:13:41 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 00:13:41 [http-nio-8080-exec-5] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 00:13:41 [http-nio-8080-exec-5] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 00:13:41 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 00:13:41 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:13:41 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=2c10e514-bef7-4beb-ab4e-a5477712ffd (truncated)...]
2025-11-28 00:13:41 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:13:53 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 00:13:53 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 00:13:53 [http-nio-8080-exec-6] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 00:13:53 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 00:13:53 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 00:13:53 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:13:53 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=2c10e514-bef7-4beb-ab4e-a5477712ffd (truncated)...]
2025-11-28 00:13:53 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:13:58 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 00:13:58 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 00:13:58 [http-nio-8080-exec-7] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 00:13:58 [http-nio-8080-exec-7] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 00:13:58 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 00:13:58 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:13:58 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=2c10e514-bef7-4beb-ab4e-a5477712ffd (truncated)...]
2025-11-28 00:13:58 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:15:25 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-11-28 00:15:25 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-11-28 00:15:25 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我添加日程：各<EOL>位<EOL>十<EOL>佳<EOL>歌<EOL>手<EOL>复<EOL>赛<EOL>选<EOL>手<EOL>：<EOL><EOL>目<EOL>前<EOL>部<EOL>分<EOL>选<EOL>手<EOL>未<EOL>按<EOL>背<EOL>景<EOL>+<EOL>音<EOL>频<EOL>二<EOL>合<EOL><EOL>一<EOL>的<EOL>格<EOL>式<EOL>提<EOL>交<EOL> (truncated)...]
2025-11-28 00:15:25 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:15:25 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=401, message=未授权，请先登录, data=null)]
2025-11-28 00:15:25 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:15:48 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-11-28 00:15:48 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-11-28 00:15:48 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我添加日程：各<EOL>位<EOL>十<EOL>佳<EOL>歌<EOL>手<EOL>复<EOL>赛<EOL>选<EOL>手<EOL>：<EOL><EOL>目<EOL>前<EOL>部<EOL>分<EOL>选<EOL>手<EOL>未<EOL>按<EOL>背<EOL>景<EOL>+<EOL>音<EOL>频<EOL>二<EOL>合<EOL><EOL>一<EOL>的<EOL>格<EOL>式<EOL>提<EOL>交<EOL> (truncated)...]
2025-11-28 00:15:48 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:15:48 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=401, message=未授权，请先登录, data=null)]
2025-11-28 00:15:48 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:16:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-11-28 00:16:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-11-28 00:16:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我添加日程：各<EOL>位<EOL>十<EOL>佳<EOL>歌<EOL>手<EOL>复<EOL>赛<EOL>选<EOL>手<EOL>：<EOL><EOL>目<EOL>前<EOL>部<EOL>分<EOL>选<EOL>手<EOL>未<EOL>按<EOL>背<EOL>景<EOL>+<EOL>音<EOL>频<EOL>二<EOL>合<EOL><EOL>一<EOL>的<EOL>格<EOL>式<EOL>提<EOL>交<EOL> (truncated)...]
2025-11-28 00:16:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:16:30 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=401, message=未授权，请先登录, data=null)]
2025-11-28 00:16:30 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:18:58 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/code", parameters={}
2025-11-28 00:18:58 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#sendCode(SendCodeRequest, HttpServletRequest)
2025-11-28 00:18:58 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [SendCodeRequest(phone=18006569106)]
2025-11-28 00:18:58 [http-nio-8080-exec-2] INFO  c.e.s.controller.AuthController - 【发送验证码】手机号: 18006569106, IP: 192.168.43.1
2025-11-28 00:18:58 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-28 00:18:59 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        count(vc1_0.id) 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.created_at>?
2025-11-28 00:18:59 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.expires_at<? 
        and vc1_0.status=?
2025-11-28 00:18:59 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        verification_codes
        (code, created_at, expires_at, ip_address, phone, status, type, used_at) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:18:59 [http-nio-8080-exec-2] INFO  c.e.s.service.AuthService - 【验证码】手机号: 18006569106, 验证码: 559143, 有效期: 300秒
2025-11-28 00:18:59 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:18:59 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=验证码发送成功, data=null)]
2025-11-28 00:18:59 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:19:12 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/login/phone", parameters={}
2025-11-28 00:19:12 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#phoneLogin(PhoneLoginRequest, HttpServletRequest)
2025-11-28 00:19:12 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PhoneLoginRequest(phone=18006569106, code=559143)]
2025-11-28 00:19:12 [http-nio-8080-exec-5] INFO  c.e.s.controller.AuthController - 【手机号登录】手机号: 18006569106, IP: 192.168.43.1
2025-11-28 00:19:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.code=? 
        and vc1_0.type=? 
        and vc1_0.status=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-28 00:19:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-11-28 00:19:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_tokens
        (access_token, access_token_expires_at, created_at, device_id, device_type, ip_address, refresh_token, refresh_token_expires_at, status, updated_at, user_agent, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:19:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    update
        verification_codes 
    set
        code=?,
        expires_at=?,
        ip_address=?,
        phone=?,
        status=?,
        type=?,
        used_at=? 
    where
        id=?
2025-11-28 00:19:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    update
        users 
    set
        avatar=?,
        bio=?,
        birthday=?,
        email=?,
        gender=?,
        is_deleted=?,
        last_login_ip=?,
        last_login_time=?,
        login_type=?,
        password=?,
        phone=?,
        status=?,
        updated_at=?,
        username=? 
    where
        user_id=?
2025-11-28 00:19:12 [http-nio-8080-exec-5] INFO  c.e.s.controller.AuthController - 【登录成功】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, phone: 18006569106
2025-11-28 00:19:12 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:19:12 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=登录成功, data=LoginResponse(userId=bcf5dc6d-0107-4578-b150-72a0661b9eef,  (truncated)...]
2025-11-28 00:19:12 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:19:32 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-11-28 00:19:32 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-11-28 00:19:32 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我添加日程：各<EOL>位<EOL>十<EOL>佳<EOL>歌<EOL>手<EOL>复<EOL>赛<EOL>选<EOL>手<EOL>：<EOL><EOL>目<EOL>前<EOL>部<EOL>分<EOL>选<EOL>手<EOL>未<EOL>按<EOL>背<EOL>景<EOL>+<EOL>音<EOL>频<EOL>二<EOL>合<EOL><EOL>一<EOL>的<EOL>格<EOL>式<EOL>提<EOL>交<EOL> (truncated)...]
2025-11-28 00:19:32 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:19:32 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=401, message=未授权，请先登录, data=null)]
2025-11-28 00:19:32 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:19:37 [File Watcher] INFO  o.s.b.d.a.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 2 class path changes (0 additions, 2 deletions, 0 modifications)
2025-11-28 00:19:37 [Thread-5] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-28 00:19:37 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-28 00:19:37 [Thread-5] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 00:19:37 [Thread-5] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-28 00:19:37 [Thread-5] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-28 00:19:38 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.8 with PID 24336 (E:\develop\Android Studio\workspace\SpeedCalendar-server\target\classes started by jiang in E:\develop\Android Studio\workspace\SpeedCalendar-server)
2025-11-28 00:19:38 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-28 00:19:38 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-28 00:19:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 00:19:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-28 00:19:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 29 ms. Found 7 JPA repository interfaces.
2025-11-28 00:19:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 00:19:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-28 00:19:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:19:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:19:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:19:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:19:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:19:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:19:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:19:38 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-11-28 00:19:38 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-28 00:19:38 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-28 00:19:38 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-28 00:19:38 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-28 00:19:38 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 623 ms
2025-11-28 00:19:38 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-28 00:19:38 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-28 00:19:38 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-28 00:19:38 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Starting...
2025-11-28 00:19:38 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-2 - Added connection com.mysql.cj.jdbc.ConnectionImpl@6ba8f777
2025-11-28 00:19:38 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Start completed.
2025-11-28 00:19:38 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-28 00:19:38 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-11-28 00:19:38 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-2)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-28 00:19:38 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-28 00:19:38 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 00:19:39 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 00:19:39 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-11-28 00:19:39 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-11-28 00:19:39 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-11-28 00:19:39 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-11-28 00:19:39 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-11-28 00:19:39 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 00:19:39 [restartedMain] WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'aiChatController' defined in file [E:\develop\Android Studio\workspace\SpeedCalendar-server\target\classes\com\example\speedcalendarserver\controller\AiChatController.class]: Unsatisfied dependency expressed through constructor parameter 0: No qualifying bean of type 'com.example.speedcalendarserver.service.AiChatService' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {}
2025-11-28 00:19:39 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 00:19:39 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown initiated...
2025-11-28 00:19:39 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown completed.
2025-11-28 00:19:39 [restartedMain] INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-11-28 00:19:39 [restartedMain] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-11-28 00:19:39 [restartedMain] ERROR o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Parameter 0 of constructor in com.example.speedcalendarserver.controller.AiChatController required a bean of type 'com.example.speedcalendarserver.service.AiChatService' that could not be found.


Action:

Consider defining a bean of type 'com.example.speedcalendarserver.service.AiChatService' in your configuration.

2025-11-28 00:19:40 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.8 with PID 24336 (E:\develop\Android Studio\workspace\SpeedCalendar-server\target\classes started by jiang in E:\develop\Android Studio\workspace\SpeedCalendar-server)
2025-11-28 00:19:40 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-28 00:19:40 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-28 00:19:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 00:19:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-28 00:19:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 23 ms. Found 7 JPA repository interfaces.
2025-11-28 00:19:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 00:19:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-28 00:19:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:19:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:19:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:19:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:19:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:19:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:19:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:19:40 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-11-28 00:19:41 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-28 00:19:41 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-28 00:19:41 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-28 00:19:41 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-28 00:19:41 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 387 ms
2025-11-28 00:19:41 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-28 00:19:41 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-28 00:19:41 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-28 00:19:41 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Starting...
2025-11-28 00:19:41 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-3 - Added connection com.mysql.cj.jdbc.ConnectionImpl@144f5b7b
2025-11-28 00:19:41 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Start completed.
2025-11-28 00:19:41 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-28 00:19:41 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-11-28 00:19:41 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-3)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-28 00:19:41 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-28 00:19:41 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 00:19:41 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 00:19:41 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-11-28 00:19:41 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-11-28 00:19:41 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-11-28 00:19:41 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-11-28 00:19:41 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-11-28 00:19:41 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 00:19:41 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-11-28 00:19:41 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-11-28 00:19:41 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-28 00:19:41 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 23 mappings in 'requestMappingHandlerMapping'
2025-11-28 00:19:41 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-11-28 00:19:41 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-11-28 00:19:41 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-11-28 00:19:41 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-28 00:19:41 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-28 00:19:41 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 0.991 seconds (process running for 565.959)
2025-11-28 00:19:41 [restartedMain] INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener - Condition evaluation unchanged
2025-11-28 00:20:04 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-28 00:20:04 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-28 00:20:04 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 00:20:04 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Shutdown initiated...
2025-11-28 00:20:04 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Shutdown completed.
2025-11-28 00:20:08 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.8 with PID 26472 (E:\develop\Android Studio\workspace\SpeedCalendar-server\target\classes started by jiang in E:\develop\Android Studio\workspace\SpeedCalendar-server)
2025-11-28 00:20:08 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-28 00:20:08 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-28 00:20:08 [restartedMain] INFO  o.s.b.d.restart.ChangeableUrls - The Class-Path manifest attribute in C:\Users\jiang\.m2\repository\org\apache\opennlp\opennlp-tools\2.5.4\opennlp-tools-2.5.4.jar referenced one or more files that do not exist: file:/C:/Users/jiang/.m2/repository/org/apache/opennlp/opennlp-tools/2.5.4/slf4j-api-2.0.17.jar
2025-11-28 00:20:08 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-28 00:20:08 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-28 00:20:08 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 00:20:08 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-28 00:20:09 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 163 ms. Found 7 JPA repository interfaces.
2025-11-28 00:20:09 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 00:20:09 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-28 00:20:09 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:20:09 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:20:09 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:20:09 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:20:09 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:20:09 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:20:09 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 00:20:09 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-11-28 00:20:09 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-28 00:20:09 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-28 00:20:09 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-28 00:20:10 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-28 00:20:10 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1843 ms
2025-11-28 00:20:10 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-28 00:20:10 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-28 00:20:10 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-28 00:20:10 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-28 00:20:10 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-28 00:20:10 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@654d0272
2025-11-28 00:20:10 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-28 00:20:11 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-28 00:20:11 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-11-28 00:20:11 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-28 00:20:12 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-28 00:20:12 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 00:20:13 [restartedMain] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-28 00:20:14 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 00:20:14 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-11-28 00:20:14 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-11-28 00:20:14 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-11-28 00:20:14 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-11-28 00:20:14 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-11-28 00:20:14 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 00:20:14 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-11-28 00:20:14 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-11-28 00:20:14 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-28 00:20:14 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 23 mappings in 'requestMappingHandlerMapping'
2025-11-28 00:20:14 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-11-28 00:20:14 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-11-28 00:20:14 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-11-28 00:20:15 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-28 00:20:15 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-28 00:20:15 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 7.835 seconds (process running for 8.685)
2025-11-28 00:21:12 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-28 00:21:12 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-28 00:21:12 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-11-28 00:21:12 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-11-28 00:21:12 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-11-28 00:21:12 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@b64ba1f
2025-11-28 00:21:12 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@5afb2142
2025-11-28 00:21:12 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-11-28 00:21:12 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-28 00:21:12 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/code", parameters={}
2025-11-28 00:21:12 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#sendCode(SendCodeRequest, HttpServletRequest)
2025-11-28 00:21:12 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [SendCodeRequest(phone=18006569106)]
2025-11-28 00:21:12 [http-nio-8080-exec-1] INFO  c.e.s.controller.AuthController - 【发送验证码】手机号: 18006569106, IP: 192.168.43.1
2025-11-28 00:21:12 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-28 00:21:12 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        count(vc1_0.id) 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.created_at>?
2025-11-28 00:21:12 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.expires_at<? 
        and vc1_0.status=?
2025-11-28 00:21:12 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    insert 
    into
        verification_codes
        (code, created_at, expires_at, ip_address, phone, status, type, used_at) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:21:12 [http-nio-8080-exec-1] INFO  c.e.s.service.AuthService - 【验证码】手机号: 18006569106, 验证码: 712152, 有效期: 300秒
2025-11-28 00:21:12 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:21:12 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=验证码发送成功, data=null)]
2025-11-28 00:21:12 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:21:21 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/login/phone", parameters={}
2025-11-28 00:21:21 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#phoneLogin(PhoneLoginRequest, HttpServletRequest)
2025-11-28 00:21:21 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PhoneLoginRequest(phone=18006569106, code=712152)]
2025-11-28 00:21:21 [http-nio-8080-exec-2] INFO  c.e.s.controller.AuthController - 【手机号登录】手机号: 18006569106, IP: 192.168.43.1
2025-11-28 00:21:21 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.code=? 
        and vc1_0.type=? 
        and vc1_0.status=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-28 00:21:21 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-11-28 00:21:21 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_tokens
        (access_token, access_token_expires_at, created_at, device_id, device_type, ip_address, refresh_token, refresh_token_expires_at, status, updated_at, user_agent, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:21:21 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    update
        verification_codes 
    set
        code=?,
        expires_at=?,
        ip_address=?,
        phone=?,
        status=?,
        type=?,
        used_at=? 
    where
        id=?
2025-11-28 00:21:21 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    update
        users 
    set
        avatar=?,
        bio=?,
        birthday=?,
        email=?,
        gender=?,
        is_deleted=?,
        last_login_ip=?,
        last_login_time=?,
        login_type=?,
        password=?,
        phone=?,
        status=?,
        updated_at=?,
        username=? 
    where
        user_id=?
2025-11-28 00:21:21 [http-nio-8080-exec-2] INFO  c.e.s.controller.AuthController - 【登录成功】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, phone: 18006569106
2025-11-28 00:21:21 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:21:21 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=登录成功, data=LoginResponse(userId=bcf5dc6d-0107-4578-b150-72a0661b9eef,  (truncated)...]
2025-11-28 00:21:21 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:21:25 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 00:21:25 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 00:21:25 [http-nio-8080-exec-3] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 00:21:25 [http-nio-8080-exec-3] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 00:21:25 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 00:21:25 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:21:25 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=2c10e514-bef7-4beb-ab4e-a5477712ffd (truncated)...]
2025-11-28 00:21:25 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:21:36 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-11-28 00:21:36 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-11-28 00:21:36 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我添加日程：A<EOL><EOL>待<EOL>开<EOL>发<EOL><EOL>敬<EOL>请<EOL>期<EOL>待<EOL><EOL>, sessionId=null, userId=null)]
2025-11-28 00:21:36 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:21:36 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=401, message=未授权，请先登录, data=null)]
2025-11-28 00:21:36 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:24:44 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/code", parameters={}
2025-11-28 00:24:44 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#sendCode(SendCodeRequest, HttpServletRequest)
2025-11-28 00:24:44 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [SendCodeRequest(phone=18006569106)]
2025-11-28 00:24:44 [http-nio-8080-exec-6] INFO  c.e.s.controller.AuthController - 【发送验证码】手机号: 18006569106, IP: 192.168.43.1
2025-11-28 00:24:44 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-28 00:24:44 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        count(vc1_0.id) 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.created_at>?
2025-11-28 00:24:44 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.expires_at<? 
        and vc1_0.status=?
2025-11-28 00:24:44 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        verification_codes
        (code, created_at, expires_at, ip_address, phone, status, type, used_at) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:24:44 [http-nio-8080-exec-6] INFO  c.e.s.service.AuthService - 【验证码】手机号: 18006569106, 验证码: 662496, 有效期: 300秒
2025-11-28 00:24:44 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:24:44 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=验证码发送成功, data=null)]
2025-11-28 00:24:44 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:24:53 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/login/phone", parameters={}
2025-11-28 00:24:53 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#phoneLogin(PhoneLoginRequest, HttpServletRequest)
2025-11-28 00:24:53 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [PhoneLoginRequest(phone=18006569106, code=662496)]
2025-11-28 00:24:53 [http-nio-8080-exec-7] INFO  c.e.s.controller.AuthController - 【手机号登录】手机号: 18006569106, IP: 192.168.43.1
2025-11-28 00:24:53 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        vc1_0.id,
        vc1_0.code,
        vc1_0.created_at,
        vc1_0.expires_at,
        vc1_0.ip_address,
        vc1_0.phone,
        vc1_0.status,
        vc1_0.type,
        vc1_0.used_at 
    from
        verification_codes vc1_0 
    where
        vc1_0.phone=? 
        and vc1_0.code=? 
        and vc1_0.type=? 
        and vc1_0.status=? 
    order by
        vc1_0.created_at desc 
    limit
        ?
2025-11-28 00:24:53 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.phone=? 
        and u1_0.is_deleted=?
2025-11-28 00:24:53 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_tokens
        (access_token, access_token_expires_at, created_at, device_id, device_type, ip_address, refresh_token, refresh_token_expires_at, status, updated_at, user_agent, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:24:53 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    update
        verification_codes 
    set
        code=?,
        expires_at=?,
        ip_address=?,
        phone=?,
        status=?,
        type=?,
        used_at=? 
    where
        id=?
2025-11-28 00:24:53 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    update
        users 
    set
        avatar=?,
        bio=?,
        birthday=?,
        email=?,
        gender=?,
        is_deleted=?,
        last_login_ip=?,
        last_login_time=?,
        login_type=?,
        password=?,
        phone=?,
        status=?,
        updated_at=?,
        username=? 
    where
        user_id=?
2025-11-28 00:24:53 [http-nio-8080-exec-7] INFO  c.e.s.controller.AuthController - 【登录成功】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, phone: 18006569106
2025-11-28 00:24:53 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:24:53 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=登录成功, data=LoginResponse(userId=bcf5dc6d-0107-4578-b150-72a0661b9eef,  (truncated)...]
2025-11-28 00:24:53 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:25:13 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-11-28 00:25:13 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-11-28 00:25:13 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我添加日程：各<EOL>位<EOL>十<EOL>佳<EOL>歌<EOL>手<EOL>复<EOL>赛<EOL>选<EOL>手<EOL>：<EOL><EOL>目<EOL>前<EOL>部<EOL>分<EOL>选<EOL>手<EOL>未<EOL>按<EOL>背<EOL>景<EOL>+<EOL>音<EOL>频<EOL>二<EOL>合<EOL><EOL>一<EOL>的<EOL>格<EOL>式<EOL>提<EOL>交<EOL> (truncated)...]
2025-11-28 00:25:13 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:25:13 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=401, message=未授权，请先登录, data=null)]
2025-11-28 00:25:13 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:25:13 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/refresh", parameters={}
2025-11-28 00:25:13 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#refreshToken(RefreshTokenRequest, HttpServletRequest)
2025-11-28 00:25:13 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=utf-8" to [RefreshTokenRequest(refreshToken=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJiY2Y1ZGM2ZC0wMTA3LTQ1NzgtYjE1MC03Mm (truncated)...]
2025-11-28 00:25:13 [http-nio-8080-exec-10] INFO  c.e.s.controller.AuthController - 【刷新Token】IP: 192.168.43.1
2025-11-28 00:25:13 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        ut1_0.id,
        ut1_0.access_token,
        ut1_0.access_token_expires_at,
        ut1_0.created_at,
        ut1_0.device_id,
        ut1_0.device_type,
        ut1_0.ip_address,
        ut1_0.refresh_token,
        ut1_0.refresh_token_expires_at,
        ut1_0.status,
        ut1_0.updated_at,
        ut1_0.user_agent,
        ut1_0.user_id 
    from
        user_tokens ut1_0 
    where
        ut1_0.refresh_token=?
2025-11-28 00:25:13 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-28 00:25:13 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_tokens
        (access_token, access_token_expires_at, created_at, device_id, device_type, ip_address, refresh_token, refresh_token_expires_at, status, updated_at, user_agent, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:25:13 [http-nio-8080-exec-10] INFO  c.e.s.service.AuthService - 【刷新Token成功】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef
2025-11-28 00:25:13 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    update
        user_tokens 
    set
        access_token=?,
        access_token_expires_at=?,
        device_id=?,
        device_type=?,
        ip_address=?,
        refresh_token=?,
        refresh_token_expires_at=?,
        status=?,
        updated_at=?,
        user_agent=?,
        user_id=? 
    where
        id=?
2025-11-28 00:25:13 [http-nio-8080-exec-10] INFO  c.e.s.controller.AuthController - 【刷新Token成功】
2025-11-28 00:25:13 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:25:13 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=刷新成功, data=RefreshTokenResponse(token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ (truncated)...]
2025-11-28 00:25:13 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:25:13 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-11-28 00:25:13 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-11-28 00:25:13 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我添加日程：各<EOL>位<EOL>十<EOL>佳<EOL>歌<EOL>手<EOL>复<EOL>赛<EOL>选<EOL>手<EOL>：<EOL><EOL>目<EOL>前<EOL>部<EOL>分<EOL>选<EOL>手<EOL>未<EOL>按<EOL>背<EOL>景<EOL>+<EOL>音<EOL>频<EOL>二<EOL>合<EOL><EOL>一<EOL>的<EOL>格<EOL>式<EOL>提<EOL>交<EOL> (truncated)...]
2025-11-28 00:25:13 [http-nio-8080-exec-1] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, sessionId: null, message: 帮我添加日程：各位十佳歌手复赛选手：
目前部分选手未按背景+音频二合
一的格式提交参赛音频，影响后续
赛程推进...
2025-11-28 00:25:13 [http-nio-8080-exec-1] INFO  c.e.s.service.AiChatService - 准备为用户 bcf5dc6d-0107-4578-b150-72a0661b9eef 创建新会话...
2025-11-28 00:25:13 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=?
2025-11-28 00:25:13 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_sessions
        (created_at, is_deleted, last_message_at, message_count, status, title, updated_at, user_id, session_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:25:13 [http-nio-8080-exec-1] INFO  c.e.s.service.AiChatService - 为用户 bcf5dc6d-0107-4578-b150-72a0661b9eef 创建新会话成功: e1b0fddc-290b-4386-adfa-5907d67d0394
2025-11-28 00:25:13 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        coalesce(max(cm1_0.sequence_num), 0) 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=?
2025-11-28 00:25:13 [http-nio-8080-exec-1] INFO  c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】首次加载会话 e1b0fddc-290b-4386-adfa-5907d67d0394 的历史消息
2025-11-28 00:25:13 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num
2025-11-28 00:25:13 [http-nio-8080-exec-1] INFO  c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 e1b0fddc-290b-4386-adfa-5907d67d0394 加载了 0 条历史消息
2025-11-28 00:25:13 [http-nio-8080-exec-1] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 e1b0fddc-290b-4386-adfa-5907d67d0394 内存缓存更新，当前 1 条消息
2025-11-28 00:25:13 [http-nio-8080-exec-1] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 e1b0fddc-290b-4386-adfa-5907d67d0394 内存缓存更新，当前 2 条消息
2025-11-28 00:25:13 [http-nio-8080-exec-1] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-11-28（星期五）00:25（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-11-28（星期五）00:25，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-11-28（星期五）00:25）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加日程：各\r位\r十\r佳\r歌\r手\r复\r赛\r选\r手\r：\r\n目\r前\r部\r分\r选\r手\r未\r按\r背\r景\r+\r音\r频\r二\r合\r\n一\r的\r格\r式\r提\r交\r参\r赛\r音\r频\r，\r影\r响\r后\r续\r\n赛\r程\r推\r进\r。\r请\r相\r关\r选\r手\r于\r1\r1\r月\r2\r5\r\n日\r中\r午\r1\r2\r：\r0\r0\r前\r，\r按\r“\r姓\r名\r+\r曲\r\n目\r名\r称\r+\r轮\r次\r”\r命\r名\r，\r以\r规\r定\r格\r式\r\n重\r新\r发\r送\r至\r指\r定\r邮\r箱\rz\rj\ro\ru\rs\ru\r1\r9\r5\r8\r\n@\r1\r6\r3\r.\rc\ro\rm\r，\r逾\r期\r未\r交\r时\r出\r现\r任\r何\r\n问\r题\r后\r果\r自\r负\r。\r提\r交\r过\r程\r中\r疑\r问\r可\r\n以\r联\r系\r工\r作\r人\r员\r@\r虾\r饺\r皇\r\n"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  } ]
}

2025-11-28 00:25:13 [http-nio-8080-exec-1] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-11-28（星期五）00:25（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-11-28（星期五）00:25，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-11-28（星期五）00:25）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加日程：各\r位\r十\r佳\r歌\r手\r复\r赛\r选\r手\r：\r\n目\r前\r部\r分\r选\r手\r未\r按\r背\r景\r+\r音\r频\r二\r合\r\n一\r的\r格\r式\r提\r交\r参\r赛\r音\r频\r，\r影\r响\r后\r续\r\n赛\r程\r推\r进\r。\r请\r相\r关\r选\r手\r于\r1\r1\r月\r2\r5\r\n日\r中\r午\r1\r2\r：\r0\r0\r前\r，\r按\r“\r姓\r名\r+\r曲\r\n目\r名\r称\r+\r轮\r次\r”\r命\r名\r，\r以\r规\r定\r格\r式\r\n重\r新\r发\r送\r至\r指\r定\r邮\r箱\rz\rj\ro\ru\rs\ru\r1\r9\r5\r8\r\n@\r1\r6\r3\r.\rc\ro\rm\r，\r逾\r期\r未\r交\r时\r出\r现\r任\r何\r\n问\r题\r后\r果\r自\r负\r。\r提\r交\r过\r程\r中\r疑\r问\r可\r\n以\r联\r系\r工\r作\r人\r员\r@\r虾\r饺\r皇\r\n"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-11-28 00:25:14 [http-nio-8080-exec-1] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-11-28 00:25:14 [http-nio-8080-exec-1] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Thu, 27 Nov 2025 16:25:13 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 344], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_lz91mcy6tiah0uefqc]
- body: {"id":"4f93ce4abe034802afdda749a5f532c6","object":"chat.completion","created":1764260713,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"未识别到日程信息"},"finish_reason":"stop"}],"usage":{"prompt_tokens":2340,"completion_tokens":7,"total_tokens":2347},"system_fingerprint":""}

2025-11-28 00:25:14 [http-nio-8080-exec-1] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 e1b0fddc-290b-4386-adfa-5907d67d0394 内存缓存更新，当前 3 条消息
2025-11-28 00:25:14 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:25:14 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:25:14 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    update
        chat_sessions 
    set
        is_deleted=?,
        last_message_at=?,
        message_count=?,
        status=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        session_id=?
2025-11-28 00:25:14 [http-nio-8080-exec-1] INFO  c.e.s.service.AiChatService - 会话 e1b0fddc-290b-4386-adfa-5907d67d0394 完成一轮对话，当前消息数: 4
2025-11-28 00:25:14 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:25:14 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=发送成功, data=ChatMessageResponse(sessionId=e1b0fddc-290b-4386-adfa-5907d (truncated)...]
2025-11-28 00:25:14 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:26:48 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-11-28 00:26:48 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-11-28 00:26:48 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我添加日程：周<EOL>二<EOL>下<EOL>午<EOL>5<EOL>:<EOL>0<EOL>6<EOL><EOL>P<EOL>陈<EOL>昊<EOL>天<EOL><EOL>@<EOL>所<EOL>有<EOL>人<EOL><EOL>新<EOL>城<EOL>校<EOL>区<EOL>的<EOL>班<EOL>长<EOL>请<EOL>注<EOL>意<EOL>，<EOL><EOL>明<EOL>天<EOL>中<EOL>午<EOL> (truncated)...]
2025-11-28 00:26:48 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:26:48 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=401, message=未授权，请先登录, data=null)]
2025-11-28 00:26:48 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:26:48 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/refresh", parameters={}
2025-11-28 00:26:48 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#refreshToken(RefreshTokenRequest, HttpServletRequest)
2025-11-28 00:26:48 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=utf-8" to [RefreshTokenRequest(refreshToken=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJiY2Y1ZGM2ZC0wMTA3LTQ1NzgtYjE1MC03Mm (truncated)...]
2025-11-28 00:26:48 [http-nio-8080-exec-9] INFO  c.e.s.controller.AuthController - 【刷新Token】IP: 192.168.43.1
2025-11-28 00:26:48 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        ut1_0.id,
        ut1_0.access_token,
        ut1_0.access_token_expires_at,
        ut1_0.created_at,
        ut1_0.device_id,
        ut1_0.device_type,
        ut1_0.ip_address,
        ut1_0.refresh_token,
        ut1_0.refresh_token_expires_at,
        ut1_0.status,
        ut1_0.updated_at,
        ut1_0.user_agent,
        ut1_0.user_id 
    from
        user_tokens ut1_0 
    where
        ut1_0.refresh_token=?
2025-11-28 00:26:48 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-28 00:26:48 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_tokens
        (access_token, access_token_expires_at, created_at, device_id, device_type, ip_address, refresh_token, refresh_token_expires_at, status, updated_at, user_agent, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:26:48 [http-nio-8080-exec-9] INFO  c.e.s.service.AuthService - 【刷新Token成功】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef
2025-11-28 00:26:48 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    update
        user_tokens 
    set
        access_token=?,
        access_token_expires_at=?,
        device_id=?,
        device_type=?,
        ip_address=?,
        refresh_token=?,
        refresh_token_expires_at=?,
        status=?,
        updated_at=?,
        user_agent=?,
        user_id=? 
    where
        id=?
2025-11-28 00:26:48 [http-nio-8080-exec-9] INFO  c.e.s.controller.AuthController - 【刷新Token成功】
2025-11-28 00:26:48 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:26:48 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=刷新成功, data=RefreshTokenResponse(token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ (truncated)...]
2025-11-28 00:26:48 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:26:48 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ai/chat/message", parameters={}
2025-11-28 00:26:48 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#sendMessage(ChatMessageRequest, HttpServletRequest)
2025-11-28 00:26:48 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [ChatMessageRequest(message=帮我添加日程：周<EOL>二<EOL>下<EOL>午<EOL>5<EOL>:<EOL>0<EOL>6<EOL><EOL>P<EOL>陈<EOL>昊<EOL>天<EOL><EOL>@<EOL>所<EOL>有<EOL>人<EOL><EOL>新<EOL>城<EOL>校<EOL>区<EOL>的<EOL>班<EOL>长<EOL>请<EOL>注<EOL>意<EOL>，<EOL><EOL>明<EOL>天<EOL>中<EOL>午<EOL> (truncated)...]
2025-11-28 00:26:48 [http-nio-8080-exec-6] INFO  c.e.s.controller.AiChatController - 【发送消息】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, sessionId: null, message: 帮我添加日程：周二下午5:06
P陈昊天
@所有人
新城校区的班长请注意，
明天中午12:30-13:30召开寝...
2025-11-28 00:26:48 [http-nio-8080-exec-6] INFO  c.e.s.service.AiChatService - 准备为用户 bcf5dc6d-0107-4578-b150-72a0661b9eef 创建新会话...
2025-11-28 00:26:48 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.session_id=?
2025-11-28 00:26:48 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_sessions
        (created_at, is_deleted, last_message_at, message_count, status, title, updated_at, user_id, session_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:26:48 [http-nio-8080-exec-6] INFO  c.e.s.service.AiChatService - 为用户 bcf5dc6d-0107-4578-b150-72a0661b9eef 创建新会话成功: 533275d0-74d5-4462-a93d-45cd190ba934
2025-11-28 00:26:48 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        coalesce(max(cm1_0.sequence_num), 0) 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=?
2025-11-28 00:26:48 [http-nio-8080-exec-6] INFO  c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】首次加载会话 533275d0-74d5-4462-a93d-45cd190ba934 的历史消息
2025-11-28 00:26:48 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num
2025-11-28 00:26:48 [http-nio-8080-exec-6] INFO  c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 533275d0-74d5-4462-a93d-45cd190ba934 加载了 0 条历史消息
2025-11-28 00:26:48 [http-nio-8080-exec-6] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 533275d0-74d5-4462-a93d-45cd190ba934 内存缓存更新，当前 1 条消息
2025-11-28 00:26:48 [http-nio-8080-exec-6] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 533275d0-74d5-4462-a93d-45cd190ba934 内存缓存更新，当前 2 条消息
2025-11-28 00:26:48 [http-nio-8080-exec-6] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-11-28（星期五）00:26（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-11-28（星期五）00:26，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-11-28（星期五）00:26）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加日程：周\r二\r下\r午\r5\r:\r0\r6\r\nP\r陈\r昊\r天\r\n@\r所\r有\r人\r\n新\r城\r校\r区\r的\r班\r长\r请\r注\r意\r，\r\n明\r天\r中\r午\r1\r2\r:\r3\r0\r-\r1\r3\r:\r3\r0\r召\r开\r寝\r室\r长\r\n培\r训\r会\r，\r地\r点\r另\r行\r通\r知\r\n周\r一\r晚\r上\r0\r：\r4\r5\r\n"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  } ]
}

2025-11-28 00:26:48 [http-nio-8080-exec-6] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-11-28（星期五）00:26（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-11-28（星期五）00:26，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-11-28（星期五）00:26）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加日程：周\r二\r下\r午\r5\r:\r0\r6\r\nP\r陈\r昊\r天\r\n@\r所\r有\r人\r\n新\r城\r校\r区\r的\r班\r长\r请\r注\r意\r，\r\n明\r天\r中\r午\r1\r2\r:\r3\r0\r-\r1\r3\r:\r3\r0\r召\r开\r寝\r室\r长\r\n培\r训\r会\r，\r地\r点\r另\r行\r通\r知\r\n周\r一\r晚\r上\r0\r：\r4\r5\r\n"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-11-28 00:26:49 [http-nio-8080-exec-6] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-11-28 00:26:49 [http-nio-8080-exec-6] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Thu, 27 Nov 2025 16:26:49 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 1145], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_c8ppgdvo9rfdkn7l21]
- body: {"id":"1cabcea2e33548ccb0d500d2430d968d","object":"chat.completion","created":1764260809,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"","tool_calls":[{"index":-1,"id":"call_c39ded6d39fa453f9e4ef5e2","type":"function","function":{"name":"createSchedule","arguments":"{\"title\": \"周一下午5:06\", \"date\": \"2025-12-01\", \"startTime\": \"17:06\", \"endTime\": \"\", \"location\": \"\", \"isAllDay\": false}"}},{"index":-1,"id":"call_4cfa76242d5e47a5af26a671","type":"function","function":{"name":"createSchedule","arguments":"{\"title\": \"寝室长培训会\", \"date\": \"2025-11-29\", \"startTime\": \"12:30\", \"endTime\": \"13:30\", \"location\": \"\", \"isAllDay\": false}"}},{"index":-1,"id":"call_bc6bbd234a2e43959cb4c0a1","type":"function","function":{"name":"createSchedule","arguments":"{\"title\": \"周一晚上0:45\", \"date\": \"2025-12-01\", \"startTime\": \"00:45\", \"endTime\": \"\", \"location\": \"\", \"isAllDay\": false}"}}]},"finish_reason":"tool_calls"}],"usage":{"prompt_tokens":2168,"completion_tokens":200,"total_tokens":2368},"system_fingerprint":""}

2025-11-28 00:26:49 [http-nio-8080-exec-6] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 533275d0-74d5-4462-a93d-45cd190ba934 内存缓存更新，当前 3 条消息
2025-11-28 00:26:49 [http-nio-8080-exec-6] INFO  c.e.s.service.CalendarTools - 【CalendarTools】createSchedule 被调用 - userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, title: 周一下午5:06, date: 2025-12-01, startTime: 17:06, endTime: , location: , isAllDay: false
2025-11-28 00:26:49 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 标题: 周一下午5:06
2025-11-28 00:26:49 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: 1848cc86-a3f9-443f-ab10-af323041aad9
2025-11-28 00:26:49 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:26:49 [http-nio-8080-exec-6] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 533275d0-74d5-4462-a93d-45cd190ba934 内存缓存更新，当前 4 条消息
2025-11-28 00:26:49 [http-nio-8080-exec-6] INFO  c.e.s.service.CalendarTools - 【CalendarTools】createSchedule 被调用 - userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, title: 寝室长培训会, date: 2025-11-29, startTime: 12:30, endTime: 13:30, location: , isAllDay: false
2025-11-28 00:26:49 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 标题: 寝室长培训会
2025-11-28 00:26:49 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: bc7461d5-015d-401a-a856-cbd05d2a32ee
2025-11-28 00:26:49 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:26:49 [http-nio-8080-exec-6] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 533275d0-74d5-4462-a93d-45cd190ba934 内存缓存更新，当前 5 条消息
2025-11-28 00:26:49 [http-nio-8080-exec-6] INFO  c.e.s.service.CalendarTools - 【CalendarTools】createSchedule 被调用 - userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, title: 周一晚上0:45, date: 2025-12-01, startTime: 00:45, endTime: , location: , isAllDay: false
2025-11-28 00:26:49 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 标题: 周一晚上0:45
2025-11-28 00:26:49 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: 8abb5f9a-9d31-4b19-b7d0-869d0f05fcb2
2025-11-28 00:26:49 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:26:49 [http-nio-8080-exec-6] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 533275d0-74d5-4462-a93d-45cd190ba934 内存缓存更新，当前 6 条消息
2025-11-28 00:26:49 [http-nio-8080-exec-6] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.siliconflow.cn/v1/chat/completions
- headers: [Authorization: Beare...wz], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-11-28（星期五）00:26（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-11-28（星期五）00:26，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-11-28（星期五）00:26）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加日程：周\r二\r下\r午\r5\r:\r0\r6\r\nP\r陈\r昊\r天\r\n@\r所\r有\r人\r\n新\r城\r校\r区\r的\r班\r长\r请\r注\r意\r，\r\n明\r天\r中\r午\r1\r2\r:\r3\r0\r-\r1\r3\r:\r3\r0\r召\r开\r寝\r室\r长\r\n培\r训\r会\r，\r地\r点\r另\r行\r通\r知\r\n周\r一\r晚\r上\r0\r：\r4\r5\r\n"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_c39ded6d39fa453f9e4ef5e2",
      "type" : "function",
      "function" : {
        "name" : "createSchedule",
        "arguments" : "{\"title\": \"周一下午5:06\", \"date\": \"2025-12-01\", \"startTime\": \"17:06\", \"endTime\": \"\", \"location\": \"\", \"isAllDay\": false}"
      }
    }, {
      "id" : "call_4cfa76242d5e47a5af26a671",
      "type" : "function",
      "function" : {
        "name" : "createSchedule",
        "arguments" : "{\"title\": \"寝室长培训会\", \"date\": \"2025-11-29\", \"startTime\": \"12:30\", \"endTime\": \"13:30\", \"location\": \"\", \"isAllDay\": false}"
      }
    }, {
      "id" : "call_bc6bbd234a2e43959cb4c0a1",
      "type" : "function",
      "function" : {
        "name" : "createSchedule",
        "arguments" : "{\"title\": \"周一晚上0:45\", \"date\": \"2025-12-01\", \"startTime\": \"00:45\", \"endTime\": \"\", \"location\": \"\", \"isAllDay\": false}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_c39ded6d39fa453f9e4ef5e2",
    "content" : "✅ 日程创建成功！\n📅 标题：周一下午5:06\n📆 日期：2025-12-01\n⏰ 时间：17:06 - 未设置"
  }, {
    "role" : "tool",
    "tool_call_id" : "call_4cfa76242d5e47a5af26a671",
    "content" : "✅ 日程创建成功！\n📅 标题：寝室长培训会\n📆 日期：2025-11-29\n⏰ 时间：12:30 - 13:30"
  }, {
    "role" : "tool",
    "tool_call_id" : "call_bc6bbd234a2e43959cb4c0a1",
    "content" : "✅ 日程创建成功！\n📅 标题：周一晚上0:45\n📆 日期：2025-12-01\n⏰ 时间：00:45 - 未设置"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  } ]
}

2025-11-28 00:26:49 [http-nio-8080-exec-6] DEBUG o.s.web.client.DefaultRestClient - Writing [{
  "model" : "Qwen/Qwen3-Next-80B-A3B-Instruct",
  "messages" : [ {
    "role" : "system",
    "content" : "你是 SpeedCalendar 智能日程助手。当前时间是 2025-11-28（星期五）00:26（格式：日期（星期）时间）。\n\n# 核心原则\n1. 用户表达日程相关意图时，**必须立即调用对应工具**，禁止只回复文字而不执行操作。\n2. **禁止反问用户**：无论信息是否完整，都必须直接执行操作，使用合理默认值填充缺失信息。\n3. 遇到多个日程信息时，**逐个创建所有日程**，不要询问用户选择。\n4. **禁止返回URL、链接、网址**：你不能搜索网络，不能返回任何http链接。\n5. **只处理日程相关任务**：如果文本中没有可识别的日程信息，直接告诉用户\"未识别到日程信息\"。\n\n# ⚠️ 严重警告\n- **你必须通过工具调用(function call)来执行日程操作**\n- **禁止伪装成功**：绝对不能自己编造\"创建成功\"、\"已添加\"等回复，必须真正调用 createSchedule 工具\n- 如果你没有调用工具就回复\"成功\"，这是严重错误\n- 只有工具返回结果后，才能告诉用户操作结果\n\n# 处理OCR/截图/多日程文本的特殊规则\n当用户发送的内容看起来是OCR识别结果、截图文字、或包含多个日程信息时：\n- **直接提取所有日程信息并逐一创建**，不要询问\"您想创建哪个\"\n- 如果某些信息模糊，使用合理推测，不要要求澄清\n- 忽略与日程无关的内容（如广告、签名、页眉页脚等）\n- 时间模糊时优先设为全天日程\n- 日期不明确时默认使用提到的最近日期或今天\n\n# 工具使用规则\n\n## 1. createSchedule（创建日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"添加日程\"、\"创建日程\"、\"新建日程\"、\"记一下\"、\"安排\"、\"提醒我\"\n- 描述了某个时间要做某事的意图\n- **文本中包含任何看起来像日程/事件/约会/会议的信息**\n\n### 参数说明\n| 参数 | 必填 | 说明 |\n|------|------|------|\n| title | 是 | 日程标题 |\n| date | 是 | 格式yyyy-MM-dd，今天=2025-11-28（星期五）00:26，明天=+1天 |\n| startTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| endTime | 否 | 格式HH:mm，没有则传空字符串\"\" |\n| location | 否 | 地点，没有则传空字符串\"\" |\n| isAllDay | 是 | 有具体时间=false，无具体时间=true |\n\n### 智能默认值（信息不完整时使用）\n- 没有明确日期 → 使用当前日期\n- 只有\"上午\"/\"下午\"/\"晚上\" → 上午09:00，下午14:00，晚上19:00\n- 没有时间 → isAllDay=true\n- 没有地点 → location=\"\"\n\n### 相对时间计算（基于当前时间 2025-11-28（星期五）00:26）\n- \"X小时后\"/\"X分钟后\" → 当前时间 + X，计算出具体的 date 和 startTime\n- \"明天\" → 当前日期 + 1天\n- \"后天\" → 当前日期 + 2天\n- \"下周X\" → 计算到下一个星期X的日期\n- \"这周X\" → 计算到本周星期X的日期\n\n### 示例\n- \"明天下午两点去健身房\" → title=\"去健身房\", date=\"2025-11-27\", startTime=\"14:00\", endTime=\"\", location=\"健身房\", isAllDay=false\n- \"后天提醒我交报告\" → title=\"交报告\", date=\"2025-11-28\", startTime=\"\", endTime=\"\", location=\"\", isAllDay=true\n\n## 2. querySchedulesByDate（查询日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"查看日程\"、\"查询日程\"、\"有什么安排\"、\"有什么事\"、\"日程列表\"\n- 询问某段时间的安排\n\n### 参数说明\n- year: 年份，如 2025\n- month: 月份 1-12\n\n### 默认值\n- 没指定月份 → 使用当前月\n- 没指定年份 → 使用当前年\n\n## 3. deleteSchedule（删除日程）\n\n### 触发条件（满足任一即调用）\n- 包含\"删除日程\"、\"取消日程\"、\"删掉\"、\"不要了\"、\"取消\"\n- 明确表达要移除某个日程\n\n### 参数说明\n- titleKeyword: 日程标题的关键词，如\"健身\"、\"开会\"、\"约会\"\n\n### 示例\n- \"删除健身房的日程\" → titleKeyword=\"健身房\"\n- \"删除开会\" → titleKeyword=\"开会\"\n\n## 4. deleteScheduleByIndex（按序号删除）\n\n### 触发条件\n- 用户说\"删除第X个\"、\"第X个\"\n- 通常在 deleteSchedule 返回多个匹配结果后使用\n\n### 参数说明\n- titleKeyword: 与之前查询相同的关键词\n- index: 用户指定的序号，从1开始\n\n# 回复规范\n- 工具执行成功：简洁确认，如\"✅ 已添加日程：明天下午3点 开会\"\n- 多个日程创建成功：列出所有已创建的日程\n- 工具执行失败：说明原因，给出建议\n- 非日程问题：友好回答，适当引导使用日程功能\n- **永远不要说\"请问您想创建哪一个\"、\"需要我帮您创建吗\"之类的反问句**\n"
  }, {
    "role" : "user",
    "content" : "帮我添加日程：周\r二\r下\r午\r5\r:\r0\r6\r\nP\r陈\r昊\r天\r\n@\r所\r有\r人\r\n新\r城\r校\r区\r的\r班\r长\r请\r注\r意\r，\r\n明\r天\r中\r午\r1\r2\r:\r3\r0\r-\r1\r3\r:\r3\r0\r召\r开\r寝\r室\r长\r\n培\r训\r会\r，\r地\r点\r另\r行\r通\r知\r\n周\r一\r晚\r上\r0\r：\r4\r5\r\n"
  }, {
    "role" : "assistant",
    "tool_calls" : [ {
      "id" : "call_c39ded6d39fa453f9e4ef5e2",
      "type" : "function",
      "function" : {
        "name" : "createSchedule",
        "arguments" : "{\"title\": \"周一下午5:06\", \"date\": \"2025-12-01\", \"startTime\": \"17:06\", \"endTime\": \"\", \"location\": \"\", \"isAllDay\": false}"
      }
    }, {
      "id" : "call_4cfa76242d5e47a5af26a671",
      "type" : "function",
      "function" : {
        "name" : "createSchedule",
        "arguments" : "{\"title\": \"寝室长培训会\", \"date\": \"2025-11-29\", \"startTime\": \"12:30\", \"endTime\": \"13:30\", \"location\": \"\", \"isAllDay\": false}"
      }
    }, {
      "id" : "call_bc6bbd234a2e43959cb4c0a1",
      "type" : "function",
      "function" : {
        "name" : "createSchedule",
        "arguments" : "{\"title\": \"周一晚上0:45\", \"date\": \"2025-12-01\", \"startTime\": \"00:45\", \"endTime\": \"\", \"location\": \"\", \"isAllDay\": false}"
      }
    } ]
  }, {
    "role" : "tool",
    "tool_call_id" : "call_c39ded6d39fa453f9e4ef5e2",
    "content" : "✅ 日程创建成功！\n📅 标题：周一下午5:06\n📆 日期：2025-12-01\n⏰ 时间：17:06 - 未设置"
  }, {
    "role" : "tool",
    "tool_call_id" : "call_4cfa76242d5e47a5af26a671",
    "content" : "✅ 日程创建成功！\n📅 标题：寝室长培训会\n📆 日期：2025-11-29\n⏰ 时间：12:30 - 13:30"
  }, {
    "role" : "tool",
    "tool_call_id" : "call_bc6bbd234a2e43959cb4c0a1",
    "content" : "✅ 日程创建成功！\n📅 标题：周一晚上0:45\n📆 日期：2025-12-01\n⏰ 时间：00:45 - 未设置"
  } ],
  "stream" : false,
  "tools" : [ {
    "type" : "function",
    "function" : {
      "name" : "deleteSchedule",
      "description" : "删除日程。用户说删除/取消/删掉某个日程时调用。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "要删除的日程标题关键词，如健身、开会"
          }
        },
        "required" : [ "titleKeyword" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "createSchedule",
      "description" : "创建一个新的日程安排。当用户说'帮我添加日程'、'创建日程'、'新建日程'或表达想要添加日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "title" : {
            "type" : "string",
            "description" : "日程标题，必填"
          },
          "date" : {
            "type" : "string",
            "description" : "日程日期，必填，格式yyyy-MM-dd"
          },
          "startTime" : {
            "type" : "string",
            "description" : "开始时间，可选，格式HH:mm如14:00，没有则传空字符串"
          },
          "endTime" : {
            "type" : "string",
            "description" : "结束时间，可选，格式HH:mm，没有则传空字符串"
          },
          "location" : {
            "type" : "string",
            "description" : "地点，可选，没有则传空字符串"
          },
          "isAllDay" : {
            "type" : "boolean",
            "description" : "是否全天，有具体时间传false，没有具体时间传true"
          }
        },
        "required" : [ "title", "date", "startTime", "endTime", "location", "isAllDay" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "querySchedulesByDate",
      "description" : "查询指定月份的日程列表。当用户说'查看日程'、'我有什么安排'、'这个月的日程'或表达想要查看日程的意图时调用此工具。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "year" : {
            "type" : "integer",
            "description" : "年份，例如 2025"
          },
          "month" : {
            "type" : "integer",
            "description" : "月份，1-12，例如 11 表示十一月"
          }
        },
        "required" : [ "year", "month" ]
      }
    }
  }, {
    "type" : "function",
    "function" : {
      "name" : "deleteScheduleByIndex",
      "description" : "当用户说'删除第X个'时调用此工具，用于在多个匹配日程中按序号删除。",
      "parameters" : {
        "type" : "object",
        "properties" : {
          "titleKeyword" : {
            "type" : "string",
            "description" : "日程标题关键词，与之前查询时相同"
          },
          "index" : {
            "type" : "integer",
            "description" : "要删除的日程序号，从1开始"
          }
        },
        "required" : [ "titleKeyword", "index" ]
      }
    }
  } ]
}] as "application/json" with org.springframework.http.converter.StringHttpMessageConverter
2025-11-28 00:26:50 [http-nio-8080-exec-6] DEBUG o.s.web.client.DefaultRestClient - Reading to [java.lang.String] as "application/json;charset=utf-8"
2025-11-28 00:26:50 [http-nio-8080-exec-6] INFO  d.l.h.client.log.LoggingHttpClient - HTTP response:
- status code: 200
- headers: [Date: Thu, 27 Nov 2025 16:26:49 GMT], [Content-Type: application/json; charset=utf-8], [Content-Length: 479], [Connection: keep-alive], [X-Siliconcloud-Trace-Id: ti_fvxtdqliy0bj3sy7ck]
- body: {"id":"bedb5c8ee3b943f1ab3cd839f4d39e8e","object":"chat.completion","created":1764260809,"model":"Qwen/Qwen3-Next-80B-A3B-Instruct","choices":[{"index":0,"message":{"role":"assistant","content":"✅ 已添加日程：\n- 周一下午5:06（2025-12-01 17:06）\n- 寝室长培训会（2025-11-29 12:30 - 13:30）\n- 周一晚上0:45（2025-12-01 00:45）"},"finish_reason":"stop"}],"usage":{"prompt_tokens":2531,"completion_tokens":96,"total_tokens":2627},"system_fingerprint":""}

2025-11-28 00:26:50 [http-nio-8080-exec-6] DEBUG c.e.s.s.DatabaseChatMemoryStore - 【ChatMemoryStore】会话 533275d0-74d5-4462-a93d-45cd190ba934 内存缓存更新，当前 7 条消息
2025-11-28 00:26:50 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:26:50 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        chat_messages
        (content, created_at, role, sequence_num, session_id, tokens_used, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?)
2025-11-28 00:26:50 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    update
        chat_sessions 
    set
        is_deleted=?,
        last_message_at=?,
        message_count=?,
        status=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        session_id=?
2025-11-28 00:26:50 [http-nio-8080-exec-6] INFO  c.e.s.service.AiChatService - 会话 533275d0-74d5-4462-a93d-45cd190ba934 完成一轮对话，当前消息数: 4
2025-11-28 00:26:50 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 00:26:50 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=发送成功, data=ChatMessageResponse(sessionId=533275d0-74d5-4462-a93d-45cd1 (truncated)...]
2025-11-28 00:26:50 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 00:28:33 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-28 00:28:33 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-28 00:28:33 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 00:28:33 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-28 00:28:33 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-28 17:19:02 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.8 with PID 40816 (E:\develop\Android Studio\workspace\SpeedCalendar-server\target\classes started by jiang in E:\develop\Android Studio\workspace\SpeedCalendar-server)
2025-11-28 17:19:02 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-28 17:19:02 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-28 17:19:02 [restartedMain] INFO  o.s.b.d.restart.ChangeableUrls - The Class-Path manifest attribute in C:\Users\jiang\.m2\repository\org\apache\opennlp\opennlp-tools\2.5.4\opennlp-tools-2.5.4.jar referenced one or more files that do not exist: file:/C:/Users/jiang/.m2/repository/org/apache/opennlp/opennlp-tools/2.5.4/slf4j-api-2.0.17.jar
2025-11-28 17:19:02 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-28 17:19:02 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-28 17:19:03 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 17:19:03 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-28 17:19:03 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 153 ms. Found 7 JPA repository interfaces.
2025-11-28 17:19:03 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 17:19:03 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-28 17:19:03 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 17:19:03 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 17:19:03 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 17:19:03 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 17:19:03 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 17:19:03 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 17:19:03 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 17:19:03 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 6 ms. Found 0 Redis repository interfaces.
2025-11-28 17:19:04 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-28 17:19:04 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-28 17:19:04 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-28 17:19:04 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-28 17:19:04 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1669 ms
2025-11-28 17:19:04 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-28 17:19:04 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-28 17:19:04 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-28 17:19:04 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-28 17:19:04 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-28 17:19:05 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@416a5b9c
2025-11-28 17:19:05 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-28 17:19:05 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-28 17:19:05 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-11-28 17:19:05 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-28 17:19:06 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-28 17:19:06 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 17:19:06 [restartedMain] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-28 17:19:07 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 17:19:07 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-11-28 17:19:07 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-11-28 17:19:07 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-11-28 17:19:07 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-11-28 17:19:07 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-11-28 17:19:07 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 17:19:07 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-11-28 17:19:07 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-11-28 17:19:07 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-28 17:19:07 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 23 mappings in 'requestMappingHandlerMapping'
2025-11-28 17:19:07 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-11-28 17:19:07 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-11-28 17:19:07 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-11-28 17:19:08 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-28 17:19:08 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-28 17:19:08 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 6.573 seconds (process running for 7.883)
2025-11-28 17:19:49 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-28 17:19:49 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-28 17:19:49 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-11-28 17:19:49 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-11-28 17:19:49 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-11-28 17:19:49 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@46ef8638
2025-11-28 17:19:49 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@35dac2
2025-11-28 17:19:49 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-11-28 17:19:49 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-28 17:19:49 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ai/chat/sessions", parameters={}
2025-11-28 17:19:50 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#getSessions(HttpServletRequest)
2025-11-28 17:19:50 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:19:50 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=401, message=未授权，请先登录, data=null)]
2025-11-28 17:19:50 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 17:19:50 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/refresh", parameters={}
2025-11-28 17:19:50 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#refreshToken(RefreshTokenRequest, HttpServletRequest)
2025-11-28 17:19:50 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=utf-8" to [RefreshTokenRequest(refreshToken=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJiY2Y1ZGM2ZC0wMTA3LTQ1NzgtYjE1MC03Mm (truncated)...]
2025-11-28 17:19:50 [http-nio-8080-exec-3] INFO  c.e.s.controller.AuthController - 【刷新Token】IP: 192.168.43.1
2025-11-28 17:19:50 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        ut1_0.id,
        ut1_0.access_token,
        ut1_0.access_token_expires_at,
        ut1_0.created_at,
        ut1_0.device_id,
        ut1_0.device_type,
        ut1_0.ip_address,
        ut1_0.refresh_token,
        ut1_0.refresh_token_expires_at,
        ut1_0.status,
        ut1_0.updated_at,
        ut1_0.user_agent,
        ut1_0.user_id 
    from
        user_tokens ut1_0 
    where
        ut1_0.refresh_token=?
2025-11-28 17:19:50 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-28 17:19:50 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_tokens
        (access_token, access_token_expires_at, created_at, device_id, device_type, ip_address, refresh_token, refresh_token_expires_at, status, updated_at, user_agent, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 17:19:50 [http-nio-8080-exec-3] INFO  c.e.s.service.AuthService - 【刷新Token成功】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef
2025-11-28 17:19:50 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    update
        user_tokens 
    set
        access_token=?,
        access_token_expires_at=?,
        device_id=?,
        device_type=?,
        ip_address=?,
        refresh_token=?,
        refresh_token_expires_at=?,
        status=?,
        updated_at=?,
        user_agent=?,
        user_id=? 
    where
        id=?
2025-11-28 17:19:50 [http-nio-8080-exec-3] INFO  c.e.s.controller.AuthController - 【刷新Token成功】
2025-11-28 17:19:50 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:19:50 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=刷新成功, data=RefreshTokenResponse(token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ (truncated)...]
2025-11-28 17:19:50 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 17:19:51 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ai/chat/sessions", parameters={}
2025-11-28 17:19:51 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AiChatController#getSessions(HttpServletRequest)
2025-11-28 17:19:51 [http-nio-8080-exec-4] INFO  c.e.s.controller.AiChatController - 【获取会话列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef
2025-11-28 17:19:51 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        cs1_0.session_id,
        cs1_0.created_at,
        cs1_0.is_deleted,
        cs1_0.last_message_at,
        cs1_0.message_count,
        cs1_0.status,
        cs1_0.title,
        cs1_0.updated_at,
        cs1_0.user_id 
    from
        chat_sessions cs1_0 
    where
        cs1_0.user_id=? 
        and cs1_0.is_deleted=? 
    order by
        cs1_0.last_message_at desc,
        cs1_0.created_at desc
2025-11-28 17:19:51 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-11-28 17:19:51 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-11-28 17:19:51 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-11-28 17:19:51 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        cm1_0.id,
        cm1_0.content,
        cm1_0.created_at,
        cm1_0.role,
        cm1_0.sequence_num,
        cm1_0.session_id,
        cm1_0.tokens_used,
        cm1_0.user_id 
    from
        chat_messages cm1_0 
    where
        cm1_0.session_id=? 
    order by
        cm1_0.sequence_num desc 
    limit
        1
2025-11-28 17:19:51 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:19:51 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ChatSessionDTO(id=533275d0-74d5-4462-a93d-45cd190ba934, ti (truncated)...]
2025-11-28 17:19:51 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 17:19:59 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 17:19:59 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 17:19:59 [http-nio-8080-exec-2] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 17:19:59 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 17:19:59 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 17:19:59 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:19:59 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=2c10e514-bef7-4beb-ab4e-a5477712ffd (truncated)...]
2025-11-28 17:19:59 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 17:20:15 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-28 17:20:15 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-28 17:20:15 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=开会, scheduleDate=2025-11-28, startTime=09:00, endTime=null, location=203 (truncated)...]
2025-11-28 17:20:15 [http-nio-8080-exec-5] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, title: 开会
2025-11-28 17:20:15 [http-nio-8080-exec-5] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 标题: 开会
2025-11-28 17:20:15 [http-nio-8080-exec-5] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: 43fbf58d-441a-4fe9-ba24-adc035fb5d48
2025-11-28 17:20:15 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 17:20:15 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:20:15 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=创建成功, data=ScheduleDTO(scheduleId=43fbf58d-441a-4fe9-ba24-adc035fb5d48 (truncated)...]
2025-11-28 17:20:15 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 17:20:16 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 17:20:16 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 17:20:16 [http-nio-8080-exec-6] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 17:20:16 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 17:20:16 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 17:20:16 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:20:16 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=43fbf58d-441a-4fe9-ba24-adc035fb5d4 (truncated)...]
2025-11-28 17:20:16 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 17:22:17 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 17:22:17 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 17:22:17 [http-nio-8080-exec-8] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 17:22:17 [http-nio-8080-exec-8] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 17:22:17 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 17:22:17 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:22:17 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=43fbf58d-441a-4fe9-ba24-adc035fb5d4 (truncated)...]
2025-11-28 17:22:17 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 17:24:00 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 17:24:00 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 17:24:00 [http-nio-8080-exec-1] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 17:24:00 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 17:24:00 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 17:24:00 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:24:00 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=43fbf58d-441a-4fe9-ba24-adc035fb5d4 (truncated)...]
2025-11-28 17:24:00 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 17:26:14 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 17:26:14 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 17:26:14 [http-nio-8080-exec-4] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 17:26:14 [http-nio-8080-exec-4] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 17:26:14 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 17:26:14 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:26:14 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=43fbf58d-441a-4fe9-ba24-adc035fb5d4 (truncated)...]
2025-11-28 17:26:14 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 17:26:29 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/schedules/43fbf58d-441a-4fe9-ba24-adc035fb5d48", parameters={}
2025-11-28 17:26:29 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#deleteSchedule(String, HttpServletRequest)
2025-11-28 17:26:29 [http-nio-8080-exec-2] INFO  c.e.s.controller.ScheduleController - 【删除日程】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, scheduleId: 43fbf58d-441a-4fe9-ba24-adc035fb5d48
2025-11-28 17:26:29 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 删除日程 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 日程ID: 43fbf58d-441a-4fe9-ba24-adc035fb5d48
2025-11-28 17:26:29 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.schedule_id=? 
        and s1_0.user_id=? 
        and s1_0.is_deleted=?
2025-11-28 17:26:29 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 日程删除成功 - 日程ID: 43fbf58d-441a-4fe9-ba24-adc035fb5d48
2025-11-28 17:26:29 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    update
        schedules 
    set
        end_time=?,
        is_all_day=?,
        is_deleted=?,
        location=?,
        schedule_date=?,
        start_time=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        schedule_id=?
2025-11-28 17:26:29 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:26:29 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=删除成功, data=null)]
2025-11-28 17:26:29 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 17:26:33 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/schedules/2c10e514-bef7-4beb-ab4e-a5477712ffd9", parameters={}
2025-11-28 17:26:33 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#deleteSchedule(String, HttpServletRequest)
2025-11-28 17:26:33 [http-nio-8080-exec-5] INFO  c.e.s.controller.ScheduleController - 【删除日程】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, scheduleId: 2c10e514-bef7-4beb-ab4e-a5477712ffd9
2025-11-28 17:26:33 [http-nio-8080-exec-5] INFO  c.e.s.service.ScheduleService - 删除日程 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 日程ID: 2c10e514-bef7-4beb-ab4e-a5477712ffd9
2025-11-28 17:26:33 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.schedule_id=? 
        and s1_0.user_id=? 
        and s1_0.is_deleted=?
2025-11-28 17:26:33 [http-nio-8080-exec-5] INFO  c.e.s.service.ScheduleService - 日程删除成功 - 日程ID: 2c10e514-bef7-4beb-ab4e-a5477712ffd9
2025-11-28 17:26:33 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    update
        schedules 
    set
        end_time=?,
        is_all_day=?,
        is_deleted=?,
        location=?,
        schedule_date=?,
        start_time=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        schedule_id=?
2025-11-28 17:26:33 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:26:33 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=删除成功, data=null)]
2025-11-28 17:26:33 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 17:26:36 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/schedules/bc7461d5-015d-401a-a856-cbd05d2a32ee", parameters={}
2025-11-28 17:26:36 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#deleteSchedule(String, HttpServletRequest)
2025-11-28 17:26:36 [http-nio-8080-exec-6] INFO  c.e.s.controller.ScheduleController - 【删除日程】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, scheduleId: bc7461d5-015d-401a-a856-cbd05d2a32ee
2025-11-28 17:26:36 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 删除日程 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 日程ID: bc7461d5-015d-401a-a856-cbd05d2a32ee
2025-11-28 17:26:36 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.schedule_id=? 
        and s1_0.user_id=? 
        and s1_0.is_deleted=?
2025-11-28 17:26:36 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 日程删除成功 - 日程ID: bc7461d5-015d-401a-a856-cbd05d2a32ee
2025-11-28 17:26:36 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    update
        schedules 
    set
        end_time=?,
        is_all_day=?,
        is_deleted=?,
        location=?,
        schedule_date=?,
        start_time=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        schedule_id=?
2025-11-28 17:26:36 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:26:36 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=删除成功, data=null)]
2025-11-28 17:26:36 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 17:50:50 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 17:50:50 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 17:50:50 [http-nio-8080-exec-9] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 17:50:50 [http-nio-8080-exec-9] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 17:50:50 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 17:50:51 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:50:51 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 17:50:51 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 17:51:02 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-28 17:51:02 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-28 17:51:02 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=你好, scheduleDate=2025-11-28, startTime=09:00, endTime=null, location=你好, (truncated)...]
2025-11-28 17:51:02 [http-nio-8080-exec-8] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, title: 你好
2025-11-28 17:51:02 [http-nio-8080-exec-8] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 标题: 你好
2025-11-28 17:51:02 [http-nio-8080-exec-8] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: dff0d742-ed8b-41e3-86fd-d3360fca43fe
2025-11-28 17:51:02 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 17:51:02 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:51:02 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=创建成功, data=ScheduleDTO(scheduleId=dff0d742-ed8b-41e3-86fd-d3360fca43fe (truncated)...]
2025-11-28 17:51:02 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 17:51:03 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 17:51:03 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 17:51:03 [http-nio-8080-exec-10] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 17:51:03 [http-nio-8080-exec-10] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 17:51:03 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 17:51:03 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:51:03 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=dff0d742-ed8b-41e3-86fd-d3360fca43f (truncated)...]
2025-11-28 17:51:03 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 17:51:35 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 17:51:35 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 17:51:35 [http-nio-8080-exec-3] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 17:51:35 [http-nio-8080-exec-3] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 17:51:35 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 17:51:35 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:51:35 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=dff0d742-ed8b-41e3-86fd-d3360fca43f (truncated)...]
2025-11-28 17:51:35 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 17:51:48 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 17:51:48 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 17:51:48 [http-nio-8080-exec-4] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 17:51:48 [http-nio-8080-exec-4] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 17:51:48 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 17:51:48 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:51:48 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=dff0d742-ed8b-41e3-86fd-d3360fca43f (truncated)...]
2025-11-28 17:51:48 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 17:55:12 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 17:55:12 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 17:55:12 [http-nio-8080-exec-5] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 17:55:12 [http-nio-8080-exec-5] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 17:55:12 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 17:55:12 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:55:12 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=dff0d742-ed8b-41e3-86fd-d3360fca43f (truncated)...]
2025-11-28 17:55:12 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 17:55:18 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 17:55:18 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 17:55:18 [http-nio-8080-exec-7] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 17:55:18 [http-nio-8080-exec-7] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 17:55:18 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 17:55:18 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 17:55:18 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=dff0d742-ed8b-41e3-86fd-d3360fca43f (truncated)...]
2025-11-28 17:55:18 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:00:58 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 18:00:58 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 18:00:58 [http-nio-8080-exec-8] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 18:00:58 [http-nio-8080-exec-8] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 18:00:58 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 18:00:58 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:00:58 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=dff0d742-ed8b-41e3-86fd-d3360fca43f (truncated)...]
2025-11-28 18:00:58 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:01:08 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 18:01:08 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 18:01:08 [http-nio-8080-exec-10] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 18:01:08 [http-nio-8080-exec-10] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 18:01:08 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 18:01:08 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:01:08 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=dff0d742-ed8b-41e3-86fd-d3360fca43f (truncated)...]
2025-11-28 18:01:08 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:01:11 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 18:01:11 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 18:01:11 [http-nio-8080-exec-1] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 18:01:11 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 18:01:11 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 18:01:11 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:01:11 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=dff0d742-ed8b-41e3-86fd-d3360fca43f (truncated)...]
2025-11-28 18:01:11 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:01:14 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 18:01:14 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 18:01:14 [http-nio-8080-exec-3] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 18:01:14 [http-nio-8080-exec-3] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 18:01:14 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 18:01:14 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:01:14 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=dff0d742-ed8b-41e3-86fd-d3360fca43f (truncated)...]
2025-11-28 18:01:14 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:01:17 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 18:01:17 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 18:01:17 [http-nio-8080-exec-4] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 18:01:17 [http-nio-8080-exec-4] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 18:01:17 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 18:01:17 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:01:17 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=dff0d742-ed8b-41e3-86fd-d3360fca43f (truncated)...]
2025-11-28 18:01:17 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:01:22 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/schedules/dff0d742-ed8b-41e3-86fd-d3360fca43fe", parameters={}
2025-11-28 18:01:22 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#deleteSchedule(String, HttpServletRequest)
2025-11-28 18:01:22 [http-nio-8080-exec-2] INFO  c.e.s.controller.ScheduleController - 【删除日程】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, scheduleId: dff0d742-ed8b-41e3-86fd-d3360fca43fe
2025-11-28 18:01:22 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 删除日程 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 日程ID: dff0d742-ed8b-41e3-86fd-d3360fca43fe
2025-11-28 18:01:22 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.schedule_id=? 
        and s1_0.user_id=? 
        and s1_0.is_deleted=?
2025-11-28 18:01:22 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 日程删除成功 - 日程ID: dff0d742-ed8b-41e3-86fd-d3360fca43fe
2025-11-28 18:01:22 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    update
        schedules 
    set
        end_time=?,
        is_all_day=?,
        is_deleted=?,
        location=?,
        schedule_date=?,
        start_time=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        schedule_id=?
2025-11-28 18:01:22 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:01:22 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=删除成功, data=null)]
2025-11-28 18:01:22 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:01:22 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 18:01:22 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 18:01:22 [http-nio-8080-exec-5] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 18:01:22 [http-nio-8080-exec-5] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 18:01:22 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 18:01:22 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:01:22 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 18:01:22 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:01:31 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-28 18:01:31 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-28 18:01:31 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=哈哈, scheduleDate=2025-11-28, startTime=09:00, endTime=null, location=, i (truncated)...]
2025-11-28 18:01:31 [http-nio-8080-exec-6] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, title: 哈哈
2025-11-28 18:01:31 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 标题: 哈哈
2025-11-28 18:01:31 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: ebb9e683-d795-474f-988e-4179e3c5d1d2
2025-11-28 18:01:31 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 18:01:31 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:01:31 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=创建成功, data=ScheduleDTO(scheduleId=ebb9e683-d795-474f-988e-4179e3c5d1d2 (truncated)...]
2025-11-28 18:01:31 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:01:31 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 18:01:31 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 18:01:31 [http-nio-8080-exec-7] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 18:01:31 [http-nio-8080-exec-7] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 18:01:31 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 18:01:31 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:01:31 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=ebb9e683-d795-474f-988e-4179e3c5d1d (truncated)...]
2025-11-28 18:01:31 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:04:04 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 18:04:04 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 18:04:04 [http-nio-8080-exec-8] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 18:04:04 [http-nio-8080-exec-8] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 18:04:04 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 18:04:04 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:04:04 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=ebb9e683-d795-474f-988e-4179e3c5d1d (truncated)...]
2025-11-28 18:04:04 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:04:09 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 18:04:09 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 18:04:09 [http-nio-8080-exec-10] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 18:04:09 [http-nio-8080-exec-10] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 18:04:09 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 18:04:09 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:04:09 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=ebb9e683-d795-474f-988e-4179e3c5d1d (truncated)...]
2025-11-28 18:04:09 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:04:18 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - PUT "/api/schedules/ebb9e683-d795-474f-988e-4179e3c5d1d2", parameters={}
2025-11-28 18:04:18 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#updateSchedule(String, UpdateScheduleRequest, HttpServletRequest)
2025-11-28 18:04:18 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [UpdateScheduleRequest(title=哈哈, scheduleDate=2025-11-28, startTime=09:00, endTime=null, location=啊？, (truncated)...]
2025-11-28 18:04:18 [http-nio-8080-exec-1] INFO  c.e.s.controller.ScheduleController - 【更新日程】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, scheduleId: ebb9e683-d795-474f-988e-4179e3c5d1d2
2025-11-28 18:04:18 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 更新日程 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 日程ID: ebb9e683-d795-474f-988e-4179e3c5d1d2
2025-11-28 18:04:18 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.schedule_id=? 
        and s1_0.user_id=? 
        and s1_0.is_deleted=?
2025-11-28 18:04:18 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 日程更新成功 - 日程ID: ebb9e683-d795-474f-988e-4179e3c5d1d2
2025-11-28 18:04:18 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    update
        schedules 
    set
        end_time=?,
        is_all_day=?,
        is_deleted=?,
        location=?,
        schedule_date=?,
        start_time=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        schedule_id=?
2025-11-28 18:04:18 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:04:18 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=更新成功, data=ScheduleDTO(scheduleId=ebb9e683-d795-474f-988e-4179e3c5d1d2 (truncated)...]
2025-11-28 18:04:18 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:04:19 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 18:04:19 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 18:04:19 [http-nio-8080-exec-3] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 18:04:19 [http-nio-8080-exec-3] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 18:04:19 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 18:04:19 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:04:19 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=ebb9e683-d795-474f-988e-4179e3c5d1d (truncated)...]
2025-11-28 18:04:19 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:04:22 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/schedules/ebb9e683-d795-474f-988e-4179e3c5d1d2", parameters={}
2025-11-28 18:04:22 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#deleteSchedule(String, HttpServletRequest)
2025-11-28 18:04:22 [http-nio-8080-exec-4] INFO  c.e.s.controller.ScheduleController - 【删除日程】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, scheduleId: ebb9e683-d795-474f-988e-4179e3c5d1d2
2025-11-28 18:04:22 [http-nio-8080-exec-4] INFO  c.e.s.service.ScheduleService - 删除日程 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 日程ID: ebb9e683-d795-474f-988e-4179e3c5d1d2
2025-11-28 18:04:22 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.schedule_id=? 
        and s1_0.user_id=? 
        and s1_0.is_deleted=?
2025-11-28 18:04:22 [http-nio-8080-exec-4] INFO  c.e.s.service.ScheduleService - 日程删除成功 - 日程ID: ebb9e683-d795-474f-988e-4179e3c5d1d2
2025-11-28 18:04:22 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    update
        schedules 
    set
        end_time=?,
        is_all_day=?,
        is_deleted=?,
        location=?,
        schedule_date=?,
        start_time=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        schedule_id=?
2025-11-28 18:04:22 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:04:22 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=删除成功, data=null)]
2025-11-28 18:04:22 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:04:23 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 18:04:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 18:04:23 [http-nio-8080-exec-2] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 18:04:23 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 18:04:23 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 18:04:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:04:23 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 18:04:23 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:08:34 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 18:08:34 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 18:08:34 [http-nio-8080-exec-6] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 18:08:34 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 18:08:34 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 18:08:34 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:08:34 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 18:08:34 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:08:44 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/schedules", parameters={}
2025-11-28 18:08:44 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#createSchedule(CreateScheduleRequest, HttpServletRequest)
2025-11-28 18:08:44 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateScheduleRequest(title=bsjsja, scheduleDate=2025-11-28, startTime=09:00, endTime=null, location (truncated)...]
2025-11-28 18:08:44 [http-nio-8080-exec-7] INFO  c.e.s.controller.ScheduleController - 【创建日程】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, title: bsjsja
2025-11-28 18:08:45 [http-nio-8080-exec-7] INFO  c.e.s.service.ScheduleService - 创建日程 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 标题: bsjsja
2025-11-28 18:08:45 [http-nio-8080-exec-7] INFO  c.e.s.service.ScheduleService - 日程创建成功 - 日程ID: c6b4a50e-2405-4935-8a0d-53189fa32c2d
2025-11-28 18:08:45 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    insert 
    into
        schedules
        (created_at, end_time, is_all_day, is_deleted, location, schedule_date, start_time, title, updated_at, user_id, schedule_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 18:08:45 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:08:45 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=创建成功, data=ScheduleDTO(scheduleId=c6b4a50e-2405-4935-8a0d-53189fa32c2d (truncated)...]
2025-11-28 18:08:45 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:08:45 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 18:08:45 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 18:08:45 [http-nio-8080-exec-9] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 18:08:45 [http-nio-8080-exec-9] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 18:08:45 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 18:08:45 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:08:45 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=c6b4a50e-2405-4935-8a0d-53189fa32c2 (truncated)...]
2025-11-28 18:08:45 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:08:50 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - PUT "/api/schedules/c6b4a50e-2405-4935-8a0d-53189fa32c2d", parameters={}
2025-11-28 18:08:50 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#updateSchedule(String, UpdateScheduleRequest, HttpServletRequest)
2025-11-28 18:08:50 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [UpdateScheduleRequest(title=bsjsja, scheduleDate=2025-11-28, startTime=09:00, endTime=null, location (truncated)...]
2025-11-28 18:08:50 [http-nio-8080-exec-8] INFO  c.e.s.controller.ScheduleController - 【更新日程】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, scheduleId: c6b4a50e-2405-4935-8a0d-53189fa32c2d
2025-11-28 18:08:50 [http-nio-8080-exec-8] INFO  c.e.s.service.ScheduleService - 更新日程 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 日程ID: c6b4a50e-2405-4935-8a0d-53189fa32c2d
2025-11-28 18:08:50 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.schedule_id=? 
        and s1_0.user_id=? 
        and s1_0.is_deleted=?
2025-11-28 18:08:50 [http-nio-8080-exec-8] INFO  c.e.s.service.ScheduleService - 日程更新成功 - 日程ID: c6b4a50e-2405-4935-8a0d-53189fa32c2d
2025-11-28 18:08:50 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    update
        schedules 
    set
        end_time=?,
        is_all_day=?,
        is_deleted=?,
        location=?,
        schedule_date=?,
        start_time=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        schedule_id=?
2025-11-28 18:08:50 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:08:50 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=更新成功, data=ScheduleDTO(scheduleId=c6b4a50e-2405-4935-8a0d-53189fa32c2d (truncated)...]
2025-11-28 18:08:50 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:08:51 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 18:08:51 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 18:08:51 [http-nio-8080-exec-10] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 18:08:51 [http-nio-8080-exec-10] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 18:08:51 [http-nio-8080-exec-10] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 18:08:51 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:08:51 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=c6b4a50e-2405-4935-8a0d-53189fa32c2 (truncated)...]
2025-11-28 18:08:51 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:09:05 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 18:09:05 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 18:09:05 [http-nio-8080-exec-3] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 18:09:05 [http-nio-8080-exec-3] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 18:09:05 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 18:09:05 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:09:05 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[ScheduleDTO(scheduleId=c6b4a50e-2405-4935-8a0d-53189fa32c2 (truncated)...]
2025-11-28 18:09:05 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:09:28 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/schedules/c6b4a50e-2405-4935-8a0d-53189fa32c2d", parameters={}
2025-11-28 18:09:28 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#deleteSchedule(String, HttpServletRequest)
2025-11-28 18:09:28 [http-nio-8080-exec-4] INFO  c.e.s.controller.ScheduleController - 【删除日程】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, scheduleId: c6b4a50e-2405-4935-8a0d-53189fa32c2d
2025-11-28 18:09:28 [http-nio-8080-exec-4] INFO  c.e.s.service.ScheduleService - 删除日程 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 日程ID: c6b4a50e-2405-4935-8a0d-53189fa32c2d
2025-11-28 18:09:28 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.schedule_id=? 
        and s1_0.user_id=? 
        and s1_0.is_deleted=?
2025-11-28 18:09:28 [http-nio-8080-exec-4] INFO  c.e.s.service.ScheduleService - 日程删除成功 - 日程ID: c6b4a50e-2405-4935-8a0d-53189fa32c2d
2025-11-28 18:09:28 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    update
        schedules 
    set
        end_time=?,
        is_all_day=?,
        is_deleted=?,
        location=?,
        schedule_date=?,
        start_time=?,
        title=?,
        updated_at=?,
        user_id=? 
    where
        schedule_id=?
2025-11-28 18:09:28 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:09:28 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=删除成功, data=null)]
2025-11-28 18:09:28 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 18:09:29 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 18:09:29 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 18:09:29 [http-nio-8080-exec-2] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 18:09:29 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 18:09:29 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 18:09:29 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 18:09:29 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 18:09:29 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 20:11:54 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 20:11:54 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 20:11:54 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 20:11:54 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=401, message=未授权，请先登录, data=null)]
2025-11-28 20:11:54 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 20:11:55 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/auth/refresh", parameters={}
2025-11-28 20:11:55 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.AuthController#refreshToken(RefreshTokenRequest, HttpServletRequest)
2025-11-28 20:11:55 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=utf-8" to [RefreshTokenRequest(refreshToken=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJiY2Y1ZGM2ZC0wMTA3LTQ1NzgtYjE1MC03Mm (truncated)...]
2025-11-28 20:11:55 [http-nio-8080-exec-7] INFO  c.e.s.controller.AuthController - 【刷新Token】IP: 192.168.43.1
2025-11-28 20:11:55 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        ut1_0.id,
        ut1_0.access_token,
        ut1_0.access_token_expires_at,
        ut1_0.created_at,
        ut1_0.device_id,
        ut1_0.device_type,
        ut1_0.ip_address,
        ut1_0.refresh_token,
        ut1_0.refresh_token_expires_at,
        ut1_0.status,
        ut1_0.updated_at,
        ut1_0.user_agent,
        ut1_0.user_id 
    from
        user_tokens ut1_0 
    where
        ut1_0.refresh_token=?
2025-11-28 20:11:55 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-28 20:11:55 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_tokens
        (access_token, access_token_expires_at, created_at, device_id, device_type, ip_address, refresh_token, refresh_token_expires_at, status, updated_at, user_agent, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2025-11-28 20:11:55 [http-nio-8080-exec-7] INFO  c.e.s.service.AuthService - 【刷新Token成功】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef
2025-11-28 20:11:55 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    update
        user_tokens 
    set
        access_token=?,
        access_token_expires_at=?,
        device_id=?,
        device_type=?,
        ip_address=?,
        refresh_token=?,
        refresh_token_expires_at=?,
        status=?,
        updated_at=?,
        user_agent=?,
        user_id=? 
    where
        id=?
2025-11-28 20:11:55 [http-nio-8080-exec-7] INFO  c.e.s.controller.AuthController - 【刷新Token成功】
2025-11-28 20:11:55 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 20:11:55 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=刷新成功, data=RefreshTokenResponse(token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ (truncated)...]
2025-11-28 20:11:55 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 20:11:55 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 20:11:55 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 20:11:55 [http-nio-8080-exec-9] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 20:11:55 [http-nio-8080-exec-9] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 20:11:55 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 20:11:55 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 20:11:55 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 20:11:55 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 20:14:52 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 20:14:52 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 20:14:52 [http-nio-8080-exec-1] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 20:14:52 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 20:14:52 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 20:14:52 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 20:14:52 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 20:14:52 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 20:16:53 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 20:16:53 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 20:16:53 [http-nio-8080-exec-4] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 20:16:53 [http-nio-8080-exec-4] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 20:16:53 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 20:16:53 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 20:16:53 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 20:16:53 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 20:16:54 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 20:16:54 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 20:16:54 [http-nio-8080-exec-2] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 20:16:54 [http-nio-8080-exec-2] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 20:16:54 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 20:16:54 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 20:16:54 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 20:16:54 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 20:16:55 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 20:16:55 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 20:16:55 [http-nio-8080-exec-5] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 20:16:55 [http-nio-8080-exec-5] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 20:16:55 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 20:16:55 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 20:16:55 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 20:16:55 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 20:16:57 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 20:16:57 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 20:16:57 [http-nio-8080-exec-6] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 20:16:57 [http-nio-8080-exec-6] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 20:16:57 [http-nio-8080-exec-6] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 20:16:57 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 20:16:57 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 20:16:57 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 20:16:58 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 20:16:58 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 20:16:58 [http-nio-8080-exec-7] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 20:16:58 [http-nio-8080-exec-7] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 20:16:58 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 20:16:58 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 20:16:58 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 20:16:58 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 20:24:35 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 20:24:35 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 20:24:35 [http-nio-8080-exec-8] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 20:24:35 [http-nio-8080-exec-8] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 20:24:35 [http-nio-8080-exec-8] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 20:24:35 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 20:24:35 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 20:24:35 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 20:24:39 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-28 20:24:39 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-11-28 20:24:39 [http-nio-8080-exec-10] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-11-28 20:24:39 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource groups/my.]
2025-11-28 20:24:39 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 404 NOT_FOUND
2025-11-28 20:24:39 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - "ERROR" dispatch for GET "/api/error", parameters={}
2025-11-28 20:24:39 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-11-28 20:24:39 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 20:24:39 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{timestamp=Fri Nov 28 20:24:39 CST 2025, status=404, error=Not Found, trace=org.springframework.web. (truncated)...]
2025-11-28 20:24:39 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "ERROR" dispatch, status 404
2025-11-28 20:25:00 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-28 20:25:00 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-11-28 20:25:00 [http-nio-8080-exec-1] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-11-28 20:25:00 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource groups/my.]
2025-11-28 20:25:00 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 404 NOT_FOUND
2025-11-28 20:25:00 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - "ERROR" dispatch for GET "/api/error", parameters={}
2025-11-28 20:25:00 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-11-28 20:25:00 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 20:25:00 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{timestamp=Fri Nov 28 20:25:00 CST 2025, status=404, error=Not Found, trace=org.springframework.web. (truncated)...]
2025-11-28 20:25:00 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "ERROR" dispatch, status 404
2025-11-28 20:36:16 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 20:36:16 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 20:36:16 [http-nio-8080-exec-4] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 20:36:16 [http-nio-8080-exec-4] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 20:36:16 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 20:36:16 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 20:36:16 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 20:36:16 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 20:36:22 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-28 20:36:22 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-11-28 20:36:22 [http-nio-8080-exec-2] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-11-28 20:36:22 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource groups/my.]
2025-11-28 20:36:22 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 404 NOT_FOUND
2025-11-28 20:36:22 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - "ERROR" dispatch for GET "/api/error", parameters={}
2025-11-28 20:36:22 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-11-28 20:36:22 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 20:36:22 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{timestamp=Fri Nov 28 20:36:22 CST 2025, status=404, error=Not Found, trace=org.springframework.web. (truncated)...]
2025-11-28 20:36:22 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "ERROR" dispatch, status 404
2025-11-28 20:36:26 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-28 20:36:26 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-11-28 20:36:26 [http-nio-8080-exec-5] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-11-28 20:36:26 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource groups/my.]
2025-11-28 20:36:26 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 404 NOT_FOUND
2025-11-28 20:36:26 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - "ERROR" dispatch for GET "/api/error", parameters={}
2025-11-28 20:36:26 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-11-28 20:36:26 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 20:36:26 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{timestamp=Fri Nov 28 20:36:26 CST 2025, status=404, error=Not Found, trace=org.springframework.web. (truncated)...]
2025-11-28 20:36:26 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "ERROR" dispatch, status 404
2025-11-28 20:55:58 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-28 20:55:58 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-28 20:55:58 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 20:55:58 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-28 20:55:58 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-28 21:08:10 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.8 with PID 55572 (E:\develop\Android Studio\workspace\SpeedCalendar-server\target\classes started by jiang in E:\develop\Android Studio\workspace\SpeedCalendar-server)
2025-11-28 21:08:10 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-28 21:08:10 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-28 21:08:11 [restartedMain] INFO  o.s.b.d.restart.ChangeableUrls - The Class-Path manifest attribute in C:\Users\jiang\.m2\repository\org\apache\opennlp\opennlp-tools\2.5.4\opennlp-tools-2.5.4.jar referenced one or more files that do not exist: file:/C:/Users/jiang/.m2/repository/org/apache/opennlp/opennlp-tools/2.5.4/slf4j-api-2.0.17.jar
2025-11-28 21:08:11 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-28 21:08:11 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-28 21:08:11 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 21:08:11 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-28 21:08:11 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 121 ms. Found 9 JPA repository interfaces.
2025-11-28 21:08:11 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 21:08:11 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-28 21:08:11 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:08:11 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:08:11 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:08:11 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:08:11 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:08:11 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:08:11 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:08:11 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:08:11 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:08:11 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-11-28 21:08:12 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-28 21:08:12 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1336 ms
2025-11-28 21:08:12 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-28 21:08:12 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-28 21:08:12 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-28 21:08:12 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-28 21:08:12 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-28 21:08:12 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@30498f30
2025-11-28 21:08:12 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-28 21:08:12 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-28 21:08:12 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-11-28 21:08:12 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-28 21:08:13 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-28 21:08:13 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 21:08:13 [restartedMain] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-28 21:08:17 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.8 with PID 49076 (E:\develop\Android Studio\workspace\SpeedCalendar-server\target\classes started by jiang in E:\develop\Android Studio\workspace\SpeedCalendar-server)
2025-11-28 21:08:17 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-28 21:08:17 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-28 21:08:17 [restartedMain] INFO  o.s.b.d.restart.ChangeableUrls - The Class-Path manifest attribute in C:\Users\jiang\.m2\repository\org\apache\opennlp\opennlp-tools\2.5.4\opennlp-tools-2.5.4.jar referenced one or more files that do not exist: file:/C:/Users/jiang/.m2/repository/org/apache/opennlp/opennlp-tools/2.5.4/slf4j-api-2.0.17.jar
2025-11-28 21:08:17 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-28 21:08:17 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-28 21:08:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 21:08:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-28 21:08:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 117 ms. Found 9 JPA repository interfaces.
2025-11-28 21:08:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 21:08:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-28 21:08:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:08:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:08:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:08:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:08:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:08:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:08:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:08:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:08:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:08:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 6 ms. Found 0 Redis repository interfaces.
2025-11-28 21:08:19 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-28 21:08:19 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-28 21:08:19 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-28 21:08:19 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-28 21:08:19 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1316 ms
2025-11-28 21:08:19 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-28 21:08:19 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-28 21:08:19 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-28 21:08:19 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-28 21:08:19 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-28 21:08:19 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@53b4fb75
2025-11-28 21:08:19 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-28 21:08:19 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-28 21:08:19 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-11-28 21:08:19 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-28 21:08:20 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-28 21:08:20 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 21:08:20 [restartedMain] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-28 21:08:21 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 21:08:21 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-11-28 21:08:21 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-11-28 21:08:21 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-11-28 21:08:21 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-11-28 21:08:21 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-11-28 21:08:21 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 21:08:21 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-11-28 21:08:21 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-11-28 21:08:21 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-28 21:08:21 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 26 mappings in 'requestMappingHandlerMapping'
2025-11-28 21:08:21 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-11-28 21:08:21 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-11-28 21:08:21 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-11-28 21:08:22 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-28 21:08:22 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-28 21:08:22 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 4.778 seconds (process running for 5.411)
2025-11-28 21:08:41 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-28 21:08:41 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-28 21:08:41 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-11-28 21:08:41 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-11-28 21:08:41 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-11-28 21:08:41 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@568b0fd8
2025-11-28 21:08:41 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@5278e2
2025-11-28 21:08:41 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-11-28 21:08:41 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-11-28 21:08:41 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 21:08:41 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 21:08:41 [http-nio-8080-exec-1] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 21:08:41 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 21:08:41 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 21:08:41 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 21:08:41 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 21:08:41 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 21:08:56 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/groups", parameters={}
2025-11-28 21:08:56 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-11-28 21:08:56 [http-nio-8080-exec-2] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-11-28 21:08:56 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource groups.]
2025-11-28 21:08:56 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 404 NOT_FOUND
2025-11-28 21:08:56 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - "ERROR" dispatch for POST "/api/error", parameters={}
2025-11-28 21:08:56 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-11-28 21:08:56 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 21:08:56 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{timestamp=Fri Nov 28 21:08:56 CST 2025, status=404, error=Not Found, trace=org.springframework.web. (truncated)...]
2025-11-28 21:08:56 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "ERROR" dispatch, status 404
2025-11-28 21:09:03 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/groups", parameters={}
2025-11-28 21:09:03 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-11-28 21:09:03 [http-nio-8080-exec-3] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-11-28 21:09:03 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource groups.]
2025-11-28 21:09:03 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 404 NOT_FOUND
2025-11-28 21:09:03 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - "ERROR" dispatch for POST "/api/error", parameters={}
2025-11-28 21:09:03 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-11-28 21:09:03 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 21:09:03 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{timestamp=Fri Nov 28 21:09:03 CST 2025, status=404, error=Not Found, trace=org.springframework.web. (truncated)...]
2025-11-28 21:09:03 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "ERROR" dispatch, status 404
2025-11-28 21:09:06 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-28 21:09:06 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-28 21:09:06 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 21:09:06 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-28 21:09:06 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-28 21:09:09 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.8 with PID 47204 (E:\develop\Android Studio\workspace\SpeedCalendar-server\target\classes started by jiang in E:\develop\Android Studio\workspace\SpeedCalendar-server)
2025-11-28 21:09:09 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-28 21:09:09 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-28 21:09:09 [restartedMain] INFO  o.s.b.d.restart.ChangeableUrls - The Class-Path manifest attribute in C:\Users\jiang\.m2\repository\org\apache\opennlp\opennlp-tools\2.5.4\opennlp-tools-2.5.4.jar referenced one or more files that do not exist: file:/C:/Users/jiang/.m2/repository/org/apache/opennlp/opennlp-tools/2.5.4/slf4j-api-2.0.17.jar
2025-11-28 21:09:09 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-28 21:09:09 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-28 21:09:09 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 21:09:09 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-28 21:09:10 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 124 ms. Found 9 JPA repository interfaces.
2025-11-28 21:09:10 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 21:09:10 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-28 21:09:10 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:09:10 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:09:10 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:09:10 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:09:10 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:09:10 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:09:10 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:09:10 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:09:10 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:09:10 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-11-28 21:09:10 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-28 21:09:10 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-28 21:09:10 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-28 21:09:10 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-28 21:09:10 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1426 ms
2025-11-28 21:09:10 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-28 21:09:10 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-28 21:09:10 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-28 21:09:11 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-28 21:09:11 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-28 21:09:11 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@160a2f7b
2025-11-28 21:09:11 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-28 21:09:11 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-28 21:09:11 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-11-28 21:09:11 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-28 21:09:12 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-28 21:09:12 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 21:09:13 [restartedMain] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-28 21:09:13 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 21:09:13 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-11-28 21:09:13 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-11-28 21:09:13 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-11-28 21:09:13 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-11-28 21:09:13 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-11-28 21:09:13 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 21:09:14 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-11-28 21:09:14 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-11-28 21:09:14 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-28 21:09:14 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 26 mappings in 'requestMappingHandlerMapping'
2025-11-28 21:09:14 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-11-28 21:09:14 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-11-28 21:09:14 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-11-28 21:09:14 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-28 21:09:14 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-28 21:09:14 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 6.077 seconds (process running for 6.714)
2025-11-28 21:09:16 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-28 21:09:16 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-28 21:09:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-11-28 21:09:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-11-28 21:09:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-11-28 21:09:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@5708404d
2025-11-28 21:09:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@5d1baea4
2025-11-28 21:09:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-11-28 21:09:16 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-28 21:09:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/groups", parameters={}
2025-11-28 21:09:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-11-28 21:09:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-11-28 21:09:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource groups.]
2025-11-28 21:09:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 404 NOT_FOUND
2025-11-28 21:09:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - "ERROR" dispatch for POST "/api/error", parameters={}
2025-11-28 21:09:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-11-28 21:09:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 21:09:16 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{timestamp=Fri Nov 28 21:09:16 CST 2025, status=404, error=Not Found, trace=org.springframework.web. (truncated)...]
2025-11-28 21:09:16 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "ERROR" dispatch, status 404
2025-11-28 21:10:04 [File Watcher] INFO  o.s.b.d.a.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 1 class path change (0 additions, 1 deletion, 0 modifications)
2025-11-28 21:10:04 [Thread-5] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-28 21:10:04 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-28 21:10:04 [Thread-5] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 21:10:04 [Thread-5] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-28 21:10:04 [Thread-5] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-28 21:10:04 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.8 with PID 47204 (E:\develop\Android Studio\workspace\SpeedCalendar-server\target\classes started by jiang in E:\develop\Android Studio\workspace\SpeedCalendar-server)
2025-11-28 21:10:04 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-28 21:10:04 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-28 21:10:04 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 21:10:04 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-28 21:10:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 28 ms. Found 9 JPA repository interfaces.
2025-11-28 21:10:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 21:10:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-28 21:10:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:05 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-11-28 21:10:05 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-28 21:10:05 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-28 21:10:05 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-28 21:10:05 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-28 21:10:05 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 445 ms
2025-11-28 21:10:05 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-28 21:10:05 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-28 21:10:05 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-28 21:10:05 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Starting...
2025-11-28 21:10:05 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-2 - Added connection com.mysql.cj.jdbc.ConnectionImpl@7ca84039
2025-11-28 21:10:05 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Start completed.
2025-11-28 21:10:05 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-28 21:10:05 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-11-28 21:10:05 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-2)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-28 21:10:05 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-28 21:10:05 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 21:10:05 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 21:10:05 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-11-28 21:10:05 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-11-28 21:10:05 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-11-28 21:10:05 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-11-28 21:10:05 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-11-28 21:10:05 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 21:10:05 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-11-28 21:10:05 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-11-28 21:10:05 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-28 21:10:05 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 23 mappings in 'requestMappingHandlerMapping'
2025-11-28 21:10:05 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-11-28 21:10:05 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-11-28 21:10:05 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-11-28 21:10:05 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-28 21:10:05 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-28 21:10:05 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 1.029 seconds (process running for 57.516)
2025-11-28 21:10:05 [restartedMain] INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener - Condition evaluation unchanged
2025-11-28 21:10:07 [File Watcher] INFO  o.s.b.d.a.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 1 class path change (1 addition, 0 deletions, 0 modifications)
2025-11-28 21:10:07 [Thread-7] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-28 21:10:07 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-28 21:10:07 [Thread-7] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 21:10:07 [Thread-7] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown initiated...
2025-11-28 21:10:07 [Thread-7] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown completed.
2025-11-28 21:10:07 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.8 with PID 47204 (E:\develop\Android Studio\workspace\SpeedCalendar-server\target\classes started by jiang in E:\develop\Android Studio\workspace\SpeedCalendar-server)
2025-11-28 21:10:07 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-28 21:10:07 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-28 21:10:07 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 21:10:07 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-28 21:10:07 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 19 ms. Found 9 JPA repository interfaces.
2025-11-28 21:10:07 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 21:10:07 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-28 21:10:07 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:07 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:07 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:07 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:07 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:07 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:07 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:07 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:07 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:07 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 3 ms. Found 0 Redis repository interfaces.
2025-11-28 21:10:07 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-28 21:10:07 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-28 21:10:07 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-28 21:10:07 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-28 21:10:07 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 293 ms
2025-11-28 21:10:07 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-28 21:10:07 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-28 21:10:07 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-28 21:10:07 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Starting...
2025-11-28 21:10:07 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-3 - Added connection com.mysql.cj.jdbc.ConnectionImpl@494e8c5e
2025-11-28 21:10:07 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Start completed.
2025-11-28 21:10:07 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-28 21:10:07 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-11-28 21:10:07 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-3)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-28 21:10:07 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-28 21:10:07 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 21:10:07 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 21:10:07 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-11-28 21:10:07 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-11-28 21:10:07 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-11-28 21:10:07 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-11-28 21:10:07 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-11-28 21:10:07 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 21:10:07 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-11-28 21:10:07 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-11-28 21:10:07 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-28 21:10:07 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 26 mappings in 'requestMappingHandlerMapping'
2025-11-28 21:10:07 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-11-28 21:10:07 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-11-28 21:10:07 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-11-28 21:10:07 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-28 21:10:07 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-28 21:10:07 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 0.707 seconds (process running for 59.697)
2025-11-28 21:10:07 [restartedMain] INFO  o.s.b.d.a.ConditionEvaluationDeltaLoggingListener - Condition evaluation unchanged
2025-11-28 21:10:14 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-28 21:10:14 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-28 21:10:14 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 21:10:14 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Shutdown initiated...
2025-11-28 21:10:14 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Shutdown completed.
2025-11-28 21:10:17 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Starting SpeedCalendarServerApplication using Java 21.0.8 with PID 55692 (E:\develop\Android Studio\workspace\SpeedCalendar-server\target\classes started by jiang in E:\develop\Android Studio\workspace\SpeedCalendar-server)
2025-11-28 21:10:17 [restartedMain] DEBUG c.e.s.SpeedCalendarServerApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-28 21:10:17 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-28 21:10:17 [restartedMain] INFO  o.s.b.d.restart.ChangeableUrls - The Class-Path manifest attribute in C:\Users\jiang\.m2\repository\org\apache\opennlp\opennlp-tools\2.5.4\opennlp-tools-2.5.4.jar referenced one or more files that do not exist: file:/C:/Users/jiang/.m2/repository/org/apache/opennlp/opennlp-tools/2.5.4/slf4j-api-2.0.17.jar
2025-11-28 21:10:17 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-28 21:10:17 [restartedMain] INFO  o.s.b.d.e.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-28 21:10:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 21:10:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-28 21:10:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 131 ms. Found 9 JPA repository interfaces.
2025-11-28 21:10:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-11-28 21:10:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-11-28 21:10:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatMessageRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ChatSessionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.GroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.ScheduleRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserGroupRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserPrivacySettingRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.UserTokenRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationExtensionSupport - Spring Data Redis - Could not safely identify store assignment for repository candidate interface com.example.speedcalendarserver.repository.VerificationCodeRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2025-11-28 21:10:18 [restartedMain] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-11-28 21:10:19 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-28 21:10:19 [restartedMain] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-28 21:10:19 [restartedMain] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-28 21:10:19 [restartedMain] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-28 21:10:19 [restartedMain] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1694 ms
2025-11-28 21:10:19 [restartedMain] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-28 21:10:19 [restartedMain] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-28 21:10:19 [restartedMain] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-28 21:10:19 [restartedMain] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-28 21:10:19 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-28 21:10:20 [restartedMain] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4c2e712c
2025-11-28 21:10:20 [restartedMain] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-28 21:10:20 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000025: MySQL8Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-11-28 21:10:20 [restartedMain] WARN  org.hibernate.orm.deprecation - HHH90000026: MySQL8Dialect has been deprecated; use org.hibernate.dialect.MySQLDialect instead
2025-11-28 21:10:20 [restartedMain] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 8.0
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-28 21:10:21 [restartedMain] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-28 21:10:21 [restartedMain] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-28 21:10:21 [restartedMain] INFO  o.s.d.j.r.query.QueryEnhancerFactory - Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-28 21:10:22 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 21:10:22 [restartedMain] INFO  c.e.s.config.AiConfig - AI 配置加载成功:
2025-11-28 21:10:22 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Base URL: https://api.siliconflow.cn/v1
2025-11-28 21:10:22 [restartedMain] INFO  c.e.s.config.AiConfig -   - Model: Qwen/Qwen3-Next-80B-A3B-Instruct
2025-11-28 21:10:22 [restartedMain] INFO  c.e.s.config.AiConfig -   - API Key: sk-xilgc...(已隐藏)
2025-11-28 21:10:22 [restartedMain] INFO  c.e.s.config.AiConfig -   - 工具调用: 已启用 (CalendarTools)
2025-11-28 21:10:22 [restartedMain] INFO  c.e.s.config.AiConfig - ============================================
2025-11-28 21:10:22 [restartedMain] INFO  c.e.s.config.AiConfig - 正在构建 CalendarAssistant，绑定工具和会话记忆
2025-11-28 21:10:22 [restartedMain] INFO  c.e.s.config.AiConfig - CalendarAssistant 构建完成，已启用工具调用和会话记忆功能
2025-11-28 21:10:22 [restartedMain] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-28 21:10:22 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 26 mappings in 'requestMappingHandlerMapping'
2025-11-28 21:10:23 [restartedMain] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-11-28 21:10:23 [restartedMain] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-11-28 21:10:23 [restartedMain] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-11-28 21:10:23 [restartedMain] INFO  o.s.b.d.a.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-28 21:10:23 [restartedMain] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-28 21:10:23 [restartedMain] INFO  c.e.s.SpeedCalendarServerApplication - Started SpeedCalendarServerApplication in 6.339 seconds (process running for 7.04)
2025-11-28 21:10:27 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-28 21:10:27 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-28 21:10:27 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-11-28 21:10:27 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-11-28 21:10:27 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-11-28 21:10:27 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@7278773c
2025-11-28 21:10:27 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@4dcfae5e
2025-11-28 21:10:27 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-11-28 21:10:27 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-28 21:10:27 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 21:10:27 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 21:10:27 [http-nio-8080-exec-1] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 21:10:27 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 21:10:27 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 21:10:27 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 21:10:27 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 21:10:27 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 21:10:36 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/groups", parameters={}
2025-11-28 21:10:36 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#createGroup(CreateGroupRequest, String)
2025-11-28 21:10:36 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [CreateGroupRequest(name=A23计算机1班)]
2025-11-28 21:10:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-28 21:10:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-28 21:10:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        (
            ug1_0.group_id, ug1_0.role, ug1_0.user_id
        ) in ((?, ?, ?))
2025-11-28 21:10:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        `group`
        (
            name, owner_id, id
        ) 
    values
        (?, ?, ?)
2025-11-28 21:10:36 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    insert 
    into
        user_group
        (group_id, role, user_id) 
    values
        (?, ?, ?)
2025-11-28 21:10:36 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 21:10:36 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [GroupResponse(id=grp_05f5aa5a-8426-4931-acc9-fc26bc6092a1, name=A23计算机1班, ownerId=bcf5dc6d-0107-4578 (truncated)...]
2025-11-28 21:10:36 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 21:10:38 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-28 21:10:38 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-28 21:10:38 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-28 21:10:38 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-28 21:10:39 [http-nio-8080-exec-3] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-28 21:10:39 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 21:10:39 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_05f5aa5a-8426-4931-acc9-fc26bc6092a1, groupName=A23计算机1班, role=admin)]]
2025-11-28 21:10:39 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 21:10:40 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/grp_05f5aa5a-8426-4931-acc9-fc26bc6092a1/members", parameters={}
2025-11-28 21:10:40 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-11-28 21:10:40 [http-nio-8080-exec-4] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-11-28 21:10:40 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource groups/grp_05f5aa5a-8426-4931-acc9-fc26bc6092a1/members.]
2025-11-28 21:10:40 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 404 NOT_FOUND
2025-11-28 21:10:40 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - "ERROR" dispatch for GET "/api/error", parameters={}
2025-11-28 21:10:40 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-11-28 21:10:40 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 21:10:40 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{timestamp=Fri Nov 28 21:10:40 CST 2025, status=404, error=Not Found, trace=org.springframework.web. (truncated)...]
2025-11-28 21:10:40 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "ERROR" dispatch, status 404
2025-11-28 21:10:41 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-28 21:10:41 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-28 21:10:41 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-28 21:10:41 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-28 21:10:41 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-28 21:10:41 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 21:10:41 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_05f5aa5a-8426-4931-acc9-fc26bc6092a1, groupName=A23计算机1班, role=admin)]]
2025-11-28 21:10:41 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 21:10:43 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/grp_05f5aa5a-8426-4931-acc9-fc26bc6092a1/members", parameters={}
2025-11-28 21:10:43 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-11-28 21:10:43 [http-nio-8080-exec-6] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-11-28 21:10:43 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource groups/grp_05f5aa5a-8426-4931-acc9-fc26bc6092a1/members.]
2025-11-28 21:10:43 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 404 NOT_FOUND
2025-11-28 21:10:43 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - "ERROR" dispatch for GET "/api/error", parameters={}
2025-11-28 21:10:43 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-11-28 21:10:43 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 21:10:43 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{timestamp=Fri Nov 28 21:10:43 CST 2025, status=404, error=Not Found, trace=org.springframework.web. (truncated)...]
2025-11-28 21:10:43 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "ERROR" dispatch, status 404
2025-11-28 21:10:44 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-28 21:10:44 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-28 21:10:44 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-28 21:10:44 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-28 21:10:44 [http-nio-8080-exec-7] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-28 21:10:44 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 21:10:44 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_05f5aa5a-8426-4931-acc9-fc26bc6092a1, groupName=A23计算机1班, role=admin)]]
2025-11-28 21:10:44 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 21:11:59 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-28 21:11:59 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-28 21:11:59 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-28 21:11:59 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-28 21:11:59 [http-nio-8080-exec-9] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-28 21:11:59 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 21:11:59 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_05f5aa5a-8426-4931-acc9-fc26bc6092a1, groupName=A23计算机1班, role=admin)]]
2025-11-28 21:11:59 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 21:12:53 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/schedules?year=2025&month=11", parameters={masked}
2025-11-28 21:12:53 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.ScheduleController#getSchedules(Integer, Integer, HttpServletRequest)
2025-11-28 21:12:53 [http-nio-8080-exec-1] INFO  c.e.s.controller.ScheduleController - 【获取日程列表】userId: bcf5dc6d-0107-4578-b150-72a0661b9eef, year: 2025, month: 11
2025-11-28 21:12:53 [http-nio-8080-exec-1] INFO  c.e.s.service.ScheduleService - 获取日程列表 - 用户ID: bcf5dc6d-0107-4578-b150-72a0661b9eef, 年: 2025, 月: 11
2025-11-28 21:12:53 [http-nio-8080-exec-1] DEBUG org.hibernate.SQL - 
    select
        s1_0.schedule_id,
        s1_0.created_at,
        s1_0.end_time,
        s1_0.is_all_day,
        s1_0.is_deleted,
        s1_0.location,
        s1_0.schedule_date,
        s1_0.start_time,
        s1_0.title,
        s1_0.updated_at,
        s1_0.user_id 
    from
        schedules s1_0 
    where
        s1_0.user_id=? 
        and s1_0.schedule_date>=? 
        and s1_0.schedule_date<? 
        and s1_0.is_deleted=0 
    order by
        s1_0.schedule_date,
        s1_0.start_time
2025-11-28 21:12:53 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 21:12:53 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Writing [ApiResponse(code=200, message=获取成功, data=[])]
2025-11-28 21:12:53 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 21:13:15 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-28 21:13:15 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-28 21:13:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-28 21:13:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-28 21:13:15 [http-nio-8080-exec-2] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-28 21:13:15 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 21:13:15 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_05f5aa5a-8426-4931-acc9-fc26bc6092a1, groupName=A23计算机1班, role=admin)]]
2025-11-28 21:13:15 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 21:13:17 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/grp_05f5aa5a-8426-4931-acc9-fc26bc6092a1/members", parameters={}
2025-11-28 21:13:17 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-11-28 21:13:17 [http-nio-8080-exec-3] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-11-28 21:13:17 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource groups/grp_05f5aa5a-8426-4931-acc9-fc26bc6092a1/members.]
2025-11-28 21:13:17 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 404 NOT_FOUND
2025-11-28 21:13:17 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - "ERROR" dispatch for GET "/api/error", parameters={}
2025-11-28 21:13:17 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-11-28 21:13:17 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 21:13:17 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{timestamp=Fri Nov 28 21:13:17 CST 2025, status=404, error=Not Found, trace=org.springframework.web. (truncated)...]
2025-11-28 21:13:17 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "ERROR" dispatch, status 404
2025-11-28 21:13:19 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-28 21:13:19 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-28 21:13:19 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-28 21:13:19 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-28 21:13:19 [http-nio-8080-exec-4] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-28 21:13:19 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 21:13:19 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_05f5aa5a-8426-4931-acc9-fc26bc6092a1, groupName=A23计算机1班, role=admin)]]
2025-11-28 21:13:19 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 21:13:38 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/my", parameters={}
2025-11-28 21:13:38 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.example.speedcalendarserver.controller.GroupController#getMyGroups(String)
2025-11-28 21:13:38 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        u1_0.user_id,
        u1_0.avatar,
        u1_0.bio,
        u1_0.birthday,
        u1_0.created_at,
        u1_0.email,
        u1_0.gender,
        u1_0.is_deleted,
        u1_0.last_login_ip,
        u1_0.last_login_time,
        u1_0.login_type,
        u1_0.password,
        u1_0.phone,
        u1_0.status,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.user_id=? 
        and u1_0.is_deleted=?
2025-11-28 21:13:38 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        ug1_0.group_id,
        ug1_0.role,
        ug1_0.user_id 
    from
        user_group ug1_0 
    where
        ug1_0.user_id=?
2025-11-28 21:13:38 [http-nio-8080-exec-5] DEBUG org.hibernate.SQL - 
    select
        g1_0.id,
        g1_0.name,
        g1_0.owner_id 
    from
        `group` g1_0 
    where
        g1_0.id=?
2025-11-28 21:13:38 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 21:13:38 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [[MyGroupResponse(groupId=grp_05f5aa5a-8426-4931-acc9-fc26bc6092a1, groupName=A23计算机1班, role=admin)]]
2025-11-28 21:13:38 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-28 21:13:43 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/groups/grp_05f5aa5a-8426-4931-acc9-fc26bc6092a1/members", parameters={}
2025-11-28 21:13:43 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Mapped to ResourceHttpRequestHandler [classpath [META-INF/resources/], classpath [resources/], classpath [static/], classpath [public/], ServletContext [/]]
2025-11-28 21:13:43 [http-nio-8080-exec-6] DEBUG o.s.w.s.r.ResourceHttpRequestHandler - Resource not found
2025-11-28 21:13:43 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.servlet.resource.NoResourceFoundException: No static resource groups/grp_05f5aa5a-8426-4931-acc9-fc26bc6092a1/members.]
2025-11-28 21:13:43 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 404 NOT_FOUND
2025-11-28 21:13:43 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - "ERROR" dispatch for GET "/api/error", parameters={}
2025-11-28 21:13:43 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-11-28 21:13:43 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [*/*] and supported [application/json, application/*+json]
2025-11-28 21:13:43 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{timestamp=Fri Nov 28 21:13:43 CST 2025, status=404, error=Not Found, trace=org.springframework.web. (truncated)...]
2025-11-28 21:13:43 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "ERROR" dispatch, status 404
